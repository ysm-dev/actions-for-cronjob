<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	xmlns:georss="http://www.georss.org/georss" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#" xmlns:media="http://search.yahoo.com/mrss/"
	>

<channel>
	<title>Charsyam&#039;s Blog</title>
	<atom:link href="https://charsyam.wordpress.com/feed/" rel="self" type="application/rss+xml" />
	<link>https://charsyam.wordpress.com</link>
	<description>Just another WordPress.com weblog</description>
	<lastBuildDate>Tue, 23 Apr 2019 00:56:41 +0000</lastBuildDate>
	<language>en</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>http://wordpress.com/</generator>
<cloud domain='charsyam.wordpress.com' port='80' path='/?rsscloud=notify' registerProcedure='' protocol='http-post' />
<image>
		<url>https://s0.wp.com/i/buttonw-com.png</url>
		<title>Charsyam&#039;s Blog</title>
		<link>https://charsyam.wordpress.com</link>
	</image>
	<atom:link rel="search" type="application/opensearchdescription+xml" href="https://charsyam.wordpress.com/osd.xml" title="Charsyam&#039;s Blog" />
	<atom:link rel='hub' href='https://charsyam.wordpress.com/?pushpress=hub'/>
	<item>
		<title>[ì… ê°œë°œ] Hive MetaStore ì—ì„œ Locationì€ ì–´ë–»ê²Œ ê´€ë¦¬ë ê¹Œ?</title>
		<link>https://charsyam.wordpress.com/2019/04/26/%ec%9e%85-%ea%b0%9c%eb%b0%9c-hive-metastore-%ec%97%90%ec%84%9c-location%ec%9d%80-%ec%96%b4%eb%96%bb%ea%b2%8c-%ea%b4%80%eb%a6%ac%eb%90%a0%ea%b9%8c/</link>
				<comments>https://charsyam.wordpress.com/2019/04/26/%ec%9e%85-%ea%b0%9c%eb%b0%9c-hive-metastore-%ec%97%90%ec%84%9c-location%ec%9d%80-%ec%96%b4%eb%96%bb%ea%b2%8c-%ea%b4%80%eb%a6%ac%eb%90%a0%ea%b9%8c/#respond</comments>
				<pubDate>Fri, 26 Apr 2019 17:19:42 +0000</pubDate>
		<dc:creator><![CDATA[charsyam]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://charsyam.wordpress.com/?p=2780</guid>
				<description><![CDATA[ìµœê·¼ì— ì•„ì£¼ ì´ìƒí•œ ì—ëŸ¬ë¥¼ ê²½í—˜í–ˆìŠµë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ managed table ì´ ìˆë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤. test1 ì´ë¼ëŠ” tableì— drop table ì„ ì‹œë„í–ˆëŠ”ë°!!! ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì‚¬ì‹¤ ì´ ì—ëŸ¬ëŠ” hadoop ì—ì„œ checkPath ë¼ëŠ” í•¨ìˆ˜ì— ì˜í•´ì„œ ë°œìƒí•˜ê²Œ ë©ë‹ˆë‹¤.(https://github.com/apache/hadoop/blob/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileSystem.java#L711) ì½”ë“œë¥¼ ë³´ë©´ ì‹¤ì œ schemaì— ìˆëŠ” Location ê²½ë¡œì™€ ì‹¤ì œ hadoop ì—ì„œ ì¸ì‹í•˜ëŠ” ìì‹ ì˜ ë„ë©”ì¸ì´ ë§ì§€ ì•Šì„ ë•Œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ì…ë‹ˆë‹¤. ì¦‰ a.b.c ë„ [&#8230;]]]></description>
								<content:encoded><![CDATA[<p>ìµœê·¼ì— ì•„ì£¼ ì´ìƒí•œ ì—ëŸ¬ë¥¼ ê²½í—˜í–ˆìŠµë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ managed table ì´ ìˆë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.</p>
<pre class="brush: sql; title: ; notranslate">
CREATE TABLE `test1`(
  `id` bigint
PARTITIONED BY (
  `datestamp` date)
ROW FORMAT SERDE
  'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe'
STORED AS INPUTFORMAT
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat'
OUTPUTFORMAT
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'
LOCATION
  'hdfs://a.b.c:8020/user/hive/warehouse/charsyam.db/test1'
TBLPROPERTIES (
  'transient_lastDdlTime'='1556186715')
</pre>
<p>test1 ì´ë¼ëŠ” tableì— drop table ì„ ì‹œë„í–ˆëŠ”ë°!!! ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. MetaException(message:java.lang.IllegalArgumentException: Wrong FS: hdfs://a.b.c:8020/user/hive/warehouse/charsyam.db/test1, expected: hdfs://ip-b.b.c:8020)
</pre>
<p>ì‚¬ì‹¤ ì´ ì—ëŸ¬ëŠ” hadoop ì—ì„œ checkPath ë¼ëŠ” í•¨ìˆ˜ì— ì˜í•´ì„œ ë°œìƒí•˜ê²Œ ë©ë‹ˆë‹¤.(<a href="https://github.com/apache/hadoop/blob/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileSystem.java#L711" rel="nofollow">https://github.com/apache/hadoop/blob/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileSystem.java#L711</a>) ì½”ë“œë¥¼ ë³´ë©´ ì‹¤ì œ schemaì— ìˆëŠ” Location ê²½ë¡œì™€ ì‹¤ì œ hadoop ì—ì„œ ì¸ì‹í•˜ëŠ” ìì‹ ì˜ ë„ë©”ì¸ì´ ë§ì§€ ì•Šì„ ë•Œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ì…ë‹ˆë‹¤. ì¦‰ a.b.c ë„ ip ê°€ 1.1.1.1 ì´ê³  b.b.c ë„ ip ê°€ 1.1.1.1 ì´ì§€ë§Œ table location ì´ hdfs://a.b.c:8020 ì¸ê²ƒê³¼ hdfs://b.b.c:8020 ì€ ì„œë¡œ ë‹¤ë¥¸ ë„ë©”ì¸ì´ ë˜ëŠ” ê±°ì£ .</p>
<pre class="brush: java; title: ; notranslate">
  protected void checkPath(Path path) {
    URI uri = path.toUri();
    String thatScheme = uri.getScheme();
    if (thatScheme == null)                // fs is relative
      return;
    URI thisUri = getCanonicalUri();
    String thisScheme = thisUri.getScheme();
    //authority and scheme are not case sensitive
    if (thisScheme.equalsIgnoreCase(thatScheme)) {// schemes match
      String thisAuthority = thisUri.getAuthority();
      String thatAuthority = uri.getAuthority();
      if (thatAuthority == null &amp;&amp;                // path's authority is null
          thisAuthority != null) {                // fs has an authority
        URI defaultUri = getDefaultUri(getConf());
        if (thisScheme.equalsIgnoreCase(defaultUri.getScheme())) {
          uri = defaultUri; // schemes match, so use this uri instead
        } else {
          uri = null; // can't determine auth of the path
        }
      }
      if (uri != null) {
        // canonicalize uri before comparing with this fs
        uri = canonicalizeUri(uri);
        thatAuthority = uri.getAuthority();
        if (thisAuthority == thatAuthority ||       // authorities match
            (thisAuthority != null &amp;&amp;
             thisAuthority.equalsIgnoreCase(thatAuthority)))
          return;
      }
    }
    throw new IllegalArgumentException("Wrong FS: " + path +
                                       ", expected: " + this.getUri());
  }
</pre>
<p>ê·¸ëŸ°ë° ì´ëŸ° ì¼ì´ ì™œ ì¼ì–´ë‚ ê¹Œê°€ ì‚¬ì‹¤ ë” ê¶ê¸ˆí• ê»ë‹ˆë‹¤. ë³´í†µì€ ë°œìƒí•˜ë©´ ì•ˆë˜ëŠ” ì¼ì´ì£ . ì‚¬ì‹¤ ì´ëŸ° í˜„ìƒì€ Hadoop ë…¸ë“œë¥¼ ê³„ì† ìƒˆë¡œìš´ ì¥ë¹„ì— ì¬ êµ¬ì¶•í•˜ëŠ”ë°, Hive Metastore ëŠ” ë™ì¼í•˜ê²Œ ì €ì¥í•˜ê¸° ë•Œë¬¸ì— ë°œìƒí•˜ëŠ” í˜„ìƒì…ë‹ˆë‹¤. ë³´í†µ í•˜ë‘¡ ì¥ë¹„ë“¤ì´ í¬ê²Œ ë°”ë€”ì¼ì´ ì—†ìœ¼ë‹ˆ&#8230; ê±°ì˜ ë°œìƒí•  ì¼ë„ ì—†ëŠ”ê±°ì£ . ê·¸ëŸ°ë° ì´ëŸ° ì¼ì´ ë°œìƒí•˜ê²Œ ë˜ë©´, ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ë¥¼ ë§ê²Œ ë©ë‹ˆë‹¤. ê·¸ë˜ì„œ ì´ê±¸ íŒŒë‹¤ë³´ë‹ˆ ì‹¤ì œë¡œ Hive MetaStore ì—ì„œ Location ì„ ì–´ë–»ê²Œ ì €ì¥í•˜ëŠ”ê°€ê°€ ê¶ê¸ˆí•´ì¡ŒìŠµë‹ˆë‹¤. ë³´í†µ ìš°ë¦¬ëŠ” show create table ë“±ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¼ ì´ ì •ë³´ë“¤ì€ ì–´ë””ì— ì €ì¥ë ê¹Œìš”?</p>
<p>ì¼ë‹¨ Hive Metastore ëŠ” ì‹¤ì œ ì €ì¥ì€ ë‹¤ë¥¸ ê³³ DBMSë‚˜ glue ë“±ì— ì €ì¥ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” MYSQLì— ì €ì¥ëœ ê²ƒìœ¼ë¡œ ì„¤ëª…ì„ í•˜ê² ìŠµë‹ˆë‹¤. ë¨¼ì € mysql ì— hive_metastore ë¼ëŠ” DBê°€ ìƒì„±ì´ ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì—¬ê¸°ì„œ ìš°ë¦¬ê°€ ì‚´í´ë³¼ table ì€ DBS, TBLS, SDS ì…ë‹ˆë‹¤.(ì´ê±° ì„¸ ê°œë§Œ ë³´ë©´ ë©ë‹ˆë‹¤.) ë§ˆì§€ë§‰ SëŠ” ì „ë¶€ ë³µìˆ˜ì˜ Së¡œ ë³´ì´ê³  ê°ê° Database, Table, StorageDescriptor ë¡œ ë³´ì…ë‹ˆë‹¤.</p>
<p>ë¨¼ì € hive ë“±ì—ì„œ create database ë¡œ DBë¥¼ ìƒì„±í•  ë•Œ ë§ˆë‹¤ í•´ë‹¹ ì •ë³´ê°€ Database ì— ì €ì¥ì´ ë©ë‹ˆë‹¤. ë¨¼ì € DBS í…Œì´ë¸”ì˜ ìŠ¤í‚¤ë§ˆëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<pre class="brush: sql; title: ; notranslate">
CREATE TABLE `DBS` (
  `DB_ID` bigint(20) NOT NULL,
  `DESC` varchar(4000) CHARACTER SET latin1 COLLATE latin1_bin DEFAULT NULL,
  `DB_LOCATION_URI` varchar(4000) CHARACTER SET latin1 COLLATE latin1_bin NOT NULL,
  `NAME` varchar(128) CHARACTER SET latin1 COLLATE latin1_bin DEFAULT NULL,
  `OWNER_NAME` varchar(128) CHARACTER SET latin1 COLLATE latin1_bin DEFAULT NULL,
  `OWNER_TYPE` varchar(10) CHARACTER SET latin1 COLLATE latin1_bin DEFAULT NULL,
  PRIMARY KEY (`DB_ID`),
  UNIQUE KEY `UNIQUE_DATABASE` (`NAME`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
</pre>
<p>ì—¬ê¸°ì„œ ì£¼ëª©í•  ê²ƒì€ ì—­ì‹œ primary key ì¸ DB_ID ì™€ DB_LOCATION_URI ì…ë‹ˆë‹¤. ë§Œì•½ charsyam dbë¼ë©´, ì´ DB_LOCATION_URI ì— ë“¤ì–´ê°€ëŠ” ê°’ì´ hdfs://a.b.c/user/hive/warehouse/charsyam.db/ ê¹Œì§€ê°€ ë“¤ì–´ê°€ê²Œ ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ dbì— í…Œì´ë¸”ì´ ìƒì„±ë˜ë©´ tableì˜ locationì´ í•­ìƒ ì´ ë°‘ì— ìƒê¸°ê²Œ ë©ë‹ˆë‹¤.</p>
<p>ì‹¤ì œë¡œ TBLS í…Œì´ë¸”ì„ ë³´ë©´ ë‚´ë¶€ì— Locationì´ ì—†ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ í•´ë‹¹ DBSì˜ DB_LOCATION_URIë¥¼ ë°”ê¾¸ë©´ ë°”ë¡œ ë˜ì§€ ì•Šì„ê¹Œë¼ê³  ìƒê°ì„ ì²˜ìŒì— í–ˆì—ˆëŠ”ë°&#8230; ì‚¬ì‹¤ ì´ê±´ ë§ë„ ì•ˆë˜ëŠ” ì†Œë¦¬ì…ë‹ˆë‹¤. ì™œëƒí•˜ë©´ hive ë“±ì˜ íˆ´ì„ ì¨ë³´ì‹  ë¶„ë“¤ì€ ë°”ë¡œ ì•„ì‹œê² ì§€ë§Œ, location ìì²´ëŠ” ì–¼ë§ˆë“ ì§€ ë‹¤ë¥¸ ê²ƒìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ë¬´ì—‡ì¸ê°€? í…Œì´ë¸”ì—ëŠ” ìê¸°ë§Œì˜ Location ì •ë³´ê°€ ê¼­ ìˆì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì¦‰ TBLSì— ì—†ë‹¤ë©´, ë‹¤ë¥¸ê³³ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ìŒì€ TBLS ì˜ schema ì…ë‹ˆë‹¤.</p>
<pre class="brush: sql; title: ; notranslate">
CREATE TABLE `TBLS` (
  `TBL_ID` bigint(20) NOT NULL,
  `CREATE_TIME` int(11) NOT NULL,
  `DB_ID` bigint(20) DEFAULT NULL,
  `LAST_ACCESS_TIME` int(11) NOT NULL,
  `OWNER` varchar(767) CHARACTER SET latin1 COLLATE latin1_bin DEFAULT NULL,
  `RETENTION` int(11) NOT NULL,
  `SD_ID` bigint(20) DEFAULT NULL,
  `TBL_NAME` varchar(256) CHARACTER SET latin1 COLLATE latin1_bin DEFAULT NULL,
  `TBL_TYPE` varchar(128) CHARACTER SET latin1 COLLATE latin1_bin DEFAULT NULL,
  `VIEW_EXPANDED_TEXT` mediumtext,
  `VIEW_ORIGINAL_TEXT` mediumtext,
  `IS_REWRITE_ENABLED` bit(1) NOT NULL,
  PRIMARY KEY (`TBL_ID`),
  UNIQUE KEY `UNIQUETABLE` (`TBL_NAME`,`DB_ID`),
  KEY `TBLS_N50` (`SD_ID`),
  KEY `TBLS_N49` (`DB_ID`),
  CONSTRAINT `TBLS_FK1` FOREIGN KEY (`SD_ID`) REFERENCES `SDS` (`SD_ID`),
  CONSTRAINT `TBLS_FK2` FOREIGN KEY (`DB_ID`) REFERENCES `DBS` (`DB_ID`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
</pre>
<p>ê·¸ë ‡ë‹¤ë©´ í•´ë‹¹ ì •ë³´ëŠ” ì–´ë””ì— ìˆì„ê¹Œìš”? ë‹¹ì—°íˆ!!! ì•„ê¹Œ ì–¸ê¸‰í–ˆì§€ë§Œ, ì•„ì§ê¹Œì§€ ì•ˆë‚˜ì˜¨ SDS ì…ë‹ˆë‹¤. ì–´ë–»ê²Œ SD ê°€ StorageDescriptorë¼ê³  ìƒê°í•˜ëƒê³  í•˜ë©´&#8230; Hive ì†ŒìŠ¤ë¥¼ ë³´ë©´ ql/src/java/org/apache/hadoop/hive/ql/metadata/Table.java ì— getPath ë¼ëŠ” ë©”ì„œë“œê°€ ìˆê³  ì—¬ê¸°ì„œ getSd() ë¼ëŠ” ë©”ì„œë“œë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.</p>
<pre class="brush: java; title: ; notranslate">
final public Path getPath() {
    String location = tTable.getSd().getLocation();
    if (location == null) {
      return null;
    }
    return new Path(location);
  }
</pre>
<p>ì´ê±¸ ìì„¸íˆ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ StorageDescriptor ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤. ì•„ë§ˆë„ ê·¸ëŸ¬ë‹ˆ ì €ê²ƒë„&#8230;</p>
<pre class="brush: java; title: ; notranslate">
  public StorageDescriptor getSd() {
    return this.sd;
  }
</pre>
<p>ì´ì œ SDS í…Œì´ë¸”ì„ ì‚´í´ë³´ì‹œì£ . Location í•­ëª©ì´ ë³´ì…ë‹ˆë‹¤. ì—¬ê¸°ì— ì €ì¥ì´ ë˜ëŠ”ê²ë‹ˆë‹¤.</p>
<pre class="brush: sql; title: ; notranslate">
CREATE TABLE `SDS` (
  `SD_ID` bigint(20) NOT NULL,
  `CD_ID` bigint(20) DEFAULT NULL,
  `INPUT_FORMAT` varchar(4000) CHARACTER SET latin1 COLLATE latin1_bin DEFAULT NULL,
  `IS_COMPRESSED` bit(1) NOT NULL,
  `IS_STOREDASSUBDIRECTORIES` bit(1) NOT NULL,
  `LOCATION` varchar(4000) CHARACTER SET latin1 COLLATE latin1_bin DEFAULT NULL,
  `NUM_BUCKETS` int(11) NOT NULL,
  `OUTPUT_FORMAT` varchar(4000) CHARACTER SET latin1 COLLATE latin1_bin DEFAULT NULL,
  `SERDE_ID` bigint(20) DEFAULT NULL,
  PRIMARY KEY (`SD_ID`),
  KEY `SDS_N49` (`SERDE_ID`),
  KEY `SDS_N50` (`CD_ID`),
  CONSTRAINT `SDS_FK1` FOREIGN KEY (`SERDE_ID`) REFERENCES `SERDES` (`SERDE_ID`),
  CONSTRAINT `SDS_FK2` FOREIGN KEY (`CD_ID`) REFERENCES `CDS` (`CD_ID`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
</pre>
<p>ê·¸ëŸ°ë° ì´ê±°ë‘ ì‹¤ì œ Tableê³¼ ì–´ë–»ê²Œ ë§¤ì¹­ì„ ì‹œí‚¬ ìˆ˜ ìˆì„ê¹Œìš”? ê·¸ ë¹„ë°€ì€ Primary Keyì¸ SD_IDê°€ ì¤‘ìš”í•©ë‹ˆë‹¤. ìœ„ì—ì„œ ì–¸ê¸‰í•œ TBLS í…Œì´ë¸”ì„ ë³´ë©´ DB_ID, SD_ID, TBL_NAME ì´ ìˆìŠµë‹ˆë‹¤. ì¦‰, ë¨¼ì € DBS ì—ì„œ database ì´ë¦„ìœ¼ë¡œ DB_ID ê°’ì„ ì°¾ê³ , ê·¸ DB_IDì™€ TBL_NAMEì„ ì´ìš©í•´ì„œ í•´ë‹¹ í…Œì´ë¸”ì˜ SD_IDë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ê·¸ SD_IDë¥¼ ì´ìš©í•˜ë©´ ë§ˆì§€ë§‰ìœ¼ë¡œ SDS í…Œì´ë¸”ì—ì„œ ìµœì¢…ì ìœ¼ë¡œ í•´ë‹¹ í…Œì´ë¸”ì˜ StorageDescriptor ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆëŠ” ê²ë‹ˆë‹¤. ê·¸ë¦¬ê³  SDS ì˜ Location ê°’ì´ show create table ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” ë°”ë¡œ ê·¸ê°’ì…ë‹ˆë‹¤. ê·¸ë˜ì„œ ì—¬ê¸°ì„œ í•´ë‹¹ ì»¬ëŸ¼ì˜ ê°’ì„ ë°”ê¿”ë²„ë¦¬ë©´&#8230; show create table ì‹œì—ë„ ê°’ì´ ë°”ë€Œê²Œ ë©ë‹ˆë‹¤.</p>
<p>ë‹¹ì—°í•˜ì§€ë§Œ, SDS í…Œì´ë¸”ì— ë°ì´í„°ê°€ ë§ì€ ê²ƒì€ StorageDescriptorëŠ” í…Œì´ë¸”ë§ˆë‹¤ í•˜ë‚˜ì”©ì´ì§€ë§Œ, ë‹¹ì—°íˆ Partition ë§ˆë‹¤ë„ ì¡´ì¬í•©ë‹ˆë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ìµœì†Œí•œ ì „ì²´ í…Œì´ë¸” ìˆ˜ + ì „ì²´ íŒŒí‹°ì…˜ ìˆ˜ ë§Œí¼ ì¡´ì¬í•˜ëŠ”ê²Œ ë§ìŠµë‹ˆë‹¤. <img src="https://s0.wp.com/wp-content/mu-plugins/wpcom-smileys/twemoji/2/72x72/1f642.png" alt="ğŸ™‚" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
]]></content:encoded>
							<wfw:commentRss>https://charsyam.wordpress.com/2019/04/26/%ec%9e%85-%ea%b0%9c%eb%b0%9c-hive-metastore-%ec%97%90%ec%84%9c-location%ec%9d%80-%ec%96%b4%eb%96%bb%ea%b2%8c-%ea%b4%80%eb%a6%ac%eb%90%a0%ea%b9%8c/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
						
		<media:content url="https://2.gravatar.com/avatar/eb957612b8f29b31a16f21df385691ed?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">charsyam</media:title>
		</media:content>
	</item>
		<item>
		<title>[ì… ê°œë°œ] Spark DataFrameWriterì—ì„œ saveAsTable ì˜ ë™ì‘</title>
		<link>https://charsyam.wordpress.com/2019/04/23/%ec%9e%85-%ea%b0%9c%eb%b0%9c-spark-dataframewriter%ec%97%90%ec%84%9c-saveastable-%ec%9d%98-%eb%8f%99%ec%9e%91/</link>
				<comments>https://charsyam.wordpress.com/2019/04/23/%ec%9e%85-%ea%b0%9c%eb%b0%9c-spark-dataframewriter%ec%97%90%ec%84%9c-saveastable-%ec%9d%98-%eb%8f%99%ec%9e%91/#respond</comments>
				<pubDate>Tue, 23 Apr 2019 00:56:41 +0000</pubDate>
		<dc:creator><![CDATA[charsyam]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://charsyam.wordpress.com/?p=2778</guid>
				<description><![CDATA[s3 ì— external tableì„ ë§Œë“¤ê³  ê±°ê¸°ì— ë°ì´í„°ë¥¼ ë„£ëŠ” ì‘ì—…ì„ í•˜ë‹¤ê°€ ì´ìƒí•œ í˜„ìƒì„ ê²½í—˜í–ˆìŠµë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ í…Œì´ë¸”ì„ ë§Œë“¤ê³  ì•„ë˜ ì½”ë“œë¥¼ ëŒë ¸ëŠ”ë°&#8230; ë‹¹ì—°íˆ tmp1 í…Œì´ë¸”ì€ ë°ì´í„°ë¥¼ s3ì— ê·¸ë¦¬ê³  external í…Œì´ë¸”ë¡œ ì œëŒ€ë¡œ ì €ì¥ì´ ë  ê²ƒì„ ê¸°ëŒ€í–ˆëŠ”ë°, ì•„ë˜ì™€ ê°™ì´, managed í…Œì´ë¸”ë¡œ ë°”ë€Œê³  ì €ì¥ ìœ„ì¹˜ë¡œ hdfs ë¡œ ë°”ë€ŒëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. -_-(ì™œì™œì™œ) Spark DataFrameWriterì˜ saveAsTable ì„ SaveMode.Overwrite modeë¡œ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ ì´ëŸ° ì¼ì´ [&#8230;]]]></description>
								<content:encoded><![CDATA[<p>s3 ì— external tableì„ ë§Œë“¤ê³  ê±°ê¸°ì— ë°ì´í„°ë¥¼ ë„£ëŠ” ì‘ì—…ì„ í•˜ë‹¤ê°€ ì´ìƒí•œ í˜„ìƒì„ ê²½í—˜í–ˆìŠµë‹ˆë‹¤.<br />
ë‹¤ìŒê³¼ ê°™ì€ í…Œì´ë¸”ì„ ë§Œë“¤ê³ </p>
<pre class="brush: sql; title: ; notranslate">
create external table(
    id int,
    name varchar(22)
) LOCATION
  's3://bucket/tmp/tmp1';
</pre>
<p>ì•„ë˜ ì½”ë“œë¥¼ ëŒë ¸ëŠ”ë°&#8230;</p>
<pre class="brush: scala; title: ; notranslate">
val tb = spark.sql(
        """
        |SELECT
        |  id, name
        |FROM original
        """
)
tb.write.mode(SaveMode.Overwrite).saveAsTable("tmp1")
</pre>
<p>ë‹¹ì—°íˆ tmp1 í…Œì´ë¸”ì€ ë°ì´í„°ë¥¼ s3ì— ê·¸ë¦¬ê³  external í…Œì´ë¸”ë¡œ ì œëŒ€ë¡œ ì €ì¥ì´ ë  ê²ƒì„ ê¸°ëŒ€í–ˆëŠ”ë°, ì•„ë˜ì™€ ê°™ì´, managed í…Œì´ë¸”ë¡œ ë°”ë€Œê³  ì €ì¥ ìœ„ì¹˜ë¡œ hdfs ë¡œ ë°”ë€ŒëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. -_-(ì™œì™œì™œ)</p>
<pre class="brush: sql; title: ; notranslate">
create table(
    id int,
    name varchar(22)
) LOCATION
  'hdfs://tmp/blahblah/tmp1';
</pre>
<p>Spark DataFrameWriterì˜ saveAsTable ì„ SaveMode.Overwrite modeë¡œ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ ì´ëŸ° ì¼ì´ ë²Œì–´ì§€ê²Œ ë©ë‹ˆë‹¤. ì™œ ê·¸ëŸ°ê°€ í•´ì„œ ì†ŒìŠ¤ ì½”ë“œë¥¼ ê¹Œë´¤ìŠµë‹ˆë‹¤. DataFrameWriter.scalaë¥¼ ë³´ì‹œë©´ ë©ë‹ˆë‹¤.</p>
<p>ê·¸ëƒ¥ saveAsTable ì†ŒìŠ¤ë¥¼ ë³´ë©´ ê°„ë‹¨í•©ë‹ˆë‹¤. ì•„ë˜ë¥¼ ë³´ë©´ SaveMode.Overwrite ê°€ true ì¼ë•Œ&#8230; ë°‘ì—ì„œ dropTable, createTable ì„ ë¶€ë¥´ëŠ”êµ°ìš”. ì–´ë&#8230;. dropTable???, ì´ê±° ì‹¤í™”ì¸ê°€ìš”? ì¦‰, ì´ ë•Œ í…Œì´ë¸”ì„ ë‚ ë ¤ë²„ë¦½ë‹ˆë‹¤. ê·¸ë¦¬ê³  createTableë¡œ ì¬ìƒì„±í•´ì¤ë‹ˆë‹¤.</p>
<pre class="brush: scala; title: ; notranslate">
  private def saveAsTable(tableIdent: TableIdentifier): Unit = {
    val catalog = df.sparkSession.sessionState.catalog
    val tableExists = catalog.tableExists(tableIdent)
    val db = tableIdent.database.getOrElse(catalog.getCurrentDatabase)
    val tableIdentWithDB = tableIdent.copy(database = Some(db))
    val tableName = tableIdentWithDB.unquotedString

    (tableExists, mode) match {
       ......
       case (true, SaveMode.Overwrite) =&gt;
        // Get all input data source or hive relations of the query.
        val srcRelations = df.logicalPlan.collect {
          case LogicalRelation(src: BaseRelation, _, _, _) =&gt; src
          case relation: HiveTableRelation =&gt; relation.tableMeta.identifier
        }

        val tableRelation = df.sparkSession.table(tableIdentWithDB).queryExecution.analyzed
        EliminateSubqueryAliases(tableRelation) match {
          // check if the table is a data source table (the relation is a BaseRelation).
          case LogicalRelation(dest: BaseRelation, _, _, _) if srcRelations.contains(dest) =&gt;
            throw new AnalysisException(
              s"Cannot overwrite table $tableName that is also being read from")
          // check hive table relation when overwrite mode
          case relation: HiveTableRelation
              if srcRelations.contains(relation.tableMeta.identifier) =&gt;
            throw new AnalysisException(
              s"Cannot overwrite table $tableName that is also being read from")
          case _ =&gt; // OK
        }

        // Drop the existing table
        catalog.dropTable(tableIdentWithDB, ignoreIfNotExists = true, purge = false)
        createTable(tableIdentWithDB)
        // Refresh the cache of the table in the catalog.
        catalog.refreshTable(tableIdentWithDB)
      ......
    }
  }
</pre>
<p>ê·¸ëŸ¼ externalì´ ì™œ managedê°€ ë˜ëŠ”ì§€ ì‚´í´ë³´ì‹œì£ . createTable ì½”ë“œë¥¼ ë³´ë©´ storage.locationUri.isDefinedë¥¼ ë³´ê³  EXTERNAL, MANAGEDê°€ ê²°ì •ë©ë‹ˆë‹¤.(ë‹¤ë¥¸ ê¸€ì—ì„œ ì“°ê² ì§€ë§Œ Spark Sqlì—ì„œ í˜„ì¬ëŠ” alter table ì„ ì´ìš©í•œ external, managed ë³€ê²½ì´ ì•ˆë©ë‹ˆë‹¤. Spark 2.4 ê¸°ì¤€)</p>
<pre class="brush: scala; title: ; notranslate">
  private def createTable(tableIdent: TableIdentifier): Unit = {
    val storage = DataSource.buildStorageFormatFromOptions(extraOptions.toMap)
    val tableType = if (storage.locationUri.isDefined) {
      CatalogTableType.EXTERNAL
    } else {
      CatalogTableType.MANAGED
    }

    val tableDesc = CatalogTable(
      identifier = tableIdent,
      tableType = tableType,
      storage = storage,
      schema = new StructType,
      provider = Some(source),
      partitionColumnNames = partitioningColumns.getOrElse(Nil),
      bucketSpec = getBucketSpec)

    runCommand(df.sparkSession, "saveAsTable")(CreateTable(tableDesc, mode, Some(df.logicalPlan)))
  }
</pre>
<p>í•´ë‹¹ ê°’ì€ buildStorageFormatFromOptions ë¥¼ ë³´ë©´ ê°€ì ¸ì˜µë‹ˆë‹¤. options mapì—ì„œ pathê°€ ìˆìœ¼ë©´ ê°€ì ¸ì˜¤ëŠ” êµ°ìš”.</p>
<pre class="brush: scala; title: ; notranslate">
  def buildStorageFormatFromOptions(options: Map[String, String]): CatalogStorageFormat = {
    val path = CaseInsensitiveMap(options).get("path")
    val optionsWithoutPath = options.filterKeys(_.toLowerCase(Locale.ROOT) != "path")
    CatalogStorageFormat.empty.copy(
      locationUri = path.map(CatalogUtils.stringToURI), properties = optionsWithoutPath)
  }
</pre>
<p>ì—¬ê¸°ì„œ pathê°€ ìˆìœ¼ë©´ ê·¸ëƒ¥ locationUri ì— ë³µì‚¬í•´ì¤ë‹ˆë‹¤. ê·¸ëŸ¼ ì´ì œ ìœ„ì˜ ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•´ì•¼ í• ê¹Œìš”? storage.locationUri.isDefined ë¥¼ trueë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ë°©ë²•ì€, ë„µ path optionì„ ì„¤ì •í•´ ì£¼ë©´ ê°„ë‹¨í•˜ê²Œ í•´ê²°ë©ë‹ˆë‹¤.</p>
<pre class="brush: scala; title: ; notranslate">
val tb = spark.sql(
        """
        |SELECT
        |  id, name
        |FROM original
        """
)
tb.write
  .mode(SaveMode.Overwrite)
  .option("path", "s3://bucket/tmp/tmp1")
  .saveAsTable("tmp1")
</pre>
<p>ì´ë ‡ê²Œ í•˜ëŠ” ë°©ë²•ë§ê³  ë§Œì•½ì— ê·¸ëƒ¥ ì‰½ê²Œ ë®ì–´ì“°ê³  ì‹¶ë‹¤ë©´, insertInto ë©”ì„œë“œë¥¼ ì“°ì…”ë„ ê°„ë‹¨í•˜ê²Œ í•´ê²°ë©ë‹ˆë‹¤.</p>
]]></content:encoded>
							<wfw:commentRss>https://charsyam.wordpress.com/2019/04/23/%ec%9e%85-%ea%b0%9c%eb%b0%9c-spark-dataframewriter%ec%97%90%ec%84%9c-saveastable-%ec%9d%98-%eb%8f%99%ec%9e%91/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
						
		<media:content url="https://2.gravatar.com/avatar/eb957612b8f29b31a16f21df385691ed?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">charsyam</media:title>
		</media:content>
	</item>
		<item>
		<title>[ì…ê°œë°œ] NAGLE ì•Œê³ ë¦¬ì¦˜ê³¼ TCP_CORK</title>
		<link>https://charsyam.wordpress.com/2019/03/14/%ec%9e%85%ea%b0%9c%eb%b0%9c-nagle-%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98%ea%b3%bc-tcp_cork/</link>
				<comments>https://charsyam.wordpress.com/2019/03/14/%ec%9e%85%ea%b0%9c%eb%b0%9c-nagle-%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98%ea%b3%bc-tcp_cork/#comments</comments>
				<pubDate>Thu, 14 Mar 2019 16:02:41 +0000</pubDate>
		<dc:creator><![CDATA[charsyam]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://charsyam.wordpress.com/?p=2776</guid>
				<description><![CDATA[ì–´ì©Œë‹¤ë³´ë‹ˆ, ì˜¤ëŠ˜ ì²˜ìŒìœ¼ë¡œ&#8230;(ì •ë§ë¡œ ì²˜ìŒìœ¼ë¡œ!!!) TCP_CORKë¼ëŠ” ì˜µì…˜ì— ëŒ€í•´ì„œ ì°¾ì•„ë³´ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.(ì•„ë‹ˆ ì´ê²Œ ë¬´ì—‡ì´ì˜¤ ì—¬ëŸ¬ë¶„!!!) TCP_CORKë¼ëŠ” ì˜µì…˜ì„ ì„¤ëª…í•˜ê¸° ì „ì— ë¨¼ì € TCP_NODELAYë¼ëŠ” ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤. ì›ë˜ ë°ì´í„° ì „ì†¡ì˜ íš¨ìœ¨ì„±ì„ ì·¨í•˜ê¸° ìœ„í•´ì„œ ê¸°ë³¸ì ìœ¼ë¡œ TCP ì „ì†¡ì— Nagleì´ë¼ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ ì ìš©ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ëŒ€ìš©ëŸ‰ íŒŒì¼ì„ ë³´ë‚¼ ë•ŒëŠ” ìœ ë¦¬í•˜ì§€ë§Œ, ì§§ì€ ê¸¸ì´ì˜ ë°ì´í„°ë¥¼ ë³´ë‚¼ë•ŒëŠ” ì‚¬ì‹¤ ìœ ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë„¤íŠ¸ì› ê´€ë ¨ ì„œë¹„ìŠ¤ë¥¼ ë§Œë“¤ë‹¤ ë³´ë©´, ë­”ê°€ ì‘ë‹µì´, ì•„ë¬´ì´ìœ  ì—†ì´, ì•„ì£¼ [&#8230;]]]></description>
								<content:encoded><![CDATA[<p>ì–´ì©Œë‹¤ë³´ë‹ˆ, ì˜¤ëŠ˜ ì²˜ìŒìœ¼ë¡œ&#8230;(ì •ë§ë¡œ ì²˜ìŒìœ¼ë¡œ!!!) TCP_CORKë¼ëŠ” ì˜µì…˜ì— ëŒ€í•´ì„œ ì°¾ì•„ë³´ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.(ì•„ë‹ˆ ì´ê²Œ ë¬´ì—‡ì´ì˜¤ ì—¬ëŸ¬ë¶„!!!)</p>
<p>TCP_CORKë¼ëŠ” ì˜µì…˜ì„ ì„¤ëª…í•˜ê¸° ì „ì— ë¨¼ì € TCP_NODELAYë¼ëŠ” ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤. ì›ë˜ ë°ì´í„° ì „ì†¡ì˜ íš¨ìœ¨ì„±ì„ ì·¨í•˜ê¸° ìœ„í•´ì„œ ê¸°ë³¸ì ìœ¼ë¡œ TCP ì „ì†¡ì— Nagleì´ë¼ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ ì ìš©ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ëŒ€ìš©ëŸ‰ íŒŒì¼ì„ ë³´ë‚¼ ë•ŒëŠ” ìœ ë¦¬í•˜ì§€ë§Œ, ì§§ì€ ê¸¸ì´ì˜ ë°ì´í„°ë¥¼ ë³´ë‚¼ë•ŒëŠ” ì‚¬ì‹¤ ìœ ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë„¤íŠ¸ì› ê´€ë ¨ ì„œë¹„ìŠ¤ë¥¼ ë§Œë“¤ë‹¤ ë³´ë©´, ë­”ê°€ ì‘ë‹µì´, ì•„ë¬´ì´ìœ  ì—†ì´, ì•„ì£¼ ëŠ¦ê²Œ ê°€ëŠ” ì¼€ì´ìŠ¤ë¥¼ ë§Œë‚˜ê²Œ ë˜ëŠ” ê²½ìš°ê°€ ìˆëŠ”ë°, ì‹¤ì œë¡œ, Nagle ì•Œê³ ë¦¬ì¦˜ì˜ ì˜í–¥ì„ ë°›ì•„ì„œ ëŠ¦ê²Œ ê°€ëŠ” ê²½ìš°ê°€ ì¢…ì¢… ìˆìŠµë‹ˆë‹¤.</p>
<p>ê·¸ëŸ¬ë©´ ë¨¼ì € Nagle ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ë©´, ê·¸ëƒ¥ ì–´ëŠì •ë„ ë°ì´í„°ê°€ ìŒ“ì¼ ë•Œ ê¹Œì§€ íŒ¨í‚·ì„ ë³´ë‚´ì§€ ì•Šê³  ê¸°ë‹¤ë ¤ ë†“ë‹¤ê°€&#8230; ì¼ì • ì‚¬ì´ì¦ˆê°€ ë˜ë©´ ë³´ë‚´ê² ë‹¤ë¼ëŠ” ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤. ë™ë„¤ ë²„ìŠ¤ê°€, ì‚¬ëŒì´ ì ì„ ë•ŒëŠ” ì¶œë°œí•˜ì§€ ì•Šê³ , ëª‡ëª… ì™€ì•¼ ì¶œë°œí•˜ëŠ” ê²ƒ ì²˜ëŸ¼&#8230;(íŒêµì—­ ì•ì— ê³„ì‹œë©´ ì´ëŸ° ê²½ìš°ë¥¼ ë§ì´ ë³´ì‹œê²Œ ë©ë‹ˆë‹¤.)</p>
<p>ì´ë ‡ê²Œ ëª¨ì•„ì„œ ë³´ë‚´ë©´ íš¨ìœ¨ì€ ì¢‹ì§€ë§Œ, ë¨¼ì € ë²„ìŠ¤ì— íƒ„ ì‚¬ëŒì€ ì¸ì› ìˆ˜ê°€ ëª¨ì¼ë•Œê¹Œì§€ ê°€ì§€ ëª»í•˜ê³ , ê¸°ë‹¤ë ¤ì•¼ í•˜ëŠ” ë‹¨ì ì´ ìˆìŠµë‹ˆë‹¤. TCP ì „ì†¡ì—ì„œë„ ì´ê²Œ ê·¸ëŒ€ë¡œ ë°œìƒí•©ë‹ˆë‹¤. ì‘ì€ íŒ¨í‚·ì„ ë³´ë‚´ë©´ ë‹¤ë¥¸ íŒ¨í‚·ì´ ì¶”ê°€ë˜ì–´ì„œ íŠ¹ì • ì‚¬ì´ì¦ˆê°€ ë˜ê¸° ì „ê¹Œì§€ëŠ” ì „ë‹¬ì´ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.(ì •í™•íˆëŠ” send timeout ì´ ë˜ë©´ ì „ì†¡ë©ë‹ˆë‹¤.)</p>
<p>ì˜ˆì „ì— ì„œë¹„ìŠ¤ë¥¼ ìš´ì˜í•˜ë‹¤ë³´ë©´, ë§ˆì§€ë§‰ 2ë°”ì´íŠ¸ê°€ ëª‡ì´ˆ ë’¤ì— ì „ì†¡ë˜ì–´ì„œ í•­ìƒ ë¬¸ì œê°€ ë˜ëŠ” ê²½ìš°ê°€ ë°œìƒí•œ ì ì´ ìˆëŠ”ë°, ê²°êµ­ í•´ë‹¹ ì„œë¹„ìŠ¤ëŠ” TCP_NODELAYë¥¼ ì ìš©í•¨ìœ¼ë¡œì¨ í•´ê²°í–ˆìŠµë‹ˆë‹¤.(ë˜ë‹¤ë¥¸ ë¬¸ì œì˜ ì‹œì‘ì¼ìˆ˜ë„?)</p>
<p>ì•ì— Nagleì„ ì´ë ‡ê²Œ ì„¤ëª…í•œ ê²ƒì„ ì˜ìƒê°í•´ë³´ë©´ DELAYê°€ ìƒê¸°ëŠ” ê±°ê³ , TCP_NODELAYëŠ” ë°”ë¡œ ì´ Nagle ì•Œê³ ë¦¬ì¦˜ì„ ë„ëŠ” ê²ƒì…ë‹ˆë‹¤. ì¦‰ íŒ¨í‚·ì´ ë“¤ì–´ì˜¤ë©´ ë°”ë¡œë°”ë¡œ ì „ì†¡í•˜ëŠ” ê±°ì£ . ì‚¬ì‹¤ ì—¬ê¸°ê¹Œì§€ê°€ ì œê°€ ì•„ëŠ” Nagle ì•Œê³ ë¦¬ì¦˜ì´ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ê°‘ìê¸° TCP_CORK ê°€ ë”±!!!, TCP_CORK ëŠ” Nagleê³¼ ìœ ì‚¬í•œ ì•Œê³ ë¦¬ì¦˜(?) ì…ë‹ˆë‹¤.</p>
<p><a href="https://stackoverflow.com/questions/22124098/is-there-any-significant-difference-between-tcp-cork-and-tcp-nodelay-in-this-use">https://stackoverflow.com/questions/22124098/is-there-any-significant-difference-between-tcp-cork-and-tcp-nodelay-in-this-use</a> í•´ë‹¹ ë§í¬ê°€ ì˜ ì„¤ëª…ì´ ë˜ì–´ ìˆëŠ”ë°, ìš”ì•½í•˜ë©´ Nagleì€ TCP_CORKì˜ ì•½í™”ë²„ì „ì´ê³ , Nagleì€ ACKë¥¼ ì²´í¬í•˜ì§€ë§Œ, TCP_CORKëŠ” ì‚¬ì´ì¦ˆë§Œ ë³¸ë‹¤? ë¼ëŠ” ë­”ê°€ ì„¤ëª…ì´ ìˆëŠ”ë°&#8230;(ê·¸ë ‡ìŠµë‹ˆë‹¤. ì €ëŠ” ì˜ì–´ê°€&#8230;)</p>
<p>ì—¬ê¸°ì„œ ACKëŠ” TCPì—ì„œë„ íŒ¨í‚·ì„ ë³´ë‚´ê³  ë‚˜ë©´ ê±°ê¸°ì— ëŒ€í•œ ACKë¥¼ ë°›ê²Œ ë©ë‹ˆë‹¤. í˜¼ì¡ì œì–´ë‚˜, ì¬ì „ì†¡ì´ë‚˜&#8230; ê·¸ë¦¬ê³  ì‚¬ì´ì¦ˆë¼&#8230; ì € ì‚¬ì´ì¦ˆëŠ” ë­˜ê¹Œìš”. íŒ¨í‚·ì„ ëª¨ì•„ë³´ë‚´ëŠ” ì‚¬ì´ì¦ˆë©´ ì„¤ì •ê°€ëŠ¥í•˜ì§€ ì•Šì„ê¹Œ í•˜ê³  ì°¾ì•„ë³´ë©´, ë”°ë¥¸ ì„¤ì •ì€ ì•ˆë³´ì…ë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ì¢€ ì•„ì‹œëŠ” ë¶„ë“¤ì€ ì•„ ê·¸ê±° ë‹¨ìœ„ë¡œ ë³´ë‚´ê² ë‹¤ê³  ì‰½ê²Œ ìƒê°í•˜ì‹œê² ì§€ë§Œ&#8230; ì „ ëª°ë¼ìš”~~~</p>
<p>ê·¸ëŸ¼ ì´ì œ ì»¤ë„ ì†ŒìŠ¤ë¥¼ ë³´ë©´ì„œ ê°„ë‹¨í•˜ê²Œ ìƒê°í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. net/ipv4/tcp_output.c íŒŒì¼ì„ ë³´ë©´ tcp_write_xmit ë¼ëŠ” í•¨ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ë‹¤ì‹œ tcp_mss_split_point ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.</p>
<pre class="brush: cpp; title: ; notranslate">
......
		limit = mss_now;
		if (tso_segs &gt; 1 &amp;&amp; !tcp_urg_mode(tp))
			limit = tcp_mss_split_point(sk, skb, mss_now,
						    min_t(unsigned int,
							  cwnd_quota,
							  max_segs),
						    nonagle);

......
</pre>
<p>tcp_mss_split_point ë¥¼ ë³´ë©´ needed ê°€ ë²„í¼ì— ì¡´ì¬í•˜ëŠ” íŒ¨í‚·ì˜ ì‚¬ì´ì¦ˆë¡œ ì˜ˆì¸¡ì´ ë©ë‹ˆë‹¤. ì†Œì¼“ ë²„í¼ì— ìˆëŠ” ì‚¬ì´ì¦ˆì™€ window ì‚¬ì´ì¦ˆ ì¤‘ì— ì ì€ê²Œ ì„ íƒì´ ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  max_len ì´ needed ë³´ë‹¤ ì‘ìœ¼ë©´ max_len ì´ ì „ì†¡ì´ ë˜ê³ , ì¤‘ìš”í•œ ë¶€ë¶„ì€ partial ì€ êµ¬í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ëª¨ë“ˆëŸ¬ í•˜ëŠ” ë³€ìˆ˜ëª…ì´ ë³´ì´ì‹œë‚˜ìš”? ì•„ê¹Œ ë§í•œ ê·¸ ì‚¬ì´ì¦ˆëŠ” ë°”ë¡œ mss_now ì¸ ê²ƒì…ë‹ˆë‹¤. ì—¬ê¸°ì„œ partialì€ ì›ë˜ ë„¤íŠ¸ì›ì—ì„œ íŒ¨í‚·ì„ MSS ë‹¨ìœ„ë¡œ ë³´ë‚´ê¸° ë•Œë¬¸ì—, ëª¨ë“ˆëŸ¬ mss_now í•˜ë©´, mssê°€ 1024ì¼ ë•Œ ìš°ë¦¬ê°€ 600ë§Œ ë³´ë‚¸ë‹¤ë©´, 424ë°”ì´íŠ¸ê°€ MSSì— ëª¨ìë¼ê¸° ë•Œë¬¸ì— partial ì€ 424 ë°”ì´íŠ¸ê°€ ë©ë‹ˆë‹¤. ì½”ë“œë¥¼ ë³´ë©´ tcp_nagle_check í•˜ê³ ë‚˜ì„œ trueë©´ nagleì„ ì ìš©í•´ì•¼ í•˜ëŠ” ìƒí™©ì¼í…Œë‹ˆ&#8230; needed &#8211; partial ë§Œí¼ì˜ ì‚¬ì´ì¦ˆë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤. ì¦‰ MSS ë‹¨ìœ„ë¡œ íŒ¨í‚·ì„ ë³´ë‚´ë„ë¡ ì§¤ë¼ì¤€ê±°ì£ .</p>
<pre class="brush: cpp; title: ; notranslate">
static unsigned int tcp_mss_split_point(const struct sock *sk,
					const struct sk_buff *skb,
					unsigned int mss_now,
					unsigned int max_segs,
					int nonagle)
{
	const struct tcp_sock *tp = tcp_sk(sk);
	u32 partial, needed, window, max_len;

	window = tcp_wnd_end(tp) - TCP_SKB_CB(skb)-&gt;seq;
	max_len = mss_now * max_segs;

	if (likely(max_len len, window);

	if (max_len packets_out ì´ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.(ë³´ë‚´ëŠ”ê²Œ ìˆë‹¤ëŠ” ëœ»ìœ¼ë¡œ...) ê·¸ë¦¬ê³  Nagle ì•Œê³ ë¦¬ì¦˜ì—ì„œëŠ” ë§ˆì§€ë§‰ìœ¼ë¡œ minshall ì²´í¬ë¼ëŠ” ê±¸ í•©ë‹ˆë‹¤. TCP_CORKëŠ” ë³„ ë‹¤ë¥¸ê²Œ ì—†ëŠ”ë°, ì•„ê¹Œ Nagleê³¼ì˜ ì²´í¬ì—ì„œ ACKë¥¼ í™•ì¸í•œë‹¤ëŠ” ê±¸ ê¸°ì–µí•˜ì‹œë‚˜ìš”?


static bool tcp_nagle_check(bool partial, const struct tcp_sock *tp,
			    int nonagle)
{
	return partial &amp;&amp;
		((nonagle &amp; TCP_NAGLE_CORK) ||
		 (!nonagle &amp;&amp; tp-&gt;packets_out &amp;&amp; tcp_minshall_check(tp)));
}
</pre>
<p>minshall ì´ë¼ëŠ” ë¶„ì´ ê³„ì‹œë”êµ°ìš”(ë¨¼ì‚°&#8230;) ì´ ì•Œê³ ë¦¬ì¦˜ì€ ê·¸ëƒ¥ ë³´ë‚¸ íŒ¨í‚·ì˜ ì‹œí€€ìŠ¤ì™€ ACK ë°›ì€ íŒ¨í‚·ì˜ ì‹œí€€ìŠ¤ë¥¼ ë¹„êµí•˜ê¸°ë§Œ í•©ë‹ˆë‹¤. ì•„ë˜ before ì™€ afterëŠ” ê·¸ëƒ¥ beforeëŠ” ì•ì— íŒŒë¼ë§¤í„°ê°€ ì‘ìœ¼ë©´ true, afterëŠ” ì•ì— íŒŒë¼ë§¤í„°ê°€ í¬ë©´ true ì…ë‹ˆë‹¤. ì €ê¸°ì„œ snd_smlì€ ë³´ë‚¸ íŒ¨í‚·ì˜ ì‹œí€€ìŠ¤, snd_unaëŠ” ACK ë°›ì€ íŒ¨í‚·ì˜ ì‹œí€€ìŠ¤ì…ë‹ˆë‹¤. &#8220;!after(tp-&gt;snd_sml, tp-&gt;snd_nxt)&#8221; ì´ ì½”ë“œëŠ” ì‹œí€€ìŠ¤ê°€ ì˜¤ë²„í”Œë¡œìš° ë‚œ ê±¸ í™•ì¸í•˜ëŠ” ê±¸ë¡œ ë³´ì…ë‹ˆë‹¤. í•˜ì—¬íŠ¼!!!, ì¦‰ ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ê²ƒì€ ackë¥¼ ë‹¤ ë°›ì•˜ë‹¤ë©´ tp-&gt;snd_sml ê³¼ tp-&gt;snd_unaëŠ” ê°™ì€ ê°’ì¼ ê²ƒì´ë¯€ë¡œ falseê°€ ë¦¬í„´ë©ë‹ˆë‹¤. ì¦‰ tcp_minshall_checkê°€ trueëŠ” í˜„ì¬ ack ë°›ì•„ì•¼í•  íŒ¨í‚·ì´ ë” ìˆë‹¤ë¼ëŠ” ëœ»ì´ê³  falseëŠ” í˜„ì¬ ëª¨ë“  íŒ¨í‚·ì˜ ackë¥¼ ë°›ì•˜ë‹¤ê°€ ë©ë‹ˆë‹¤.</p>
<pre class="brush: cpp; title: ; notranslate">
static inline bool before(__u32 seq1, __u32 seq2)
{
        return (__s32)(seq1-seq2) snd_sml, tp-&gt;snd_una) &amp;&amp;
		!after(tp-&gt;snd_sml, tp-&gt;snd_nxt);
}
</pre>
<p>ê·¸ëŸ¼ ìš”ì•½ì„ í•˜ë©´ TCP_CORKëŠ” ì´ê²ƒì €ê²ƒ í™•ì¸ì•ˆí•˜ê³  ì¼œì§€ë©´ ë¬´ì¡°ê±´ MSS ë‹¨ìœ„ë¡œë§Œ ë³´ë‚´ê² ë‹¤ê°€ ë©ë‹ˆë‹¤. ê·¸ëŸ°ë° Nagleì€ ì „ë¶€ ACKë¥¼ ë°›ì•˜ë‹¤ë©´ 5 byteë§Œ ë³´ë‚¸ë‹¤ê³  í•˜ë”ë¼ë„&#8230; ACKë¥¼ ëª¨ë‘ ë°›ì•˜ìœ¼ë¯€ë¡œ tcp_minshall_check ê°€ false ê°€ ë˜ì–´ì„œ, íŒ¨í‚·ì´ ë³´ë‚´ì§‘ë‹ˆë‹¤. ìš”ì•½í•˜ë©´ mssê°€ 1024ì´ê³  4100 ë°”ì´íŠ¸ë¥¼ ë³´ë‚¸ë‹¤ë©´ partial = 4100 % 1024 = 4, TCP_CORKì—ì„œëŠ” ë§ˆì§€ë§‰ 4ë°”ì´íŠ¸ëŠ” ì „ì†¡ì´ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì–¸ì œê¹Œì§€? timeout ì´ ë°œìƒí• ë•Œê¹Œì§€&#8230;, ê·¸ëŸ¬ë‚˜ Nagleì€&#8230; ACKë¥¼ ë°›ì„ íŒ¨í‚·ì´ ë‚¨ì•„ìˆë‹¤ë©´ ë§ˆì§€ë§‰ 4ë°”ì´íŠ¸ê°€ ì „ì†¡ì´ ì•ˆë˜ì§€ë§Œ, ACKë¥¼ ëª¨ë‘ ë°›ì•˜ë‹¤ë©´&#8230; ë§ˆì§€ë§‰ 4ë°”ì´íŠ¸ë„ ì „ì†¡ì´ ë˜ê²Œ ë©ë‹ˆë‹¤. ì´ê²Œ ë‘ ê°€ì§€ ì˜µì…˜ì˜ ì°¨ì´ì´ê³ , Nagleì´, TCP_CORK ë³´ë‹¤ ì¡°ê¸ˆ ì•½í•œ ì œì•½ì´ë¼ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.</p>
]]></content:encoded>
							<wfw:commentRss>https://charsyam.wordpress.com/2019/03/14/%ec%9e%85%ea%b0%9c%eb%b0%9c-nagle-%ec%95%8c%ea%b3%a0%eb%a6%ac%ec%a6%98%ea%b3%bc-tcp_cork/feed/</wfw:commentRss>
		<slash:comments>3</slash:comments>
						
		<media:content url="https://2.gravatar.com/avatar/eb957612b8f29b31a16f21df385691ed?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">charsyam</media:title>
		</media:content>
	</item>
		<item>
		<title>[ì… ê°œë°œ] spark-submit ì‹œì— &#8211;properties-file ì™€ íŒŒë¼ë§¤í„°ì—ì„œì˜ ìš°ì„  ìˆœìœ„</title>
		<link>https://charsyam.wordpress.com/2019/03/10/%ec%9e%85-%ea%b0%9c%eb%b0%9c-spark-submit-%ec%8b%9c%ec%97%90-properties-file-%ec%99%80-%ed%8c%8c%eb%9d%bc%eb%a7%a4%ed%84%b0%ec%97%90%ec%84%9c%ec%9d%98-%ec%9a%b0%ec%84%a0-%ec%88%9c%ec%9c%84/</link>
				<comments>https://charsyam.wordpress.com/2019/03/10/%ec%9e%85-%ea%b0%9c%eb%b0%9c-spark-submit-%ec%8b%9c%ec%97%90-properties-file-%ec%99%80-%ed%8c%8c%eb%9d%bc%eb%a7%a4%ed%84%b0%ec%97%90%ec%84%9c%ec%9d%98-%ec%9a%b0%ec%84%a0-%ec%88%9c%ec%9c%84/#comments</comments>
				<pubDate>Sun, 10 Mar 2019 15:56:41 +0000</pubDate>
		<dc:creator><![CDATA[charsyam]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://charsyam.wordpress.com/?p=2772</guid>
				<description><![CDATA[ì–´ì©Œë‹¤ë³´ë‹ˆ&#8230; ê°‘ìê¸° SparkSubmit ì‹œì— ì‚¬ìš©ë˜ëŠ” &#8211;properties-file(ì¼ì¢…ì˜ spark-defaults.conf)ì™€ ê·¸ëƒ¥ íŒŒë¼ë§¤í„°ë¡œ ë„˜ê¸°ëŠ” ê²ƒì˜ ìš°ì„ ìˆœìœ„ê°€ ì–´ë–»ê²Œ ì ìš©ë˜ëŠ”ì§€ê°€ ê¶ê¸ˆí•´ ì¡ŒìŠµë‹ˆë‹¤. ë­, ë‹¹ì—°íˆ ì¼ë°˜ì ìœ¼ë¡œ ìƒê°í•˜ë©´ íŒŒë¼ë§¤í„°ë¡œ ë„˜ê¸°ëŠ” ê²ƒì´ ë¶„ëª…íˆ spark-defaults.conf ì— ë“¤ì–´ê°€ìˆëŠ” ê²ƒ ë³´ë‹¤ëŠ” ìš°ì„ ì´ ë˜ëŠ”ê²Œ ë‹¹ì—°í•˜ê² ì§€ë¼ëŠ” ìƒê°ì„ ê°€ì§€ê³  ìˆì—ˆê³ , ê²°ë¡ ë¶€í„° ë§í•˜ìë©´, ì´ê²Œ ë§ìŠµë‹ˆë‹¤.(ë‹¤ë¥¼ ìˆ˜ê°€ ì—†ì–ì•„!!! í½í½í½) ê·¸ëŸ¬ë‚˜, ìš°ë¦¬ëŠ” ê³µëŒì´ë‹ˆ ê·¸ë˜ë„ ëª…í™•í•˜ê²Œ í•´ë‘ìë¼ëŠ” ìƒê°ì´ ë“¤ì–´ì„œ, ì†ŒìŠ¤ë¥¼ ê°€ë³ê²Œ ì‚´í´ë´¤ìŠµë‹ˆë‹¤. ì‹¤ì œë¡œ í•´ë‹¹ [&#8230;]]]></description>
								<content:encoded><![CDATA[<p>ì–´ì©Œë‹¤ë³´ë‹ˆ&#8230; ê°‘ìê¸° SparkSubmit ì‹œì— ì‚¬ìš©ë˜ëŠ” &#8211;properties-file(ì¼ì¢…ì˜ spark-defaults.conf)ì™€ ê·¸ëƒ¥ íŒŒë¼ë§¤í„°ë¡œ ë„˜ê¸°ëŠ” ê²ƒì˜ ìš°ì„ ìˆœìœ„ê°€ ì–´ë–»ê²Œ ì ìš©ë˜ëŠ”ì§€ê°€ ê¶ê¸ˆí•´ ì¡ŒìŠµë‹ˆë‹¤. ë­, ë‹¹ì—°íˆ ì¼ë°˜ì ìœ¼ë¡œ ìƒê°í•˜ë©´ íŒŒë¼ë§¤í„°ë¡œ ë„˜ê¸°ëŠ” ê²ƒì´ ë¶„ëª…íˆ spark-defaults.conf ì— ë“¤ì–´ê°€ìˆëŠ” ê²ƒ ë³´ë‹¤ëŠ” ìš°ì„ ì´ ë˜ëŠ”ê²Œ ë‹¹ì—°í•˜ê² ì§€ë¼ëŠ” ìƒê°ì„ ê°€ì§€ê³  ìˆì—ˆê³ , ê²°ë¡ ë¶€í„° ë§í•˜ìë©´, ì´ê²Œ ë§ìŠµë‹ˆë‹¤.(ë‹¤ë¥¼ ìˆ˜ê°€ ì—†ì–ì•„!!! í½í½í½)</p>
<p>ê·¸ëŸ¬ë‚˜, ìš°ë¦¬ëŠ” ê³µëŒì´ë‹ˆ ê·¸ë˜ë„ ëª…í™•í•˜ê²Œ í•´ë‘ìë¼ëŠ” ìƒê°ì´ ë“¤ì–´ì„œ, ì†ŒìŠ¤ë¥¼ ê°€ë³ê²Œ ì‚´í´ë´¤ìŠµë‹ˆë‹¤.<br />
ì‹¤ì œë¡œ í•´ë‹¹ ë‚´ìš©ì€ &#8220;core/src/main/scala/org/apache/spark/deploy/SparkSubmitArguments.scala&#8221; íŒŒì¼ì„ ì‚´í´ë³´ë©´ ë“¤ì–´ìˆìŠµë‹ˆë‹¤. ì¼ë‹¨ main ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ì•„ì£¼ ê°„ë‹¨íˆ í™•ì¸í•  ê²ƒì¸ë°&#8230; ì´ë¦„ ë¶€í„° ì´ë¯¸ parse ì™€ mergeDefaultSparkProperties ê°€ ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ìš°ì„ ìˆœìœ„ê°€ ê¶ê¸ˆí•  ë¿ì´ë‹ˆ&#8230; parse ì—ì„œ ê°€ì ¸ì˜¨ ê²ƒë“¤ì„ mergeDefaultSparkProperties ì—ì„œ ë®ì–´ì“¸ê¹Œë§Œ í™•ì¸í•˜ë©´ ë©ë‹ˆë‹¤.</p>
<pre class="brush: scala; title: ; notranslate">
  parse(args.asJava)
  // Populate `sparkProperties` map from properties file
  mergeDefaultSparkProperties()
  // Remove keys that don't start with "spark." from `sparkProperties`.
  ignoreNonSparkProperties()
  // Use `sparkProperties` map along with env vars to fill in any missing parameters
  loadEnvironmentArguments()
  useRest = sparkProperties.getOrElse("spark.master.rest.enabled", "false").toBoolean
  validateArguments()
</pre>
<p>parseë¥¼ í™•ì¸í•´ ë´…ì‹œë‹¤. íŠ¹ë³„íˆ ì¤‘ìš”í•œ ê²ƒì€ ì—†ê³  findCliOption ê°€ ë„˜ê²¨ì§„ opts ì¤‘ì—ì„œ í•´ë‹¹ ì˜µì…˜ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ì½”ë“œì´ê³  handle ì—ì„œ ì‹¤ì œë¡œ í•´ë‹¹ ê°’ì„ ì…‹íŒ…í•˜ëŠ” ì½”ë“œê°€ ìˆìŠµë‹ˆë‹¤.</p>
<pre class="brush: scala; title: ; notranslate">
  protected final void parse(List args) {
    Pattern eqSeparatedOpt = Pattern.compile("(--[^=]+)=(.+)");

    int idx = 0;
    for (idx = 0; idx 
      val properties = Utils.getPropertiesFromFile(filename)
      properties.foreach { case (k, v) =&gt;
        defaultProperties(k) = v
      }
      // Property files may contain sensitive information, so redact before printing
      if (verbose) {
        Utils.redact(properties).foreach { case (k, v) =&gt;
          logInfo(s"Adding default property: $k=$v")
        }
      }
    }
    defaultProperties
  }
</pre>
<p>ì¦‰ defaultProperties -&gt; sparkProperties ë¡œ ì €ì¥ì´ ë˜ëŠ” ê²ë‹ˆë‹¤. ê·¸ëŸ¬ë©´. ì‹¤ì œë¡œ ì´ ê°’ì˜ ìš°ì„ ìˆœìœ„ëŠ” ì–´ë””ì— ì €ì¥ì´ ë˜ëŠ”ê°€? ì‹¤ì œë¡œ loadEnvironmentArguments ì—ì„œ í•´ë‹¹ ê°’ì´ ì„¤ì •ì´ ë©ë‹ˆë‹¤. ì•„ë˜ì— ë³´ì‹œë©´ Optionì— ë¨¼ì € executorMemory ê°€ NULL ì´ë©´ orElse ë¡œ ì•„ê¹Œ ì €ì¥í•œ sparkProperties ì—ì„œ ê°€ì ¸ì˜¤ê³  ê·¸ë˜ë„ ì—†ìœ¼ë©´ í™˜ê²½ ë³€ìˆ˜ì—ì„œ ê°€ì ¸ì˜¤ê³ , ê·¸ë˜ë„ ì—†ìœ¼ë©´ Nullì´ ë¦¬í„´ë©ë‹ˆë‹¤.</p>
<pre class="brush: scala; title: ; notranslate">
  private def loadEnvironmentArguments(): Unit = {
    ......
    executorMemory = Option(executorMemory)
      .orElse(sparkProperties.get(config.EXECUTOR_MEMORY.key))
      .orElse(env.get("SPARK_EXECUTOR_MEMORY"))
      .orNull
    ......
  }
</pre>
<p>ë§ˆì§€ë§‰ìœ¼ë¡œ ì •ë¦¬í•˜ë©´ ê²°êµ­ ìš°ì„ ìˆœìœ„ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<ol>
<li>íŒŒë¼ë§¤í„°ë¡œ ì „ë‹¬í•¨ &#8211;executor-memory ì´ëŸ°ì‹ìœ¼ë¡œ</li>
<li>properties-file ë¡œ ì €ì¥í•œ ê°’</li>
<li>í™˜ê²½ë³€ìˆ˜</li>
</ol>
<p>ê·¸ëŸ°ë° ë¬´ì¡°ê±´ ë˜ëŠ”ê°€ì— ëŒ€í•œ ê³ ë¯¼ì„ ë” í•˜ì…”ì•¼ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ íŒŒë¼ë§¤í„°ë¡œ ë„˜ê¸¸ ìˆ˜ ìˆëŠ” ê²ƒì´ 100%ëŠ” ì•„ë‹™ë‹ˆë‹¤. ë‹¤ë¥¸ ì„¤ì •ì´ spark ì„¤ì • íŒŒì¼ì— ìˆì„ ìˆ˜ ê°€ ìˆëŠ” ê±°ì£ . ì¦‰ spark.yarn.executor.memoryOverhead ì´ëŸ° ê°’ì´ spark ì„¤ì • íŒŒì¼ì— ìˆë‹¤ë©´, ì—¬ì „íˆ ì´ê²ƒ ë•Œë¬¸ì— ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤ë¼ëŠ” ê²ƒì„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤.</p>
]]></content:encoded>
							<wfw:commentRss>https://charsyam.wordpress.com/2019/03/10/%ec%9e%85-%ea%b0%9c%eb%b0%9c-spark-submit-%ec%8b%9c%ec%97%90-properties-file-%ec%99%80-%ed%8c%8c%eb%9d%bc%eb%a7%a4%ed%84%b0%ec%97%90%ec%84%9c%ec%9d%98-%ec%9a%b0%ec%84%a0-%ec%88%9c%ec%9c%84/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
						
		<media:content url="https://2.gravatar.com/avatar/eb957612b8f29b31a16f21df385691ed?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">charsyam</media:title>
		</media:content>
	</item>
		<item>
		<title>[êµ¬ê¸€ìŠ¤í„°ë””ì¼] Kubernetes in the Google Cloud #3</title>
		<link>https://charsyam.wordpress.com/2019/01/27/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-3/</link>
				<comments>https://charsyam.wordpress.com/2019/01/27/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-3/#respond</comments>
				<pubDate>Sun, 27 Jan 2019 06:45:14 +0000</pubDate>
		<dc:creator><![CDATA[charsyam]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://charsyam.wordpress.com/?p=2766</guid>
				<description><![CDATA[í•´ë‹¹ ê¸€ì€ í˜„ì¬ í•˜ê³  ìˆëŠ” êµ¬ê¸€ ìŠ¤í„°ë””ì¼ Kubernetes in the Google Cloud ì„ í•™ìŠµí•˜ëŠ” ê³¼ì •ì—ì„œ ë°°ìš°ëŠ” ê²ƒì„ ì •ë¦¬í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤. Â * Setting up a Private Kubernetes Cluster ì™¸ë¶€ IPë¥¼ ê°€ì§€ê³  ì•Šê³  ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ ip ëŒ€ì—­ë§Œ ê°€ì§€ê³  ë™ì‘í•˜ê²Œ ë˜ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì†Œê°œí•˜ëŠ” ì„¸ì…˜ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  í•´ë‹¹ í´ëŸ¬ìŠ¤í„° masterì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë„¤íŠ¸ì› ëŒ€ì—­ì„ ì§€ì •í•  ìˆ˜ [&#8230;]]]></description>
								<content:encoded><![CDATA[<p>í•´ë‹¹ ê¸€ì€ í˜„ì¬ í•˜ê³  ìˆëŠ” êµ¬ê¸€ ìŠ¤í„°ë””ì¼ Kubernetes in the Google Cloud ì„ í•™ìŠµí•˜ëŠ” ê³¼ì •ì—ì„œ ë°°ìš°ëŠ” ê²ƒì„ ì •ë¦¬í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤.</p>
<p>Â * Setting up a Private Kubernetes Cluster<br />
 ì™¸ë¶€ IPë¥¼ ê°€ì§€ê³  ì•Šê³  ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ ip ëŒ€ì—­ë§Œ ê°€ì§€ê³  ë™ì‘í•˜ê²Œ ë˜ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì†Œê°œí•˜ëŠ” ì„¸ì…˜ì…ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
gcloud beta container clusters create private-cluster \
    --private-cluster \
    --master-ipv4-cidr 172.16.0.16/28 \
    --enable-ip-alias \
    --create-subnetwork ""
</pre>
<p>ê·¸ë¦¬ê³  í•´ë‹¹ í´ëŸ¬ìŠ¤í„° masterì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë„¤íŠ¸ì› ëŒ€ì—­ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ MY_EXTERNAL_RANGE ëŠ” CIDR í˜•íƒœë¡œ 172.16.0.16/28 ê°™ì€ í˜•íƒœë¡œ í‘œí˜„í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
gcloud container clusters update private-cluster \
    --enable-master-authorized-networks \
    --master-authorized-networks [MY_EXTERNAL_RANGE]
</pre>
<p>Â </p>
<ul>
<li>Helm Package Manager<br />
Helm ì€ ì¿ ë²„ë„¤í‹°ìŠ¤ ìœ„ì—ì„œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ê´€ë¦¬í•˜ëŠ” ë§¤ë‹ˆì € íˆ´ì…ë‹ˆë‹¤. í´ë¼ì´ì–¸íŠ¸/ì„œë²„ êµ¬ì¡°ë¡œ êµ¬ì„±ë˜ê³  í´ë¼ì´ì–¸íŠ¸ëŠ” Helm, ì„œë²„ëŠ” tiller ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.</p>
<p>Helm ì˜ ì„¤ì¹˜ëŠ” ë‹¤ìŒê³¼ì •ì„ í†µí•´ì„œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
curl https://raw.githubusercontent.com/kubernetes/helm/master/scripts/get &gt; get_helm.sh
chmod 700 get_helm.sh
./get_helm.sh
kubectl -n kube-system create sa tiller
</pre>
<p>ê·¸ë¦¬ê³  tiller roleì„ ì„¤ì •í•´ì¤ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
kubectl create clusterrolebinding tiller --clusterrole cluster-admin --serviceaccount=kube-system:tiller
</pre>
<p>tillerë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
helm init --service-account tiller
</pre>
<p>ì´ì œ ê±°ê¸°ì— ì˜¬ë¼ê°€ì„œ ë™ì‘í•  chartë¥¼ ì„¤ì¹˜í•´ë´…ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
helm repo update
helm install stable/mysql
</pre>
</p>
</li>
<li>
<p>NGINX Ingress Controller on Google Kubernetes Engine<br />
IngressëŠ” í•´ë‹¹ ë…¸ë“œë¡œ ë“¤ì–´ì˜¤ëŠ” íŠ¸ë˜í”½, EgressëŠ” í•´ë‹¹ ë…¸ë“œì—ì„œ ì™¸ë¶€ë¡œ ë‚˜ê°€ëŠ” íŠ¸ë˜í”½ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ì•ì—ì„œ ë°°ìš´ Helmì„ ì´ìš©í•´ì„œ, nginx ë¼ëŠ” ì¢‹ì€ ì›¹ì„œë²„ë¥¼ ì´ìš©í•´ì„œ Ingress íŠ¸ë˜í”½ì„ ì œì–´í•˜ëŠ” ì˜ˆë¥¼ ë³´ì—¬ì£¼ê²Œ ë©ë‹ˆë‹¤. Ingress íŠ¸ë˜í”½ì„ ì œì™¸í•œë‹¤ëŠ” ê²ƒì€ íŠ¹ì • ìš”ì²­ì„ ë‹¤ë¥¸ê³³ìœ¼ë¡œ ë³´ë‚¸ë‹¤ê±°ë‚˜, ë°”ê¿€ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</li>
</ul>
<p><img data-attachment-id="2767" data-permalink="https://charsyam.wordpress.com/2019/01/27/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-3/ingress/#main" data-orig-file="https://charsyam.files.wordpress.com/2019/01/ingress.png?w=776" data-orig-size="1794,1252" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ingress" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2019/01/ingress.png?w=776?w=300" data-large-file="https://charsyam.files.wordpress.com/2019/01/ingress.png?w=776?w=776" src="https://charsyam.files.wordpress.com/2019/01/ingress.png?w=776" alt="ingress"   class="alignnone size-full wp-image-2767" srcset="https://charsyam.files.wordpress.com/2019/01/ingress.png?w=776 776w, https://charsyam.files.wordpress.com/2019/01/ingress.png?w=1552 1552w, https://charsyam.files.wordpress.com/2019/01/ingress.png?w=150 150w, https://charsyam.files.wordpress.com/2019/01/ingress.png?w=300 300w, https://charsyam.files.wordpress.com/2019/01/ingress.png?w=768 768w, https://charsyam.files.wordpress.com/2019/01/ingress.png?w=1024 1024w" sizes="(max-width: 776px) 100vw, 776px" /></p>
<p>ë¨¼ì € kubenetes í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
gcloud container clusters create nginx-tutorial --num-nodes 2
</pre>
<p>ê·¸ë¦¬ê³  helm ì„ ì¸ìŠ¤í†¨í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
curl https://raw.githubusercontent.com/kubernetes/helm/master/scripts/get &gt; get_helm.sh
chmod 700 get_helm.sh
./get_helm.sh
</pre>
<p>Role based access control(RBAC) ì„¤ì •ì„ í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
kubectl create serviceaccount --namespace kube-system tiller
kubectl create clusterrolebinding tiller-cluster-rule --clusterrole=cluster-admin --serviceaccount=kube-system:tiller
kubectl patch deploy --namespace kube-system tiller-deploy -p '{"spec":{"template":{"spec":{"serviceAccount":"tiller"}}}}'  

helm init --service-account tiller --upgrade
</pre>
<p>ì´ì œ hello-app ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
 kubectl run hello-app --image=gcr.io/google-samples/hello-app:1.0 --port=8080
 kubectl expose deployment hello-app
</pre>
<p>ì´ì œ ingress ìš© nginxë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
helm install --name nginx-ingress stable/nginx-ingress --set rbac.create=true
</pre>
<p><img data-attachment-id="2768" data-permalink="https://charsyam.wordpress.com/2019/01/27/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-3/%e1%84%89%e1%85%b3%e1%84%8f%e1%85%b3%e1%84%85%e1%85%b5%e1%86%ab%e1%84%89%e1%85%a3%e1%86%ba-2019-01-27-%e1%84%8b%e1%85%a9%e1%84%92%e1%85%ae-3-42-38/#main" data-orig-file="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-27-á„‹á…©á„’á…®-3.42.38.png?w=776" data-orig-size="1210,646" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2019-01-27 á„‹á…©á„’á…® 3.42.38" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-27-á„‹á…©á„’á…®-3.42.38.png?w=776?w=300" data-large-file="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-27-á„‹á…©á„’á…®-3.42.38.png?w=776?w=776" src="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-27-á„‹á…©á„’á…®-3.42.38.png?w=776" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2019-01-27 á„‹á…©á„’á…® 3.42.38"   class="alignnone size-full wp-image-2768" srcset="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-27-á„‹á…©á„’á…®-3.42.38.png?w=776 776w, https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-27-á„‹á…©á„’á…®-3.42.38.png?w=150 150w, https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-27-á„‹á…©á„’á…®-3.42.38.png?w=300 300w, https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-27-á„‹á…©á„’á…®-3.42.38.png?w=768 768w, https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-27-á„‹á…©á„’á…®-3.42.38.png?w=1024 1024w, https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-27-á„‹á…©á„’á…®-3.42.38.png 1210w" sizes="(max-width: 776px) 100vw, 776px" /></p>
<p>ì´ì œ ìœ„ì™€ ê°™ì´ nginx-ingressë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
kubectl apply -f ingress-resource.yaml
</pre>
<p><strong>Reference</strong></p>
<ol>
<li><a href="https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/" rel="nofollow">https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/</a></li>
<li><a href="https://arisu1000.tistory.com/27835" rel="nofollow">https://arisu1000.tistory.com/27835</a></li>
<li><a href="https://sktelecom-oslab.github.io/Virtualization-Software-Lab/Helm/" rel="nofollow">https://sktelecom-oslab.github.io/Virtualization-Software-Lab/Helm/</a></li>
<li><a href="https://kubernetes.io/blog/2016/10/helm-charts-making-it-simple-to-package-and-deploy-apps-on-kubernetes/" rel="nofollow">https://kubernetes.io/blog/2016/10/helm-charts-making-it-simple-to-package-and-deploy-apps-on-kubernetes/</a></li>
<li><a href="https://bcho.tistory.com/1272" rel="nofollow">https://bcho.tistory.com/1272</a></li>
</ol>
]]></content:encoded>
							<wfw:commentRss>https://charsyam.wordpress.com/2019/01/27/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-3/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
						
		<media:content url="https://2.gravatar.com/avatar/eb957612b8f29b31a16f21df385691ed?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">charsyam</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2019/01/ingress.png" medium="image">
			<media:title type="html">ingress</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-27-á„‹á…©á„’á…®-3.42.38.png" medium="image">
			<media:title type="html">á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2019-01-27 á„‹á…©á„’á…® 3.42.38</media:title>
		</media:content>
	</item>
		<item>
		<title>[êµ¬ê¸€ìŠ¤í„°ë””ì¼] Kubernetes in the Google Cloud #2</title>
		<link>https://charsyam.wordpress.com/2019/01/20/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-2/</link>
				<comments>https://charsyam.wordpress.com/2019/01/20/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-2/#respond</comments>
				<pubDate>Sun, 20 Jan 2019 12:30:45 +0000</pubDate>
		<dc:creator><![CDATA[charsyam]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://charsyam.wordpress.com/?p=2759</guid>
				<description><![CDATA[í•´ë‹¹ ê¸€ì€ í˜„ì¬ í•˜ê³  ìˆëŠ” êµ¬ê¸€ ìŠ¤í„°ë””ì¼ Kubernetes in the Google Cloud ì„ í•™ìŠµí•˜ëŠ” ê³¼ì •ì—ì„œ ë°°ìš°ëŠ” ê²ƒì„ ì •ë¦¬í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤. 3ì¥ ë¶€í„° 4ì¥ì€ Kubernetes ì—ì„œ Pod, Service, Scalingê³¼ deployment ë¥¼ ë³´ì—¬ì£¼ê³ , 5,6ì¥ì€ ì  í‚¨ìŠ¤ì™€ slackbot ì˜ˆì œë¥¼ ë³´ì—¬ì£¼ê³  ìˆìŠµë‹ˆë‹¤. ì‹¤ì œë¡œ ì´ ì˜ˆì œë¥¼ ë”°ë¼ê°€ë‹¤ ë³´ë©´, ì˜ì–´ë¥¼ ì°©ì‹¤í•˜ê²Œ ë³´ì§€ ì•ŠëŠ”ë‹¤ë©´, PodëŠ” ë¬´ì—‡ì´ê³  ServiceëŠ” ë¬´ì—‡ì¸ê°€ì— ëŒ€í•´ì„œ ë§‰ í˜¼ë€ì´ ì˜¤ê²Œ ë©ë‹ˆë‹¤. PodëŠ” [&#8230;]]]></description>
								<content:encoded><![CDATA[<p>í•´ë‹¹ ê¸€ì€ í˜„ì¬ í•˜ê³  ìˆëŠ” êµ¬ê¸€ ìŠ¤í„°ë””ì¼ Kubernetes in the Google Cloud ì„ í•™ìŠµí•˜ëŠ” ê³¼ì •ì—ì„œ ë°°ìš°ëŠ” ê²ƒì„ ì •ë¦¬í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤.</p>
<p>3ì¥ ë¶€í„° 4ì¥ì€ Kubernetes ì—ì„œ Pod, Service, Scalingê³¼ deployment ë¥¼ ë³´ì—¬ì£¼ê³ , 5,6ì¥ì€ ì  í‚¨ìŠ¤ì™€ slackbot ì˜ˆì œë¥¼ ë³´ì—¬ì£¼ê³  ìˆìŠµë‹ˆë‹¤.</p>
<p>ì‹¤ì œë¡œ ì´ ì˜ˆì œë¥¼ ë”°ë¼ê°€ë‹¤ ë³´ë©´, ì˜ì–´ë¥¼ ì°©ì‹¤í•˜ê²Œ ë³´ì§€ ì•ŠëŠ”ë‹¤ë©´, PodëŠ” ë¬´ì—‡ì´ê³  ServiceëŠ” ë¬´ì—‡ì¸ê°€ì— ëŒ€í•´ì„œ ë§‰ í˜¼ë€ì´ ì˜¤ê²Œ ë©ë‹ˆë‹¤.</p>
<p>PodëŠ” í•˜ë‚˜ ë˜ëŠ” ì—¬ëŸ¬ê°œì˜ ì»¨í…Œì´ë„ˆì™€ ë³¼ë¥¨ìœ¼ë¡œ êµ¬ì„±ëœ ì˜¤ë¸Œì íŠ¸ì…ë‹ˆë‹¤. namespace ë¥¼ ê³µìœ í•˜ê³  Podë‹¹ í•˜ë‚˜ì˜ ipê°€ í• ë‹¹ë©ë‹ˆë‹¤.(ì—¬ê¸°ì„œ í• ë‹¹ë˜ëŠ” ipëŠ” public ì¼ìˆ˜ë„ ìˆê³ , ê·¸ëƒ¥ private ì¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜, ë³´í†µ private ì´ í• ë‹¹ë˜ê² ì£ ?)</p>
<p><img data-attachment-id="2760" data-permalink="https://charsyam.wordpress.com/2019/01/20/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-2/pods_1/#main" data-orig-file="https://charsyam.files.wordpress.com/2019/01/pods_1.jpg?w=776" data-orig-size="960,540" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="pods_1" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2019/01/pods_1.jpg?w=776?w=300" data-large-file="https://charsyam.files.wordpress.com/2019/01/pods_1.jpg?w=776?w=776" class="alignnone size-full wp-image-2760" src="https://charsyam.files.wordpress.com/2019/01/pods_1.jpg?w=776" alt="pods_1" srcset="https://charsyam.files.wordpress.com/2019/01/pods_1.jpg?w=776 776w, https://charsyam.files.wordpress.com/2019/01/pods_1.jpg?w=150 150w, https://charsyam.files.wordpress.com/2019/01/pods_1.jpg?w=300 300w, https://charsyam.files.wordpress.com/2019/01/pods_1.jpg?w=768 768w, https://charsyam.files.wordpress.com/2019/01/pods_1.jpg 960w" sizes="(max-width: 776px) 100vw, 776px"   /></p>
<p>ê·¸ë¦¬ê³  ServiceëŠ” íŠ¹ì • Podë“¤ì— ëŒ€í•œ endpoint ê°€ ë©ë‹ˆë‹¤. í•´ë‹¹ Serviceì˜ endpoint ì— ì ‘ì†í•˜ë©´ ì•„ë˜ì˜ Podë“¤ì—ê²Œ ìë™ìœ¼ë¡œ ë°ì´í„°ê°€ í•œë²ˆì”© ì „ë‹¬ë˜ê²Œ ë©ë‹ˆë‹¤.(Load Balancer ì—­í• )</p>
<p><img data-attachment-id="2761" data-permalink="https://charsyam.wordpress.com/2019/01/20/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-2/service_1/#main" data-orig-file="https://charsyam.files.wordpress.com/2019/01/service_1.jpg?w=776" data-orig-size="960,540" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="service_1" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2019/01/service_1.jpg?w=776?w=300" data-large-file="https://charsyam.files.wordpress.com/2019/01/service_1.jpg?w=776?w=776" class="alignnone size-full wp-image-2761" src="https://charsyam.files.wordpress.com/2019/01/service_1.jpg?w=776" alt="service_1" srcset="https://charsyam.files.wordpress.com/2019/01/service_1.jpg?w=776 776w, https://charsyam.files.wordpress.com/2019/01/service_1.jpg?w=150 150w, https://charsyam.files.wordpress.com/2019/01/service_1.jpg?w=300 300w, https://charsyam.files.wordpress.com/2019/01/service_1.jpg?w=768 768w, https://charsyam.files.wordpress.com/2019/01/service_1.jpg 960w" sizes="(max-width: 776px) 100vw, 776px"   /></p>
<p>ì˜ˆì œë¥¼ ì‚´í´ë´ë„, í•˜ë‚˜ì˜ Podê°€ ì—¬ëŸ¬ê°œì˜ containerë¥¼ í¬í•¨í•˜ì§€ë§Œ, í•˜ë‚˜ì˜ Podê°€ í•œ ì¢…ë¥˜ì˜ ì—¬ëŸ¬ Containerë¥¼ ê°€ì§€ëŠ” ê±¸ë¡œ ë³´ì´ì§€ëŠ” ì•Šê³ , í•˜ë‚˜ì˜ ì„œë²„ ë‹¨ìœ„ê°€ í•˜ë‚˜ì˜ Podë¼ê³  ë´ë„ ë ë“¯í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í•˜ë‚˜ì˜ Podì— API Server, Volume ê°€ ë“¤ì–´ê°€ê³ , ì´ì œ Serviceê°€ ê·¸ Podë“¤ì„ ë¡œë“œë°¸ëŸ°ì‹± í•©ë‹ˆë‹¤. ì„œë¹„ìŠ¤ì— ë” ì²˜ë¦¬ìš©ëŸ‰ì´ í•„ìš”í•˜ë©´, Podë¥¼ ê³„ì† ì¶”ê°€í•˜ëŠ” ê±°ì£ . ì´ì œ kubernetesì˜ scaling ì´ë¼ê³  ë³´ì‹œë©´ ë©ë‹ˆë‹¤.</p>
<p>ì•„ë˜ ê·¸ë¦¼ì„ ë³´ë©´ kind ê°€ Podë¡œ ë‚˜ì˜µë‹ˆë‹¤.<br />
<img data-attachment-id="2764" data-permalink="https://charsyam.wordpress.com/2019/01/20/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-2/%e1%84%89%e1%85%b3%e1%84%8f%e1%85%b3%e1%84%85%e1%85%b5%e1%86%ab%e1%84%89%e1%85%a3%e1%86%ba-2019-01-20-%e1%84%8b%e1%85%a9%e1%84%92%e1%85%ae-8-00-53/#main" data-orig-file="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.53.png?w=776" data-orig-size="736,974" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2019-01-20 á„‹á…©á„’á…® 8.00.53" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.53.png?w=776?w=227" data-large-file="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.53.png?w=776?w=736" src="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.53.png?w=776" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2019-01-20 á„‹á…©á„’á…® 8.00.53"   class="alignnone size-full wp-image-2764" srcset="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.53.png 736w, https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.53.png?w=113 113w, https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.53.png?w=227 227w" sizes="(max-width: 736px) 100vw, 736px" /></p>
<p>ê·¸ë¦¬ê³  ì´ Pod ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‹¤í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
kubectl create -f pods/monolith.yaml
</pre>
<p>ì´ì œ ì´ ì•ë‹¨ì— ë“¤ì–´ê°ˆ ì„œë¹„ìŠ¤ë¥¼ ìƒì„±í•´ë´…ì‹œë‹¤.</p>
<p><img data-attachment-id="2763" data-permalink="https://charsyam.wordpress.com/2019/01/20/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-2/%e1%84%89%e1%85%b3%e1%84%8f%e1%85%b3%e1%84%85%e1%85%b5%e1%86%ab%e1%84%89%e1%85%a3%e1%86%ba-2019-01-20-%e1%84%8b%e1%85%a9%e1%84%92%e1%85%ae-8-00-40/#main" data-orig-file="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.40.png?w=776" data-orig-size="438,610" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2019-01-20 á„‹á…©á„’á…® 8.00.40" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.40.png?w=776?w=215" data-large-file="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.40.png?w=776?w=438" src="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.40.png?w=776" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2019-01-20 á„‹á…©á„’á…® 8.00.40"   class="alignnone size-full wp-image-2763" srcset="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.40.png 438w, https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.40.png?w=108 108w, https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.40.png?w=215 215w" sizes="(max-width: 438px) 100vw, 438px" /></p>
<p>ìƒì„±í•˜ëŠ” ë°©ë²•ì€ ë™ì¼í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
kubectl create -f service/monolith.yaml
</pre>
<p>ë˜, ë…¼ë¦¬ì ìœ¼ë¡œ êµ¬ë¶„í•˜ëŠ” Namespace ë¼ëŠ” ê°œë…ê³¼, Label ì´ë¼ëŠ” ê°œë…ì„ ì´ìš©í•´ì„œ ê´€ë¦¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. í•´ë‹¹ PodëŠ” frontend ë‹¤, backendë‹¤ ì´ëŸ°ì‹ìœ¼ë¡œ íƒœê·¸ë¥¼ ë‹¬ì•„ì£¼ëŠ” ê²ƒì´ì£ .</p>
<p>ê·¸ë¦¬ê³  ì´ëŸ° ì˜¤ë¸Œì íŠ¸ë“¤ì„ ê´€ë¦¬í•˜ê¸° ìœ„í•´ ì»¨íŠ¸ë¡¤ë¡œëŸ¬ë¼ëŠ” ê°œë…ì´ ìˆë‹¤ê³  í•©ë‹ˆë‹¤. ì—¬ê¸°ì— replicaset, deployment ë¼ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ìˆê³  ì´ë¥¼ ì´ìš©í•´ì„œ ì‰½ê²Œ scale ë³€ê²½ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
kubectl scale deployment hello --replicas=3
kubectl scale deployment hello --replicas=5
</pre>
<p>ê·¸ë¦¬ê³  Rolling Update ë„ ì§€ì›í•©ë‹ˆë‹¤(í•œë²ˆì— ì •í•´ì§„ ë‹¨ìœ„ë¡œë§Œ ì—…ë°ì´íŠ¸ë¥¼ í•´ì„œ ì „ì²´ë¥¼ ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤.)<br />
ë‹¤ìŒê³¼ ê°™ì´ edit deployment ë¥¼ ì´ìš©í•˜ì—¬ container ì´ë¯¸ì§€ë¥¼ ìˆ˜ì •í•˜ê²Œ ë˜ë©´ ìë™ìœ¼ë¡œ Rolling updateê°€ ì‹œì‘í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
kubectl edit deployment hello
</pre>
<p>Rolling updateë¥¼ ë©ˆì¶”ê±°ë‚˜ ë©ˆì¶˜ ì—…ë°ì´íŠ¸ë¥¼ ì¬ê°œí•˜ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒ ëª…ë ¹ì„ ì´ìš©í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
kubectl rollout pause deployment/hello
kubectl rollout resume deployment/hello
</pre>
<p>ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ê²ƒì€, ì—…ë°ì´íŠ¸ ì´í›„ì— ì´ì „ ë²„ì „ìœ¼ë¡œ ëŒë¦¬ê³  ì‹¶ë‹¤ë©´&#8230; rollout undoë¥¼ ì´ìš©í•´ì„œ ì´ì „ ë²„ì „ìœ¼ë¡œ ì‰½ê²Œ ëŒë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒë„ Rolling updateë¡œ ì§„í–‰ë©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
kubectl rollout undo deployment/hello
</pre>
<p><strong>Reference</strong><br />
1. <a href="https://zzsza.github.io/development/2018/04/17/docker-kubernetes/">https://zzsza.github.io/development/2018/04/17/docker-kubernetes/</a><br />
2. <a href="https://kubernetes.io/ko/docs/concepts/overview/working-with-objects/kubernetes-objects/">https://kubernetes.io/ko/docs/concepts/overview/working-with-objects/kubernetes-objects/</a><br />
3. <a href="http://bcho.tistory.com/1256">http://bcho.tistory.com/1256</a><br />
4. <a href="https://blog.2dal.com/2017/03/07/kubernetes/">https://blog.2dal.com/2017/03/07/kubernetes/</a></p>
]]></content:encoded>
							<wfw:commentRss>https://charsyam.wordpress.com/2019/01/20/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-2/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
						
		<media:content url="https://2.gravatar.com/avatar/eb957612b8f29b31a16f21df385691ed?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">charsyam</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2019/01/pods_1.jpg" medium="image">
			<media:title type="html">pods_1</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2019/01/service_1.jpg" medium="image">
			<media:title type="html">service_1</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.53.png" medium="image">
			<media:title type="html">á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2019-01-20 á„‹á…©á„’á…® 8.00.53</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2019/01/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º-2019-01-20-á„‹á…©á„’á…®-8.00.40.png" medium="image">
			<media:title type="html">á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2019-01-20 á„‹á…©á„’á…® 8.00.40</media:title>
		</media:content>
	</item>
		<item>
		<title>[êµ¬ê¸€ìŠ¤í„°ë””ì¼] Kubernetes in the Google Cloud #1</title>
		<link>https://charsyam.wordpress.com/2019/01/13/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-1/</link>
				<comments>https://charsyam.wordpress.com/2019/01/13/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-1/#respond</comments>
				<pubDate>Sun, 13 Jan 2019 06:49:29 +0000</pubDate>
		<dc:creator><![CDATA[charsyam]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://charsyam.wordpress.com/?p=2756</guid>
				<description><![CDATA[í•´ë‹¹ ê¸€ì€ í˜„ì¬ í•˜ê³  ìˆëŠ” êµ¬ê¸€ ìŠ¤í„°ë””ì¼ Kubernetes in the Google Cloud ì„ í•™ìŠµí•˜ëŠ” ê³¼ì •ì—ì„œ ë°°ìš°ëŠ” ê²ƒì„ ì •ë¦¬í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤. ì´ 10ê°œì˜ ì±•í„°ê°€ ìˆê³  ì¼ë‹¨ì€ ê°€ì¥ ì²˜ìŒ ë‘ ê°œì¸, Introduction to Docker, Hello Node Kubernetes ë¥¼ ê³µë¶€í–ˆëŠ”ë°&#8230; 1] Introduction to docker -&#62; ì‹¤ì œë¡œ Docker ì±…ì„ ë³´ë©´ ì‰½ê²Œ ë³´ê²Œë˜ëŠ” ëª…ë ¹ë“¤ì„ ì†Œê°œí•´ì¤ë‹ˆë‹¤. ì¦‰ docker ë¥¼ ì‹¤í–‰ì‹œí‚¤ê±°ë‚˜, í˜„ì¬ ìˆ˜í–‰ì¤‘ì¸ [&#8230;]]]></description>
								<content:encoded><![CDATA[<p>í•´ë‹¹ ê¸€ì€ í˜„ì¬ í•˜ê³  ìˆëŠ” êµ¬ê¸€ ìŠ¤í„°ë””ì¼ Kubernetes in the Google Cloud ì„ í•™ìŠµí•˜ëŠ” ê³¼ì •ì—ì„œ ë°°ìš°ëŠ” ê²ƒì„ ì •ë¦¬í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤.</p>
<p>ì´ 10ê°œì˜ ì±•í„°ê°€ ìˆê³  ì¼ë‹¨ì€ ê°€ì¥ ì²˜ìŒ ë‘ ê°œì¸, Introduction to Docker, Hello Node Kubernetes ë¥¼ ê³µë¶€í–ˆëŠ”ë°&#8230;</p>
<p>1] Introduction to docker<br />
 -&gt; ì‹¤ì œë¡œ Docker ì±…ì„ ë³´ë©´ ì‰½ê²Œ ë³´ê²Œë˜ëŠ” ëª…ë ¹ë“¤ì„ ì†Œê°œí•´ì¤ë‹ˆë‹¤. ì¦‰ docker ë¥¼ ì‹¤í–‰ì‹œí‚¤ê±°ë‚˜, í˜„ì¬ ìˆ˜í–‰ì¤‘ì¸ container ì— ì ‘ì†í•œë‹¤ê±°ë‚˜, í˜„ì¬ì˜ ìˆ˜ì •ë³¸ì„ docker hub ë“±ì˜ ì™¸ë¶€ registryì— ë“±ë¡í•˜ëŠ” ë°©ë²•(ì‚¬ì‹¤ ì—¬ê¸°ì„œëŠ” gcloud ë¥¼ ì´ìš©í•´ì„œ gcpë‚´ì˜ registryì— ë“±ë¡í•˜ë”êµ°ìš”.)</p>
<p>/node-app:0.2</p>
<p>ì‚¬ì‹¤ ì´ë¯¸ docker ë¥¼ ì‚¬ìš©í•´ ë³´ì‹  ê²½í—˜ì´ ìˆë‹¤ë©´, íŠ¹ë³„í•œ ì°¨ì´ë¥¼ ëŠë¼ì§€ ëª»í•˜ì‹¤êº¼ ê°™ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì°¨ì´ëŠ” ì‹¤ìŠµì„ í•˜ê²Œ ë˜ëŠ” í™˜ê²½ì—ì„œ ì´ë¯¸ docker/kubenetes ë“±ì´ ë‹¤ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì„œ&#8230; ì•„ì£¼ í¸í•˜ê²Œ ì‹¤ìŠµì„ í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒ ì •ë„&#8230; ì¼ë‹¨ ì œëª©ì´ Kubernetes in the Google Cloud ì¸ê±° ì²˜ëŸ¼ kubenetes ë‚´ìš©ì€ 2ì¥ ë¶€í„° ì‹œì‘ë©ë‹ˆë‹¤.</p>
<p>2] Hello Node Kubernetes</p>
<p>Kubernetes ëŠ” Container Orchestration Tool ì´ë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.(ì¦‰ ì»¨í…Œì´ë„ˆë¥¼ ê´€ë¦¬í•´ì£¼ëŠ”?) ì—¬ê¸°ì„œëŠ” ê°„ë‹¨íˆ kubenetes ìœ„ì—ì„œ node applicationì„ ë°°í¬í•˜ê³  Rolling update í•˜ëŠ” ê²ƒì„ ë³´ì—¬ì£¼ê²Œ ë©ë‹ˆë‹¤.</p>
<p>2-1] Cluster ì˜ ìƒì„±<br />
 ë‹¤ìŒê³¼ ê°™ì€ ê³¼ì •ì„ í†µí•´ì„œ í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•˜ê²Œ ë©ë‹ˆë‹¤. í´ëŸ¬ìŠ¤í„°ê°€ ìƒì„±ëœë‹¤ê³  ì´ë¯¸ì§€ê°€ ëŒê³  ìˆê±°ë‚˜ ê·¸ëŸ¬ì§€ëŠ” ì•Šê³ , í´ëŸ¬ìŠ¤í„°ë§Œ ì‹¤í–‰ëœë‹¤ê³  ìƒê°í•˜ë©´ ë©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
#project ì´ë¦„ ì„¤ì •
gcloud config set project PROJECT_ID

#hello-world ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ cluster ìƒì„±, ë…¸ë“œëŠ” 2ê°œ, ë¨¸ì‹  íƒ€ì…ì€ n1-standard-1, ìƒì„±ë˜ëŠ” ì¡´ì€ us-centrall-a ì…ë‹ˆë‹¤.
gcloud container clusters create hello-world \
                --num-nodes 2 \
                --machine-type n1-standard-1 \
                --zone us-central1-a


</pre>
<p>2-2] Pod ì˜ ìƒì„±<br />
 ìƒì„±ëœ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì´ì œ ì‹¤ì œë¡œ containerë¥¼ ì‹¤í–‰í•˜ê²Œ ë©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
#hello-node ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
kubectl run hello-node \
    --image=gcr.io/PROJECT_ID/hello-node:v1 \
    --port=8080

#kubectl get deployments ë¡œ í˜„ì¬ deployment ìƒí™©ì„ ë³¼ ìˆ˜ ìˆê³ 
kubectl get deployments

#kubectl get pods ë¡œ í˜„ì¬ ìˆ˜í–‰ì¤‘ì¸ podë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
kubectl get pods
</pre>
<p>2-3] container ì™¸ë¶€ì— ë…¸ì¶œí•˜ê¸°<br />
 ê°“ ë§Œë“¤ì–´ì§„ ì»¨í…Œì´ë„ˆë¥¼ ì™¸ë¶€ì— ì„œë¹„ìŠ¤í•˜ê¸° ìœ„í•´ì„œëŠ” ì™¸ë¶€ì—ì„œ ì ‘ì†ì„ í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì²˜ìŒ ìƒì„±ë˜ì—ˆì„ë•ŒëŠ” kubenetes ë‚´ë¶€ì—ì„œë§Œ ì—°ê²°ì´ ë˜ê³  ì™¸ë¶€ì—ì„œëŠ” ì ‘ì†ì´ ì•ˆë  ê²ƒì…ë‹ˆë‹¤. ì´ëŸ´ ë•Œ íŠ¹ì • podëŠ” ì™¸ë¶€ì—ì„œ ì ‘ì†í•  ìˆ˜ ìˆì–´ì•¼ í•˜ëŠ”ë°, ì´ëŸ¬ë©´ ì™¸ë¶€ IPë¥¼ ê°€ì§€ê±°ë‚˜ , ì™¸ë¶€ì—ì„œ í•´ë‹¹ podì— ì—°ê²°í•  ìˆ˜ ìˆëŠ” proxyê°€ ì‹¤í–‰ë˜ì–´ì•¼ í• ê»ë‹ˆë‹¤.(ì•„ë‹ˆë©´ ê¸°ì¡´ proxyì˜ ì„¤ì •ì´ ë°”ë€Œê±°ë‚˜&#8230;)</p>
<pre class="brush: bash; title: ; notranslate">
#ì™¸ë¶€ì— ë…¸ì¶œí•˜ê¸°
kubectl expose deployment hello-node --type="LoadBalancer"

#ì–´ë–¤ ì„œë¹„ìŠ¤ë“¤ì´ ìˆëŠ”ì§€ í™•ì¸
kubectl get services
#ê²°ê³¼ì˜ EXTERNAL-IPë¥¼ í†µí•´ì„œ ì™¸ë¶€ IPë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</pre>
<p>2-3] container scaling(ê°œìˆ˜ ë³€ê²½)<br />
 ìµœì´ˆì—ëŠ” container ê°€ í•˜ë‚˜ë§Œ ì‹¤í–‰ë˜ëŠ”ë°, ì´ ê°œìˆ˜ë¥¼ ë°”ê¾¸ê±°ë‚˜ í•˜ê³  ì‹¶ì„ë•Œ ì–´ë–»ê²Œ í•´ì•¼í•˜ëŠ”ì§€ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
#ì‹¤í–‰ë˜ëŠ” ì»¨í…Œì´ë„ˆì˜ ê°œìˆ˜ë¥¼ 4ê°œë¡œ ë°”ê¾¸ê¸°
kubectl scale deployment hello-node --replicas=4

#kubectl get deploymentë¥¼ í•˜ë©´ ì•„ê¹Œì™€ ë‹¤ë¥¸ ê²°ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
</pre>
<p>ë‹¤ë§Œ ì´ ê³¼ì •ê³¼ì •ê°€ ëˆˆê¹œì§í•  ì‚¬ì´ì— ëë‚˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. ì €ëŠ” ì‹¤í—˜ê²°ê³¼ ëª‡ì´ˆì—ì„œ ëª‡ë¶„ ì •ë„ ì§€ë‚˜ì•¼ ì´ì œ ì œëŒ€ë¡œ ì ìš©ë˜ëŠ” ê±¸ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì´ì œ ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ìƒíƒœëŠ” ë‹¤ìŒê³¼ ë¹„ìŠ·í•©ë‹ˆë‹¤.<br />
<img data-attachment-id="2757" data-permalink="https://charsyam.wordpress.com/2019/01/13/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-1/kube1/#main" data-orig-file="https://charsyam.files.wordpress.com/2019/01/kube1.png?w=776" data-orig-size="960,720" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="kube1" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2019/01/kube1.png?w=776?w=300" data-large-file="https://charsyam.files.wordpress.com/2019/01/kube1.png?w=776?w=776" src="https://charsyam.files.wordpress.com/2019/01/kube1.png?w=776" alt="kube1"   class="alignnone size-full wp-image-2757" srcset="https://charsyam.files.wordpress.com/2019/01/kube1.png?w=776 776w, https://charsyam.files.wordpress.com/2019/01/kube1.png?w=150 150w, https://charsyam.files.wordpress.com/2019/01/kube1.png?w=300 300w, https://charsyam.files.wordpress.com/2019/01/kube1.png?w=768 768w, https://charsyam.files.wordpress.com/2019/01/kube1.png 960w" sizes="(max-width: 776px) 100vw, 776px" /></p>
<p>ì‹¤ì œë¡œ ë‹¤ìŒì— í•´ë³´ë©´ ì¢‹ì„ê²ƒ ê°™ì€ ë¶€ë¶„&#8230;<br />
 scale ì€ ì‹¤ì œë¡œ ì„œë¹„ìŠ¤ë¥¼ í•  ë•Œ, ì¤‘ìš”í•œ ë¶€ë¶„ì´ë¯€ë¡œ, ìì‹ ë“¤ì˜ ì„œë¹„ìŠ¤ë¥¼ ë„£ê³ , ë¡¤ë§ ì—…ë°ì´íŠ¸ë‚˜ scaleì„ ë°”ê¿€ë•Œ, ì‹¤ì œë¡œ ì˜í–¥ì´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ë¥¼ í™•ì¸í•˜ì‹œëŠ”ê²Œ ì¢‹ì„ë“¯ í•©ë‹ˆë‹¤.</p>
]]></content:encoded>
							<wfw:commentRss>https://charsyam.wordpress.com/2019/01/13/%ea%b5%ac%ea%b8%80%ec%8a%a4%ed%84%b0%eb%94%94%ec%9e%bc-kubernetes-in-the-google-cloud-1/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
						
		<media:content url="https://2.gravatar.com/avatar/eb957612b8f29b31a16f21df385691ed?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">charsyam</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2019/01/kube1.png" medium="image">
			<media:title type="html">kube1</media:title>
		</media:content>
	</item>
		<item>
		<title>[ì… ê°œë°œ] EXT4 ì—ì„œ ë‹¬ë¼ì§„ ë¶€ë¶„ë“¤ #2 &#8211; ë°ì´í„° ì˜ì—­ì˜ ê´€ë¦¬</title>
		<link>https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/</link>
				<comments>https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/#respond</comments>
				<pubDate>Fri, 21 Dec 2018 17:10:14 +0000</pubDate>
		<dc:creator><![CDATA[charsyam]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://charsyam.wordpress.com/?p=2744</guid>
				<description><![CDATA[EXT4ê°€ ë“¤ì–´ì˜¤ë©´ì„œ í¬ê²Œ ë‹¬ë¼ì§„ ë¶€ë¶„ ê·¸ ë‘ ë²ˆì§¸ëŠ”, ë°ì´í„° ì˜ì—­ì„ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì¼ë‹¨ ê¸°ì¡´ì—ì„œ ì‚¬ìš©í•˜ë˜ ë°©ì‹ì„ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. íŒŒì¼ì‹œìŠ¤í…œì˜ íŠ¹ì„±ì„ ë³¼ë•ŒëŠ”, ê·¸ ì‹œê¸°ì— ìˆë˜ ê¸°ìˆ ì˜ í•œê³„ë¥¼ ì•Œë©´ ë„ì›€ì´ ë˜ëŠ”ë°, ìµœì´ˆì— extê°€ ë‚˜ì˜¤ë˜ ì‹œê¸°ëŠ” ê·¸ë ‡ê²Œ í° íŒŒì¼ì´ ë§ì§€ëŠ” ì•Šë˜ ì‹œê¸°ì…ë‹ˆë‹¤. ì¦‰ ì—„ì²­ í° íŒŒì¼ì„ ì²˜ë¦¬í•  ì¼ì´ ë§ì§€ëŠ” ì•Šë˜ ì‹œê¸°ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  ê¸°ë³¸ì ìœ¼ë¡œ ext2~3 ê¹Œì§€ëŠ” í•˜ë‚˜ì˜ íŒŒì¼ì˜ ìµœëŒ€ [&#8230;]]]></description>
								<content:encoded><![CDATA[<p>EXT4ê°€ ë“¤ì–´ì˜¤ë©´ì„œ í¬ê²Œ ë‹¬ë¼ì§„ ë¶€ë¶„ ê·¸ ë‘ ë²ˆì§¸ëŠ”, ë°ì´í„° ì˜ì—­ì„ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì¼ë‹¨ ê¸°ì¡´ì—ì„œ ì‚¬ìš©í•˜ë˜ ë°©ì‹ì„ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. íŒŒì¼ì‹œìŠ¤í…œì˜ íŠ¹ì„±ì„ ë³¼ë•ŒëŠ”, ê·¸ ì‹œê¸°ì— ìˆë˜ ê¸°ìˆ ì˜ í•œê³„ë¥¼ ì•Œë©´ ë„ì›€ì´ ë˜ëŠ”ë°, ìµœì´ˆì— extê°€ ë‚˜ì˜¤ë˜ ì‹œê¸°ëŠ” ê·¸ë ‡ê²Œ í° íŒŒì¼ì´ ë§ì§€ëŠ” ì•Šë˜ ì‹œê¸°ì…ë‹ˆë‹¤. ì¦‰ ì—„ì²­ í° íŒŒì¼ì„ ì²˜ë¦¬í•  ì¼ì´ ë§ì§€ëŠ” ì•Šë˜ ì‹œê¸°ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  ê¸°ë³¸ì ìœ¼ë¡œ ext2~3 ê¹Œì§€ëŠ” í•˜ë‚˜ì˜ íŒŒì¼ì˜ ìµœëŒ€ í¬ê¸°ëŠ” 4 bytes ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ìµœëŒ€ 4ê¸°ê°€ í•œê³„ì…ë‹ˆë‹¤.(ë¸”ëŸ­ì˜ í¬ê¸°ì™€ ìƒê´€ì—†ì´ ì¼ë‹¨ ìµœëŒ€í•œ ê°€ì¡Œì„ ë•Œ í‘œí˜„í•  ìˆ˜ ìˆëŠ” í•œê³„ê°€ 4ê¸°ê°€ì…ë‹ˆë‹¤. íŒŒì¼ í¬ê¸°ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë³€ìˆ˜ê°€ 4 bytes ì´ê¸° ë•Œë¬¸ì´ì£ .)</p>
<p>ì—¬ê¸°ì„œ ë³´í†µ íŒŒì¼ì˜ ì¢…ë¥˜ì— ë”°ë¼ì„œ File/Directory ì—ì„œ Fileì´ë©´, ì‹¤ì œ ë°ì´í„° ì˜ì—­ì— íŒŒì¼ì˜ ë‚´ìš©ì´ ìˆê³ , ë””ë ‰í† ë¦¬ë©´, í•´ë‹¹ ë””ë ‰í† ë¦¬ì— ìˆëŠ” íŒŒì¼ ëª©ë¡ì— ëŒ€í•œ ì •ë³´ê°€ ë°ì´í„° ì˜ì—­ì— ê´€ë¦¬ê°€ ë˜ê²Œ ë©ë‹ˆë‹¤. ì¦‰, &#8220;I am a boy&#8221; ë¼ëŠ” ë‚´ìš©ì„ ê°€ì§„ íŒŒì¼ì´ ìˆë‹¤ë©´, ê·¸ íŒŒì¼ì˜ í¬ê¸°ëŠ” 10ì´ê³ , block í¬ê¸°ê°€ 4kë¼ë©´, í•œ ê°œì˜ blockë§Œ í• ë‹¹ì´ ë˜ì–´ìˆì„ê²ƒì…ë‹ˆë‹¤. ê·¸ë˜ì„œ ë°ì´í„° ì˜ì—­ì— ê°€ë©´ ì²˜ìŒ 10ë°”ì´íŠ¸ê°€ &#8220;I am a boy&#8221;ê°€ ë“¤ì–´ìˆê²Œ ë©ë‹ˆë‹¤. ì´ê±¸ ê´€ë¦¬í•˜ëŠ” ì •ë³´ëŠ” EXTëŠ” inodeì— ìˆê³ , ext2~3ì—ì„œëŠ” ê·¸ í¬ê¸°ëŠ” ì´ 60ë°”ì´íŠ¸ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  ë¸”ëŸ­ì„ ê°€ë¦¬í‚¤ëŠ” ì •ë³´ëŠ” í•˜ë‚˜ê°€ 4 bytes ì…ë‹ˆë‹¤. ì¦‰, 60ë°”ì´íŠ¸ì˜ ê³µê°„ì´ í• ë‹¹ë˜ì–´ ìˆëŠ”ë°, í•œ ì¹¸ì´ 4 bytes ë©´ ì´ 15ê°œì˜ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ê³µê°„ì´ ë“¤ì–´ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.(FAT32 ë¥¼ ì•ˆë‹¤ë©´ Fat Table ì„ ìƒê°í•˜ì‹œë©´ ì‰½ìŠµë‹ˆë‹¤.)</p>
<p><a href="https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/inode1/#main" rel="attachment wp-att-2747"><img data-attachment-id="2747" data-permalink="https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/inode1/#main" data-orig-file="https://charsyam.files.wordpress.com/2018/12/inode1.png" data-orig-size="1227,997" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="inode1" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2018/12/inode1.png?w=300" data-large-file="https://charsyam.files.wordpress.com/2018/12/inode1.png?w=776&#038;h=631" src="https://charsyam.files.wordpress.com/2018/12/inode1.png?w=776&#038;h=631" alt="ê·¸ë¦¼1" width="776" height="631" class="aligncenter size-large wp-image-2747" srcset="https://charsyam.files.wordpress.com/2018/12/inode1.png?w=776&amp;h=631 776w, https://charsyam.files.wordpress.com/2018/12/inode1.png?w=150&amp;h=122 150w, https://charsyam.files.wordpress.com/2018/12/inode1.png?w=300&amp;h=244 300w, https://charsyam.files.wordpress.com/2018/12/inode1.png?w=768&amp;h=624 768w, https://charsyam.files.wordpress.com/2018/12/inode1.png?w=1024&amp;h=832 1024w, https://charsyam.files.wordpress.com/2018/12/inode1.png 1227w" sizes="(max-width: 776px) 100vw, 776px" /></a></p>
<p>ê·¸ëŸ°ë° ì—¬ê¸°ì„œ ì˜ ìƒê°í•´ë³´ë©´, ê·¸ë¦¼1 ì²˜ëŸ¼ í•œì¹¸ì´ 4 bytesë¼ í•˜ë‚˜ì˜ ë¸”ëŸ­ì„ ê°€ë¦¬í‚¤ë©´&#8230; 60ë°”ì´íŠ¸ë¡œëŠ” ì´ 15ê°œ&#8230; í•œ ì¹¸ì´ í•˜ë‚˜ì˜ ë¸”ëŸ­ì„ ê°€ë¦¬í‚¤ë¯€ë¡œ, block í¬ê¸°ê°€ 4kë©´ 4k * 15 = 60k ë°–ì— ì•ˆë©ë‹ˆë‹¤.(ì•„ê¹ŒëŠ” 4ê¸°ê°€ê°€ ìµœê³ ë¼ë©°!!!) ì–´ë–»ê²Œ ëœ ê²ƒì¼ê¹Œìš”? ì‚¬ì‹¤ EXT2/3ì˜ íŠ¹ì§• ì¤‘ì— í•˜ë‚˜ê°€ direct, indirect block, double indirect block, triple indirect block ìœ¼ë¡œ êµ¬ì„±ì´ ëœë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>
<p>ë¨¼ì € ì‹œì‘í•˜ê¸° ì „ì— inodeì— ë“¤ì–´ìˆëŠ” 15 ê°œì˜ ì¹¸ì€&#8230; 12ê°œì˜ directì™€ ê°ê° í•˜ë‚˜ì”©ì˜ indirect, double indirect, triple indirect ë¡œ êµ¬ì„±ì´ ë˜ì–´ìˆìŠµë‹ˆë‹¤. ë¨¼ì € direct ëŠ” ê·¸ ì¹¸ í•˜ë‚˜ê°€ ê·¸ë¦¼2ì²˜ëŸ¼ ì‹¤ì œ ë””ìŠ¤í¬ì˜ ë¸”ëŸ­í•˜ë‚˜ë¥¼ ê°€ë¦¬í‚¤ëŠ” ê²ƒì…ë‹ˆë‹¤. direct ë¡œëŠ” ìµœëŒ€ 60k ë°–ì— íŒŒì¼ì´ ê°€ì§ˆ ìˆ˜ê°€ ì—†ìœ¼ë¯€ë¡œ, ì´ ì‚¬ì´ì¦ˆë¥¼ ë” í¬ê²Œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ê²ƒë“¤ì´ ìœ„í•œ indirect, double indirect, triple indirect ë°©ì‹ì…ë‹ˆë‹¤.</p>
<p><a href="https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/ext_direct/#main" rel="attachment wp-att-2751"><img data-attachment-id="2751" data-permalink="https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/ext_direct/#main" data-orig-file="https://charsyam.files.wordpress.com/2018/12/ext_direct.png" data-orig-size="1432,1168" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ext_direct" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2018/12/ext_direct.png?w=300" data-large-file="https://charsyam.files.wordpress.com/2018/12/ext_direct.png?w=776&#038;h=633" src="https://charsyam.files.wordpress.com/2018/12/ext_direct.png?w=776&#038;h=633" alt="ê·¸ë¦¼2" width="776" height="633" class="aligncenter size-large wp-image-2751" srcset="https://charsyam.files.wordpress.com/2018/12/ext_direct.png?w=776&amp;h=633 776w, https://charsyam.files.wordpress.com/2018/12/ext_direct.png?w=150&amp;h=122 150w, https://charsyam.files.wordpress.com/2018/12/ext_direct.png?w=300&amp;h=245 300w, https://charsyam.files.wordpress.com/2018/12/ext_direct.png?w=768&amp;h=626 768w, https://charsyam.files.wordpress.com/2018/12/ext_direct.png?w=1024&amp;h=835 1024w, https://charsyam.files.wordpress.com/2018/12/ext_direct.png 1432w" sizes="(max-width: 776px) 100vw, 776px" /></a></p>
<p>12ê°œë‹ˆ ê° ë¸”ëŸ­ì´ 4kë©´ 48kì˜ ê³µê°„ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ 13ë²ˆì§¸ ì¹¸ì˜ indirect ëŠ” ë­ëƒ, indirect ê°€ ê°€ë¦¬í‚¤ëŠ” ë¸”ëŸ­ìœ¼ë¡œ ê°€ë©´, ì•„ê¹Œ 12ê°œì˜ direct blockì„ ê°€ë¦¬í‚¤ëŠ” ì •ë³´ê°€ ìˆë˜ ê²ƒê³¼ ê°™ì€ í˜•íƒœë¡œ ì‹¤ì œ ë””ìŠ¤í¬ë¥¼ ê°€ë¦¬í‚¤ëŠ” ë¸”ëŸ­ì´ direct blockì´ ë‚˜ì˜µë‹ˆë‹¤. ë¸”ëŸ­ í¬ê¸°ê°€ 4kë©´ ì—¬ê¸°ì— ì‹¤ì œ ë””ìŠ¤í¬ì˜ ë¸”ëŸ­ì„ ê°€ë¦¬í‚¬ ìˆ˜ ìˆëŠ” ì •ë³´ê°€ ê°ê° 4 byteë‹ˆ 1024ê°œê°€ ë“¤ì–´ê°€ê²Œ ë©ë‹ˆë‹¤. ì¦‰, indirect blockì€ ì‹¤ì œë¡œ direct ë¸”ëŸ­ 1024ê°œë¥¼ ê°€ë¦¬í‚¤ë¯€ë¡œ 4Mì˜ ê³µê°„ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¼3ì„ ì°¸ê³ í•©ì‹œë‹¤.</p>
<p><a href="https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/ext_indirect/#main" rel="attachment wp-att-2749"><img data-attachment-id="2749" data-permalink="https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/ext_indirect/#main" data-orig-file="https://charsyam.files.wordpress.com/2018/12/ext_indirect.png" data-orig-size="1644,1096" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ext_indirect" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2018/12/ext_indirect.png?w=300" data-large-file="https://charsyam.files.wordpress.com/2018/12/ext_indirect.png?w=776&#038;h=517" src="https://charsyam.files.wordpress.com/2018/12/ext_indirect.png?w=776&#038;h=517" alt="ê·¸ë¦¼3" width="776" height="517" class="aligncenter size-large wp-image-2749" srcset="https://charsyam.files.wordpress.com/2018/12/ext_indirect.png?w=776&amp;h=517 776w, https://charsyam.files.wordpress.com/2018/12/ext_indirect.png?w=1552&amp;h=1034 1552w, https://charsyam.files.wordpress.com/2018/12/ext_indirect.png?w=150&amp;h=100 150w, https://charsyam.files.wordpress.com/2018/12/ext_indirect.png?w=300&amp;h=200 300w, https://charsyam.files.wordpress.com/2018/12/ext_indirect.png?w=768&amp;h=512 768w, https://charsyam.files.wordpress.com/2018/12/ext_indirect.png?w=1024&amp;h=683 1024w" sizes="(max-width: 776px) 100vw, 776px" /></a></p>
<p>ê·¸ëŸ¼ ì´ì œ ìŠ¬ìŠ¬ ì´í•´ê°€ ê°€ê¸° ì‹œì‘í•  ê²ƒì…ë‹ˆë‹¤. indirect ë¸”ëŸ­ì€ í•´ë‹¹ ë¸”ëŸ­ì´ direct blockì„ ì–´ë“œë ˆì‹± í•˜ëŠ” ì£¼ì†Œ ì •ë³´ê°€ ë“¤ì–´ê°€ ìˆê³ , double indirect ë¸”ëŸ­ì´ ê°€ë¦¬í‚¤ëŠ” ì •ë³´ëŠ” indirect ë¸”ëŸ­ì„ ê°€ë¦¬í‚¤ëŠ” ë¸”ëŸ­ 1024ê°œë¥¼ ê°€ë¦¬í‚¤ëŠ” ë¸”ëŸ­ì— ëŒ€í•œ ì •ë³´ê°€ ë©ë‹ˆë‹¤. ê·¸ë¦¼4ë¥¼ ì°¸ê³ í•˜ë©´, ì‹¤ì œë¡œ double indirect ë¸”ëŸ­ì˜ ë‚´ìš©ì€ indirect block ì •ë³´ë“¤ì…ë‹ˆë‹¤.</p>
<p><a href="https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/ext_double/#main" rel="attachment wp-att-2750"><img data-attachment-id="2750" data-permalink="https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/ext_double/#main" data-orig-file="https://charsyam.files.wordpress.com/2018/12/ext_double.png" data-orig-size="1710,1090" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ext_double" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2018/12/ext_double.png?w=300" data-large-file="https://charsyam.files.wordpress.com/2018/12/ext_double.png?w=776&#038;h=495" src="https://charsyam.files.wordpress.com/2018/12/ext_double.png?w=776&#038;h=495" alt="ê·¸ë¦¼4" width="776" height="495" class="aligncenter size-large wp-image-2750" srcset="https://charsyam.files.wordpress.com/2018/12/ext_double.png?w=776&amp;h=495 776w, https://charsyam.files.wordpress.com/2018/12/ext_double.png?w=1552&amp;h=990 1552w, https://charsyam.files.wordpress.com/2018/12/ext_double.png?w=150&amp;h=96 150w, https://charsyam.files.wordpress.com/2018/12/ext_double.png?w=300&amp;h=191 300w, https://charsyam.files.wordpress.com/2018/12/ext_double.png?w=768&amp;h=490 768w, https://charsyam.files.wordpress.com/2018/12/ext_double.png?w=1024&amp;h=653 1024w" sizes="(max-width: 776px) 100vw, 776px" /></a></p>
<p>ì—¬ê¸°ì„œëŠ” 4M ì§œë¦¬ 1024ê°œë¥¼ ê°€ë¦¬í‚¤ë¯€ë¡œ 4G ì˜ ë””ìŠ¤í¬ ì •ë³´ë¥¼ ê°€ë¦¬í‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì¯¤ë˜ë©´ ì´ì œ triple indirect ì˜ ì„±ê²©ë„ ëˆˆì¹˜ ì±„ì‹¤ ê»ë‹ˆë‹¤.<br />
triple indirect blockì´ ê°€ë¦¬í‚¤ëŠ” ì •ë³´ëŠ” double indirect block 1024ê°œë¥¼ ê°€ë¦¬í‚¤ëŠ” ì •ë³´ì…ë‹ˆë‹¤. ê·¸ë¦¼5ë¥¼ ì°¸ê³ í•˜ë©´ ë©ë‹ˆë‹¤. ê·¸ëŸ°ë° ì—¬ê¸°ì„œ<br />
ì˜ì•„í•œ ê²ƒì€ ì‚¬ì‹¤ double indirect block ë§Œìœ¼ë¡œë„&#8230; ì‹¤ì œ íŒŒì¼ì˜ ìµœëŒ€ í¬ê¸°ì¸ 4Gê°€ ë„˜ì–´ê°„ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.(ë¬¼ë¡  ë¸”ëŸ­ í¬ê¸°ê°€ 4K ì¼ ê²½ìš°ì…ë‹ˆë‹¤. 1Kë¡œ ì„¤ì •ë˜ë©´ ì´ ë§ˆì§€ë§‰ ë¸”ëŸ­ì„ ì‚¬ìš©í•˜ê²Œ ë˜ê² ì§€ë§Œ&#8230; ë¸”ëŸ­ í¬ê¸°ê°€ 4kë©´&#8230; ë§ˆì§€ë§‰ triple indirect ëŠ” ì‚¬ìš©í•  ì´ìœ ê°€ ì—†ìŠµë‹ˆë‹¤.)</p>
<p>ë¸”ëŸ­ í¬ê¸°ê°€ 4k ì¼ë•Œ, triple indirect blockì€ 4G * 1024 = 4TB ì˜ ë°ì´í„° ì˜ì—­ì„ ê°€ë¦¬í‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¼5ë¥¼ ì°¸ê³ í•©ì‹œë‹¤.</p>
<p><a href="https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/ext_triple/#main" rel="attachment wp-att-2748"><img data-attachment-id="2748" data-permalink="https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/ext_triple/#main" data-orig-file="https://charsyam.files.wordpress.com/2018/12/ext_triple.png" data-orig-size="1762,1260" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ext_triple" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2018/12/ext_triple.png?w=300" data-large-file="https://charsyam.files.wordpress.com/2018/12/ext_triple.png?w=776&#038;h=555" src="https://charsyam.files.wordpress.com/2018/12/ext_triple.png?w=776&#038;h=555" alt="ê·¸ë¦¼5" width="776" height="555" class="aligncenter size-large wp-image-2748" srcset="https://charsyam.files.wordpress.com/2018/12/ext_triple.png?w=776&amp;h=555 776w, https://charsyam.files.wordpress.com/2018/12/ext_triple.png?w=1552&amp;h=1110 1552w, https://charsyam.files.wordpress.com/2018/12/ext_triple.png?w=150&amp;h=107 150w, https://charsyam.files.wordpress.com/2018/12/ext_triple.png?w=300&amp;h=215 300w, https://charsyam.files.wordpress.com/2018/12/ext_triple.png?w=768&amp;h=549 768w, https://charsyam.files.wordpress.com/2018/12/ext_triple.png?w=1024&amp;h=732 1024w" sizes="(max-width: 776px) 100vw, 776px" /></a></p>
<p>ê·¸ëŸ°ë° ext4ë¡œ ê°€ë©´ì„œ ì™œ ì´ëŸ° êµ¬ì¡°ë¥¼ ë²„ë¦¬ëŠ” ê²ƒì¼ê¹Œìš”? ê°„ë‹¨í•˜ê²Œ ìƒê°í•´ë³´ë©´ í•´ë‹¹ êµ¬ì¡°ëŠ” ë‚­ë¹„ê°€ ë„ˆë¬´ ì‹¬í•©ë‹ˆë‹¤. í˜¹ì‹œë‚˜ FAT32ì—ì„œ NTFSë¡œ ê°€ë©´ì„œ ë‚´ë¶€êµ¬ì¡°ê°€ ì–´ë–»ê²Œ ë°”ë€Œì—ˆëŠ”ì§€ ì´í•´í•œë‹¤ë©´, ì‹¤ì œë¡œ EXT4ì˜ extendë¥¼ ì´í•´í•˜ëŠ” ê²ƒì€ êµ‰ì¥íˆ ìˆ˜ì›”í•©ë‹ˆë‹¤.</p>
<p>ë¨¼ì € ê°„ë‹¨í•˜ê²Œ ìƒê°í•´ë´…ì‹œë‹¤. 1000, 1001, 1002, 1003 4ê°œì˜ ë¸”ëŸ­ì´ ìˆë‹¤ê³  í•  ë•Œ ì´ê±¸ ê°€ë¦¬í‚¤ëŠ” ë°©ë²•ìœ¼ë¡œ ext2ì—ì„œì˜ ê¸°ì¡´ ë°©ì‹ì€ í•˜ë‚˜ì— í•œì¹¸ì„ ê°€ë¦¬ì¼œì•¼ í•˜ë¯€ë¡œ ì´ 4ì¹¸ 16 ë°”ì´íŠ¸ê°€ í•„ìš”í•©ë‹ˆë‹¤. ê·¸ëŸ°ë° ì´ë ‡ê²Œ í‘œí˜„í•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œìš”? (ì‹œì‘ìœ„ì¹˜, ë¸”ëŸ­ ê°œìˆ˜), ì´ëŸ° í˜•íƒœë©´ ë‹¤ìŒê³¼ ê°™ì€ (1000, 4) í˜•íƒœë¡œ, í‘œí˜„ì´ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤. ë°ì´í„° ê³µê°„ë„ ê°ê° 4 ë°”ì´íŠ¸ë¥¼ ì“´ë‹¤ê³  í•˜ë”ë¼ë„ 8ë°”ì´íŠ¸ë©´ ì¤„ì–´ë“­ë‹ˆë‹¤. ë¬¼ë¡  ë§¤ë²ˆ í•„ìš”í•œ ê³µê°„ì´ Fragmentation ì´ ë°œìƒí•œë‹¤ë©´ (1000, 1), (1001, 1), (1002, 1), (1003, 1) í˜•íƒœë¡œ ê³µê°„ì„ ë‚­ë¹„í•˜ê²Œ ë©ë‹ˆë‹¤. ì¦‰ ì—°ì†ëœ ê³µê°„ì´ ë§ì´ í•„ìš”í•  ìˆ˜ë¡, ìƒˆë¡œìš´ í‘œí˜„ ë°©ë²•ì´ ê³µê°„ì„ ì ˆì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì¶”ê°€ ë¶„ì„í•  í•„ìš” ì—†ì´ë„ ì‰½ê²Œ ë’¤ì— ì–¼ë§ˆë§Œí¼ ì½ì–´ì•¼ í• ì§€ë„ ì•Œ ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.</p>
<p>ì´ëŸ° ë°©ì‹ì„ ì ìš©í•œê²ƒì´, ntfsì˜ cluster runs ë‚˜, ext4ì˜ extent ë¼ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤. ê·¸ëŸ°ë° extentëŠ” (ì‹œì‘ìœ„ì¹˜, ë¸”ëŸ­ ê°œìˆ˜) ì˜ êµ¬ì¡°ì—ì„œ ë¸”ë¡ ê°œìˆ˜ì—ëŠ” 2 byteë§Œ í• ë‹¹ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ block í¬ê¸°ê°€ 4k ê¸°ì¤€ì¼ ë•Œ ë¬´ì¡°ê±´ 32768 ì¦‰ 4k * 32768 = 128MB ì´ìƒë˜ë©´ ì•„ë¬´ë¦¬ ë””ìŠ¤í¬ì— ì—°ì†ì ìœ¼ë¡œ í• ë‹¹ëœ ê³µê°„ì´ ìˆë”ë¼ë„ extendê°€ ì¶”ê°€ë¡œ ìƒê¸°ê²Œ ë©ë‹ˆë‹¤. ì¦‰ 1GB íŒŒì¼ì´ë©´ 8ê°œëŠ” extentê°€ ìƒê²¨ì•¼ í•©ë‹ˆë‹¤.</p>
<p>ê·¸ëŸ°ë° extentêµ¬ì¡°ë¥¼ ë³´ë©´ í—¤ë”ê°€ ì¼ë‹¨ 12 ë°”ì´íŠ¸ì´ê³ , ë¦¬í”„ ë…¸ë“œ(ì‹¤ì œ íŒŒì¼ì˜ ì •ë³´ë¥¼ ê°€ë¦¬í‚¤ëŠ”)ëƒ, ì¸ë±ìŠ¤ ë…¸ë“œ(ë¦¬í”„ ë…¸ë“œë‚˜ ë‹¤ë¥¸ ì¸ë±ìŠ¤ ë…¸ë“œì˜ ì •ë³´ë¥¼ ê°€ì§€ëŠ”)ëƒì— ë”°ë¼ ê°€ì§€ëŠ” ì •ë³´ë“¤ì´ ê°ê° 12 bytesì…ë‹ˆë‹¤. ì¦‰&#8230; 60ë°”ì´íŠ¸ì—ì„œ í—¤ë”ë¥¼ ë¹¼ê³ ë‚˜ë©´ ì¼ë‹¨ inode ì•ˆì—ëŠ” 4ê°œì˜ ë¦¬í”„ ë…¸ë“œë§Œ ë“¤ì–´ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¦‰ 512MB ë³´ë‹¤ íŒŒì¼ ì‚¬ì´ì¦ˆê°€ ì»¤ì§€ê±°ë‚˜ fragmentation ì´ ë§ì´ ë‚˜ë©´&#8230; ê²°êµ­ tree í˜•íƒœë¡œ ê´€ë¦¬ë˜ëŠ” ì •ë³´ê°€ ì‹¤ì œ ë‹¤ë¥¸ ë¸”ëŸ­ì— ë“¤ì–´ê°€ì•¼ë§Œ í•©ë‹ˆë‹¤.</p>
<p><a href="https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/ext_extent/#main" rel="attachment wp-att-2752"><img data-attachment-id="2752" data-permalink="https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/ext_extent/#main" data-orig-file="https://charsyam.files.wordpress.com/2018/12/ext_extent.png?w=776" data-orig-size="513,353" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ext_extent" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2018/12/ext_extent.png?w=776?w=300" data-large-file="https://charsyam.files.wordpress.com/2018/12/ext_extent.png?w=776?w=513" src="https://charsyam.files.wordpress.com/2018/12/ext_extent.png?w=776" alt="ê·¸ë¦¼6"   class="aligncenter size-full wp-image-2752" srcset="https://charsyam.files.wordpress.com/2018/12/ext_extent.png 513w, https://charsyam.files.wordpress.com/2018/12/ext_extent.png?w=150 150w, https://charsyam.files.wordpress.com/2018/12/ext_extent.png?w=300 300w" sizes="(max-width: 513px) 100vw, 513px" /></a></p>
<p>ê·¸ë˜ì„œ ì‹¤ì œ êµ¬ì¡°ëŠ” ê·¸ë¦¼6ì²˜ëŸ¼ ë˜ê²Œ ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ extentë„ ì‹¤ì œë¡œëŠ” í•´ë‹¹ íŒŒì¼ì˜ inodeì˜ flagì— USE_EXTENT ê°€ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤. ì¦‰ ext4 ë‚´ì— ìˆëŠ” íŒŒì¼ì´ ì–´ë–¤ ê±´ extent í˜•íƒœë¡œ, ì–´ë–¤ê±´ ì˜›ë‚  ë°©ì‹ìœ¼ë¡œë„ ì£¼ì†Œ ì§€ì •ì´ ê°€ëŠ¥í•˜ë‹¤ë¼ëŠ” ê²ƒì…ë‹ˆë‹¤. ë‹¤ìŒë²ˆì—ëŠ” ê¸°ì¡´ì— ì™œ í•œ ë””ë ‰í† ë¦¬ì— íŒŒì¼ì´ ë§ìœ¼ë©´, íŒŒì¼ ì—´ê¸°ë“±ì´ ëŠë ¤ì§€ëŠ”ì§€, ext4ì—ì„œëŠ” ì–´ë–»ê²Œ í’€ê³  ìˆëŠ”ì§€ ê°€ë³ê²Œ ì‚´í´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>
]]></content:encoded>
							<wfw:commentRss>https://charsyam.wordpress.com/2018/12/21/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-2-%eb%8d%b0%ec%9d%b4%ed%84%b0-%ec%98%81%ec%97%ad%ec%9d%98-%ea%b4%80%eb%a6%ac/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
						
		<media:content url="https://2.gravatar.com/avatar/eb957612b8f29b31a16f21df385691ed?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">charsyam</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2018/12/inode1.png?w=776" medium="image">
			<media:title type="html">ê·¸ë¦¼1</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2018/12/ext_direct.png?w=776" medium="image">
			<media:title type="html">ê·¸ë¦¼2</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2018/12/ext_indirect.png?w=776" medium="image">
			<media:title type="html">ê·¸ë¦¼3</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2018/12/ext_double.png?w=776" medium="image">
			<media:title type="html">ê·¸ë¦¼4</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2018/12/ext_triple.png?w=776" medium="image">
			<media:title type="html">ê·¸ë¦¼5</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2018/12/ext_extent.png" medium="image">
			<media:title type="html">ê·¸ë¦¼6</media:title>
		</media:content>
	</item>
		<item>
		<title>[ì… ê°œë°œ] EXT4 ì—ì„œ ë‹¬ë¼ì§„ ë¶€ë¶„ë“¤ #1 &#8211; Flexible Block Group</title>
		<link>https://charsyam.wordpress.com/2018/12/15/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-1/</link>
				<comments>https://charsyam.wordpress.com/2018/12/15/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-1/#comments</comments>
				<pubDate>Sat, 15 Dec 2018 01:16:26 +0000</pubDate>
		<dc:creator><![CDATA[charsyam]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://charsyam.wordpress.com/?p=2738</guid>
				<description><![CDATA[ì‚¬ì‹¤ EXT4ëŠ” ë‚˜ì˜¨ì§€ êµ‰ì¥íˆ êµ‰ì¥íˆ ì˜¤ë˜ëœ íŒŒì¼ ì‹œìŠ¤í…œì…ë‹ˆë‹¤. EXTì˜ ì—­ì‚¬ë¥¼ ë³´ë©´ ê°„ëµíˆ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. EXT, 1992ë…„ ì¶œì‹œ EXT2, 1993ë…„ ì¶œì‹œ EXT3, 2001ë…„ ì»¤ë„ 2.4.15ì— í¬í•¨ EXT4, 2006ë…„ ì»¤ë„ 2.6.19ì— í¬í•¨ 2008ë…„ ì»¤ë„ 2.6.28ì— EXT4 ì•ˆì • ë²„ì „ í¬í•¨ í•œë§ˆë””ë¡œ êµ‰ì¥íˆ ì˜¤ë˜ë˜ì—ˆìŠµë‹ˆë‹¤. ê±°ì˜ 10ë…„ì´ ì§€ë‚¬ë„¤ìš”. ê·¸ëŸ°ë° ì•„ëŠ” ë¶„ë“¤ì€ ë‹¤ ì•„ì‹œì§€ë§Œ, ê·¸ë˜ë„ ëª¨ë¥´ëŠ” ì‚¬ëŒë“¤ì€ EXT2 -&#62; EXT3 -&#62; [&#8230;]]]></description>
								<content:encoded><![CDATA[<p>ì‚¬ì‹¤ EXT4ëŠ” ë‚˜ì˜¨ì§€ êµ‰ì¥íˆ êµ‰ì¥íˆ ì˜¤ë˜ëœ íŒŒì¼ ì‹œìŠ¤í…œì…ë‹ˆë‹¤. EXTì˜ ì—­ì‚¬ë¥¼ ë³´ë©´ ê°„ëµíˆ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<ul>
<li>EXT, 1992ë…„ ì¶œì‹œ</li>
<li>EXT2, 1993ë…„ ì¶œì‹œ</li>
<li>EXT3, 2001ë…„ ì»¤ë„ 2.4.15ì— í¬í•¨</li>
<li>EXT4, 2006ë…„ ì»¤ë„ 2.6.19ì— í¬í•¨</li>
<li>2008ë…„ ì»¤ë„ 2.6.28ì— EXT4 ì•ˆì • ë²„ì „ í¬í•¨</li>
</ul>
<p>í•œë§ˆë””ë¡œ êµ‰ì¥íˆ ì˜¤ë˜ë˜ì—ˆìŠµë‹ˆë‹¤. ê±°ì˜ 10ë…„ì´ ì§€ë‚¬ë„¤ìš”. ê·¸ëŸ°ë° ì•„ëŠ” ë¶„ë“¤ì€ ë‹¤ ì•„ì‹œì§€ë§Œ, ê·¸ë˜ë„ ëª¨ë¥´ëŠ” ì‚¬ëŒë“¤ì€<br />
EXT2 -&gt; EXT3 -&gt; EXT4ë¡œ ë„˜ì–´ê°€ë©´ì„œ ë¬´ì—‡ì´ ë³€í–ˆëŠ”ì§€ ì˜ ëª¨ë¦…ë‹ˆë‹¤. ê·¸ëƒ¥ ì¢‹ì•„ì¡Œë‹¤?</p>
<p>EXT4ë¡œ ë“¤ì–´ì˜¤ë©´ì„œ í¬ê²Œ ë°”ë€ê²ƒë“¤ì´ ì¢€ ìˆëŠ”ë°, ê·¸ ì¤‘ì—ì„œë„ Flexible Block Group, Extentë¥¼ ìœ„í•œ HTree,<br />
ë§ì€ ìˆ˜ì˜ íŒŒì¼ ëª©ë¡ì—ì„œ ì‰½ê²Œ íŒŒì¼ì„ ì°¾ê¸° ìœ„í•œ Hash Directories ë“±ì´ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì¼ë‹¨ ìƒê°ì€ í•´ë‹¹ EXT4 ì‹œë¦¬ì¦ˆì—ì„œëŠ” í¬ê²Œ ìœ„ì˜ ì„¸ ê°€ì§€ë§Œ ë‹¤ë¤„ë³¼ë ¤ê³  í•©ë‹ˆë‹¤. ìì„¸í•œ ê²ƒì€ ë‹¹ì—°íˆ ë‹¤ë£¨ì§€ ì•ŠìŠµë‹ˆë‹¤.<br />
ì™œëƒ&#8230; ì˜ëª¨ë¥´ë‹ˆê¹&#8230;</p>
<p>Flexible Block Group ì„ ì„¤ëª…í•˜ê¸° ìœ„í•´ì„œëŠ” ë¨¼ì € EXTì—ì„œ Disk Layout ì„ ì–´ë–»ê²Œ êµ¬ì„±í•˜ëŠ”ê°€ ë¶€í„° ì•Œì•„ì•¼<br />
í•©ë‹ˆë‹¤. EXTì—ì„œëŠ” Block Group ì´ë¼ê³  í•´ì„œ íŠ¹ì • ì‚¬ì´ì¦ˆ ë‹¨ìœ„ë¡œ ë””ìŠ¤í¬ë¥¼ ë‚˜ëˆ ì„œ ê´€ë¦¬ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆë‹¤ê³ <br />
ë³´ì‹œë©´ ë©ë‹ˆë‹¤.</p>
<p><a href="https://charsyam.wordpress.com/2018/12/15/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-1/ext_disk_layout/#main" rel="attachment wp-att-2740"><img data-attachment-id="2740" data-permalink="https://charsyam.wordpress.com/2018/12/15/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-1/ext_disk_layout/#main" data-orig-file="https://charsyam.files.wordpress.com/2018/12/ext_disk_layout.png" data-orig-size="1770,479" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ext_disk_layout" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2018/12/ext_disk_layout.png?w=300" data-large-file="https://charsyam.files.wordpress.com/2018/12/ext_disk_layout.png?w=776&#038;h=210" class="aligncenter size-large wp-image-2740" src="https://charsyam.files.wordpress.com/2018/12/ext_disk_layout.png?w=776&#038;h=210" alt="ê·¸ë¦¼1" width="776" height="210" srcset="https://charsyam.files.wordpress.com/2018/12/ext_disk_layout.png?w=776&amp;h=210 776w, https://charsyam.files.wordpress.com/2018/12/ext_disk_layout.png?w=1552&amp;h=420 1552w, https://charsyam.files.wordpress.com/2018/12/ext_disk_layout.png?w=150&amp;h=41 150w, https://charsyam.files.wordpress.com/2018/12/ext_disk_layout.png?w=300&amp;h=81 300w, https://charsyam.files.wordpress.com/2018/12/ext_disk_layout.png?w=768&amp;h=208 768w, https://charsyam.files.wordpress.com/2018/12/ext_disk_layout.png?w=1024&amp;h=277 1024w" sizes="(max-width: 776px) 100vw, 776px" /></a></p>
<p>ì¦‰ ê·¸ë¦¼1 ì²˜ëŸ¼ í•˜ë‚˜ì˜ ë””ìŠ¤í¬ë¥¼ ì—¬ëŸ¬ê°œì˜ Block Group ìœ¼ë¡œ ë‚˜ëˆ„ê²Œ ë©ë‹ˆë‹¤. ë³´í†µ í•˜ë‚˜ì˜ Block Group ì€ 128MB<br />
í• ë‹¹ ë©ë‹ˆë‹¤. ê·¸ëŸ¼ í•˜ë‚˜ì˜ Block Group ì€ ì–´ë–»ê²Œ êµ¬ì„±ë˜ëŠ”ê°€? ê·¸ë¦¼2 ì²˜ëŸ¼ ê° Block Group ì€ ì „ì²´ ì •ë³´ë¥¼ ê°€ì§€ëŠ”<br />
Super Block ê³¼ GDTs, Reserved GDTsë¥¼ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤. ì´ ì •ë³´ë“¤ì€ ì£¼ë¡œ Block Group 0ë²ˆì˜ ê²ƒì„ ì‚¬ìš©í•˜ì§€ë§Œ<br />
ë°±ì—…ìš©ìœ¼ë¡œ ë‹¤ë¥¸ Block Group ë“¤ì—ë„ ì¡´ì¬í•©ë‹ˆë‹¤. ì´ ê²ƒ ì´ì™¸ì— Block Bitmap, Inode Bitmap, Inode Table,<br />
Data ì˜ì—­ì€ ê° Block Group ë‹¨ìœ„ë¡œ ê´€ë¦¬ë˜ëŠ” ì •ë³´ë“¤ì…ë‹ˆë‹¤. ì´ ë•Œ ë³´ë©´ Block Bitmap, Inode Bitmapì€ í•˜ë‚˜ì˜<br />
Block ë§Œ í• ë‹¹ ë°›ê¸° ë•Œë¬¸ì— Blockì˜ í¬ê¸°ê°€ 4K ë¼ë©´ bit ë‹¨ìœ„ë¡œ ì´ 32k ê°œë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ 32k * 4K<br />
í•´ì„œ í•˜ë‚˜ì˜ Block Group ì˜ í¬ê¸°ê°€ 128MBë¡œ ë³´í†µ ì„¤ì •ë˜ê²Œ ë©ë‹ˆë‹¤.</p>
<p><a href="https://charsyam.wordpress.com/2018/12/15/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-1/block_group/#main" rel="attachment wp-att-2741"><img data-attachment-id="2741" data-permalink="https://charsyam.wordpress.com/2018/12/15/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-1/block_group/#main" data-orig-file="https://charsyam.files.wordpress.com/2018/12/block_group.png" data-orig-size="1770,479" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="block_group" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2018/12/block_group.png?w=300" data-large-file="https://charsyam.files.wordpress.com/2018/12/block_group.png?w=776&#038;h=210" class="aligncenter size-large wp-image-2741" src="https://charsyam.files.wordpress.com/2018/12/block_group.png?w=776&#038;h=210" alt="ê·¸ë¦¼2" width="776" height="210" srcset="https://charsyam.files.wordpress.com/2018/12/block_group.png?w=776&amp;h=210 776w, https://charsyam.files.wordpress.com/2018/12/block_group.png?w=1552&amp;h=420 1552w, https://charsyam.files.wordpress.com/2018/12/block_group.png?w=150&amp;h=41 150w, https://charsyam.files.wordpress.com/2018/12/block_group.png?w=300&amp;h=81 300w, https://charsyam.files.wordpress.com/2018/12/block_group.png?w=768&amp;h=208 768w, https://charsyam.files.wordpress.com/2018/12/block_group.png?w=1024&amp;h=277 1024w" sizes="(max-width: 776px) 100vw, 776px" /></a></p>
<p>ê·¸ëŸ°ë° ì´ êµ¬ì¡°ì˜ ë‹¨ì ì€ ë¬´ì—‡ì¼ê¹Œìš”? ì‘ì€ í¬ê¸°ì˜ íŒŒì¼ì€ í° ë¬¸ì œê°€ ì—†ëŠ”ë°, 128MB(ì‹¤ì œë¡œëŠ” ì´ê²ƒë³´ë‹¤ ì¡°ê¸ˆ ë” ì‘ì€ í¬ê¸°ì˜)<br />
ë¥¼ ë„˜ì–´ê°€ëŠ” íŒŒì¼ë¶€í„°ëŠ” Block Group í•˜ë‚˜ì— ì €ì¥ë˜ì§€ ì•Šì•„ì„œ, ë¬´ì¡°ê±´ Disk ì— ë¬¼ë¦¬ì ìœ¼ë¡œ Fragmentation ì´ ë°œìƒí•˜ê²Œ ë©ë‹ˆë‹¤.<br />
ì¦‰ ì—°ì†ì ìœ¼ë¡œ ì½ì„ ìˆ˜ ì—†ê³ , Random Access ê°€ ë°œìƒí•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ì£ . ê·¸ë¦¬ê³  í˜„ì¬ì—ëŠ” ì‚¬ì‹¤ 128MB ë‹¨ìœ„ëŠ” ìƒê°ë³´ë‹¤<br />
ë§ì´ ì‘ìŠµë‹ˆë‹¤.</p>
<p>ê·¸ëŸ¼ ê²°êµ­ Flexible Block Group ì€ ë­ëƒ? ëª‡ê°œì˜ Block Group ë“¤ì„ í•˜ë‚˜ë¡œ ë¬¶ìëŠ” ê²ƒì´ ë©”ì¸ ì•„ì´ë””ì–´ ì…ë‹ˆë‹¤.<br />
ê·¸ë˜ì„œ ê·¸ë¦¼3 ì²˜ëŸ¼ ê° Block Group ì˜ Block Bitmap, Inode Bitmap ë“±ì´ ì­ˆìš± ì—°ê²°ë˜ì„œ í•˜ë‚˜ì²˜ëŸ¼ ê´€ë¦¬ë˜ê²Œ ë©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ”<br />
8ê°œì˜ Block Group ì´ í•˜ë‚˜ì²˜ëŸ¼ ê´€ë¦¬ë˜ëŠ” ê²ƒìœ¼ë¡œ ê°€ì •í–ˆìŠµë‹ˆë‹¤.</p>
<p><a href="https://charsyam.wordpress.com/2018/12/15/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-1/flexible_block_group/#main" rel="attachment wp-att-2739"><img data-attachment-id="2739" data-permalink="https://charsyam.wordpress.com/2018/12/15/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-1/flexible_block_group/#main" data-orig-file="https://charsyam.files.wordpress.com/2018/12/flexible_block_group.png" data-orig-size="1770,608" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="flexible_block_group" data-image-description="" data-medium-file="https://charsyam.files.wordpress.com/2018/12/flexible_block_group.png?w=300" data-large-file="https://charsyam.files.wordpress.com/2018/12/flexible_block_group.png?w=776&#038;h=267" class="aligncenter size-large wp-image-2739" src="https://charsyam.files.wordpress.com/2018/12/flexible_block_group.png?w=776&#038;h=267" alt="ê·¸ë¦¼3" width="776" height="267" srcset="https://charsyam.files.wordpress.com/2018/12/flexible_block_group.png?w=776&amp;h=267 776w, https://charsyam.files.wordpress.com/2018/12/flexible_block_group.png?w=1552&amp;h=534 1552w, https://charsyam.files.wordpress.com/2018/12/flexible_block_group.png?w=150&amp;h=52 150w, https://charsyam.files.wordpress.com/2018/12/flexible_block_group.png?w=300&amp;h=103 300w, https://charsyam.files.wordpress.com/2018/12/flexible_block_group.png?w=768&amp;h=264 768w, https://charsyam.files.wordpress.com/2018/12/flexible_block_group.png?w=1024&amp;h=352 1024w" sizes="(max-width: 776px) 100vw, 776px" /></a></p>
<p>ì •ë¦¬í•˜ìë©´, ê° Block Group ì— ìˆë˜, Block Bitmap, Inode Bitmap, Inode Table ì˜ì—­ë“¤ì´ ì­ˆìš± ì—°ê²°ë˜ëŠ” í˜•íƒœë¡œ ë“¤ì–´ê°€ê²Œ ë©ë‹ˆë‹¤.<br />
0ë²ˆ Block Group ì— ë‹¤ë¥¸ Block Group ë“¤ì˜ ë©”íƒ€ì •ë³´(Block Bitmap, Inode Bitmap, Inode Table) ë“¤ì´ ë‹¤ ë„˜ì–´ì˜¤ê²Œ ë˜ëŠ” ê²ƒì´ì£ .<br />
ê·¸ë¦¼2ì™€ ë¹„êµí•´ë³´ì‹œë©´ ê·¸ ì°¨ì´ê°€ ëª…í™•í•˜ê²Œ ë³´ì´ì‹¤ ê²ë‹ˆë‹¤.</p>
<p>ì£¼ì˜ í•  ê²ƒì€ EXT4ì—ì„œ Flexible Block Group ì€ ë¬´ì¡°ê±´ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, í—¤ë”ì— FLEX_BG ë¼ëŠ” Flagê°€ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ë§Œ Flexible Block Group ì„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. ì¦‰, ì´ Flagê°€ êº¼ì ¸ìˆë‹¤ë©´, ì˜ˆì „ ë°©ì‹ëŒ€ë¡œ ì²˜ë¦¬í•´ì•¼í•œ í•©ë‹ˆë‹¤.</p>
<p>ë‹¤ìŒë²ˆì—ëŠ” EXT4ì—ì„œ extentsë¥¼ ì–´ë–»ê²Œ ê´€ë¦¬í•˜ëŠ”ì§€, ì‚´í´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>
<p>EXT4 ì— ëŒ€í•´ì„œ <a href="https://ext4.wiki.kernel.org/index.php/Ext4_Disk_Layout">Ext4 Disk Layout</a> ì´ë¼ëŠ” ë§¤ìš° ì¢‹ì€ ìë£Œê°€ ìˆìŠµë‹ˆë‹¤. ìì„¸í•œ ê±´ ì´ê±¸ ì°¸ê³ í•˜ì„¸ìš”.</p>
]]></content:encoded>
							<wfw:commentRss>https://charsyam.wordpress.com/2018/12/15/%ec%9e%85-%ea%b0%9c%eb%b0%9c-ext4-%ec%97%90%ec%84%9c-%eb%8b%ac%eb%9d%bc%ec%a7%84-%eb%b6%80%eb%b6%84%eb%93%a4-1/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
						
		<media:content url="https://2.gravatar.com/avatar/eb957612b8f29b31a16f21df385691ed?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">charsyam</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2018/12/ext_disk_layout.png?w=776" medium="image">
			<media:title type="html">ê·¸ë¦¼1</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2018/12/block_group.png?w=776" medium="image">
			<media:title type="html">ê·¸ë¦¼2</media:title>
		</media:content>

		<media:content url="https://charsyam.files.wordpress.com/2018/12/flexible_block_group.png?w=776" medium="image">
			<media:title type="html">ê·¸ë¦¼3</media:title>
		</media:content>
	</item>
		<item>
		<title>[ì… ê°œë°œ] Redis ì—ì„œ zadd ì™€ zincrby ì˜ ì°¨ì´</title>
		<link>https://charsyam.wordpress.com/2018/09/06/%ec%9e%85-%ea%b0%9c%eb%b0%9c-redis-%ec%97%90%ec%84%9c-zadd-%ec%99%80-zincrby-%ec%9d%98-%ec%b0%a8%ec%9d%b4/</link>
				<comments>https://charsyam.wordpress.com/2018/09/06/%ec%9e%85-%ea%b0%9c%eb%b0%9c-redis-%ec%97%90%ec%84%9c-zadd-%ec%99%80-zincrby-%ec%9d%98-%ec%b0%a8%ec%9d%b4/#respond</comments>
				<pubDate>Thu, 06 Sep 2018 15:47:22 +0000</pubDate>
		<dc:creator><![CDATA[charsyam]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://charsyam.wordpress.com/?p=2734</guid>
				<description><![CDATA[ì•ˆë…•í•˜ì„¸ìš”. ì…ê°œë°œ CharSyamì…ë‹ˆë‹¤. ì˜¤ë˜ê°„ë§Œì— í¬ìŠ¤íŒ…ì„ í•˜ê²Œ ë˜ë„¤ìš”. ì˜¤ëŠ˜ì€ ì•„ì£¼ ê°„ë‹¨í•œ ê²ƒì„ í¬ìŠ¤íŒ… í• ë ¤ê³  í•©ë‹ˆë‹¤. ê°€ë”ì”© Redisì˜ sorted set ì„ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì¤‘ì— zadd ì™€ zincrby ê°€ ìˆìŠµë‹ˆë‹¤. ê³¼ì—° ì´ ë‘ ê°œì˜ ëª…ë ¹ì€ ì–´ë–¤ ì°¨ì´ê°€ ìˆì„ê¹Œìš”? ê²°ë¡ ë¶€í„° ë§í•˜ìë©´, zadd ì™€ zincrby ëŠ” ì‚¬ì‹¤ ê°™ì€ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” ì•„ì£¼ ìœ ì‚¬í•œ ëª…ë ¹ì…ë‹ˆë‹¤. ë¨¼ì € zadd ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•˜ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ sorted [&#8230;]]]></description>
								<content:encoded><![CDATA[<p>ì•ˆë…•í•˜ì„¸ìš”. ì…ê°œë°œ CharSyamì…ë‹ˆë‹¤. ì˜¤ë˜ê°„ë§Œì— í¬ìŠ¤íŒ…ì„ í•˜ê²Œ ë˜ë„¤ìš”. ì˜¤ëŠ˜ì€ ì•„ì£¼ ê°„ë‹¨í•œ ê²ƒì„ í¬ìŠ¤íŒ… í• ë ¤ê³  í•©ë‹ˆë‹¤. ê°€ë”ì”© Redisì˜ sorted set ì„ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì¤‘ì— zadd ì™€ zincrby ê°€ ìˆìŠµë‹ˆë‹¤. ê³¼ì—° ì´ ë‘ ê°œì˜ ëª…ë ¹ì€ ì–´ë–¤ ì°¨ì´ê°€ ìˆì„ê¹Œìš”?</p>
<p>ê²°ë¡ ë¶€í„° ë§í•˜ìë©´, zadd ì™€ zincrby ëŠ” ì‚¬ì‹¤ ê°™ì€ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” ì•„ì£¼ ìœ ì‚¬í•œ ëª…ë ¹ì…ë‹ˆë‹¤. ë¨¼ì € zadd ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•˜ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
zadd key score member
</pre>
<p>ê·¸ëŸ¬ë©´ sorted set ì— member ê°€ í•´ë‹¹ scoreë¥¼ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤ë¥¼ ì¤‘ìš”í•˜ê²Œ ë´ì£¼ì„¸ìš”.</p>
<p>ê·¸ë¦¬ê³  zincrby ëŠ” íŠ¹ì • ê°’ increment ë§Œí¼ scoreë¥¼ ì¦ê°€ì‹œí‚¤ëŠ” ëª…ë ¹ì…ë‹ˆë‹¤.</p>
<pre class="brush: bash; title: ; notranslate">
zincrby key increment member
</pre>
<p>ê·¸ë ‡ë‹¤ë©´ ë‹¤ìŒ ë‘ ê°€ì§€ ê²½ìš°ë¡œ ë‚˜ëˆ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. í˜„ì¬ í•´ë‹¹ keyì— memberê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°ì™€ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. ë¨¼ì € ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš°, ë‘ ê°œì˜ ëª…ë ¹ zadd ì™€ zincrby ëŠ” ëª¨ë‘ í•´ë‹¹ memberë¥¼ ìƒì„±í•˜ê²Œ ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  zadd ëŠ” í•´ë‹¹ scoreë¡œ ì„¤ì •í•˜ê³  zincrby ëŠ” 0ì— í•´ë‹¹ incrementë¥¼ ì¶”ê°€í•œ ê²ƒ ì²˜ëŸ¼ ë™ì‘í•©ë‹ˆë‹¤.(ì¦‰ ë‘˜ ë‹¤ í•´ë‹¹ ê°’ìœ¼ë¡œ ì„¤ì •í•˜ê²Œ ë˜ëŠ”ê±°ì£ .)</p>
<p>ê·¸ë ‡ë‹¤ë©´ í•´ë‹¹ memberê°€ ì¡´ì¬í•  ê²½ìš°ëŠ” ì–´ë–»ê²Œ ë ê¹Œìš”? zaddëŠ” í•´ë‹¹ memberì˜ scoreë¥¼ í˜„ì¬ ë„˜ê²¨ì¤€ ê°’ìœ¼ë¡œ ë³€ê²½ì‹œì¼œ ë²„ë¦½ë‹ˆë‹¤. ì¦‰ ê¸°ì¡´ì— 3ì´ ì—ˆëŠ”ë° zadd key 1 member ë¼ë©´ í•´ë‹¹ member ì˜ score ëŠ” 3ì—ì„œ 1ë¡œ ë³€ê²½ì´ ë©ë‹ˆë‹¤. zincrby ì˜ ê²½ìš°ëŠ” zincrby key 1 member ë¼ë©´ ê¸°ì¡´ ê°’ì´ 3ì´ ìˆì—ˆë‹¤ë©´, ì´ì œ 3ì— 1ì„ ë”í•˜ê²Œ ë˜ì–´ì„œ 4ê°€ ë˜ê²Œ ë©ë‹ˆë‹¤.</p>
<p>ì½”ë“œë¥¼ ë³´ë©´ zadd ì™€ zincrby ëŠ” Flag í•˜ë‚˜ë§Œ ë‹¤ë¥´ê³  ë™ì¼í•œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<pre class="brush: cpp; title: ; notranslate">
void zaddCommand(client *c) {
    zaddGenericCommand(c,ZADD_NONE);
}

void zincrbyCommand(client *c) {
    zaddGenericCommand(c,ZADD_INCR);
}
</pre>
<p>ê·¸ë¦¬ê³  zaddGenericCommandë¥¼ ë³´ë©´ zsetAdd ë¥¼ í˜¸ì¶œí•˜ê²Œ ë˜ëŠ”ë°&#8230; zaddëŠ” ëª¨ë‘ ê¸°ì¡´ ê°’ì„ ê°€ì ¸ì™€ì„œ, score ë¥¼ ë¹„êµí•©ë‹ˆë‹¤. ê·¸ë˜ì„œ zincrby ì—ì„œ ZADD_INCR ì„¤ì •ë˜ë©´ new_score ë¡œ ê¸°ì¡´ê°’ + incrementë¡œ ì„¤ì •í•˜ê³ , zadd ì—ì„œëŠ” new_score ë¥¼ ë„˜ê²¨ì¤€ ì„¤ì •ê°’ìœ¼ë¡œ ì„¤ì •í•˜ê²Œ ë©ë‹ˆë‹¤.</p>
<pre class="brush: cpp; title: ; notranslate">
            /* Prepare the score for the increment if needed. */
            if (incr) {
                score += curscore;
                if (isnan(score)) {
                    *flags |= ZADD_NAN;
                    return 0;
                }
                if (newscore) *newscore = score;
            }

            /* Remove and re-insert when score changed. */
            if (score != curscore) {
                zobj-&gt;ptr = zzlDelete(zobj-&gt;ptr,eptr);
                zobj-&gt;ptr = zzlInsert(zobj-&gt;ptr,ele,score);
                *flags |= ZADD_UPDATED;
            }
</pre>
<p>ê·¸ë¦¬ê³  scoreê°€ ë³€ê²½ë˜ë©´ sorted set ì€ ê¸°ì¡´ memberë¥¼ ì§€ìš°ê³  ë‹¤ì‹œ insert í•˜ëŠ” ì‹ìœ¼ë¡œ ë™ì‘í•˜ê²Œ ë©ë‹ˆë‹¤. ê²°êµ­ zadd ì™€ zincrby ëŠ” ê±°ì˜ ë‹¤ë¥¸ê²Œ ì—†ìŠµë‹ˆë‹¤.</p>
]]></content:encoded>
							<wfw:commentRss>https://charsyam.wordpress.com/2018/09/06/%ec%9e%85-%ea%b0%9c%eb%b0%9c-redis-%ec%97%90%ec%84%9c-zadd-%ec%99%80-zincrby-%ec%9d%98-%ec%b0%a8%ec%9d%b4/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
						
		<media:content url="https://2.gravatar.com/avatar/eb957612b8f29b31a16f21df385691ed?s=96&#38;d=identicon&#38;r=G" medium="image">
			<media:title type="html">charsyam</media:title>
		</media:content>
	</item>
	</channel>
</rss>
