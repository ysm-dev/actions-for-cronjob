<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
<channel>
<title>jinyo의 뇌</title>
<link>https://wingnim.tistory.com/</link>
<description>jinyo의 뇌에서 나오는 잡다한 것들</description>
<language>ko</language>
<pubDate>Sun, 12 May 2019 17:27:37 +0900</pubDate>
<generator>TISTORY</generator>
<managingEditor>Jinyo(진요)</managingEditor>
<image>
<title>jinyo의 뇌</title>
<url>https://tistory1.daumcdn.net/tistory/398821/attach/c06004e5b0af4f0facd997822a887b3a</url>
<link>https://wingnim.tistory.com</link>
<description>jinyo의 뇌에서 나오는 잡다한 것들</description>
</image>
<item>
<title>[한글-1] CS294-158 Deep Unsupervised Learning Spring 2019</title>
<link>https://wingnim.tistory.com/63</link>
<description>&lt;div class=&quot;tt_adsense_top&quot; style=&quot;margin-bottom:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 상단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;7407363029&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;* 이 글을 쓰는데 3주가량 걸렸다;; 생각보다 강의가 너무 길고 내용이 많고 이해하기라 힘들&lt;strike&gt;고 조금 지루하&lt;/strike&gt;다. 동영상 강의도 온전하지 않지만 그렇기에 이 글도 뭔가 부분 부분 비어있는 느낌이 듦으로, 동영상 강의와 같이 보는 것을 추천한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;h1&gt;Lecture1a - Logistics(실행 계획)&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://wingnim.tistory.com/62&quot; target=&quot;_blank&quot;&gt;2019/03/27 - [Programming Project/CS294-158] - [한글-0] CS294-158 Deep Unsupervised Learning Spring 2019&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이전 글에 적어 놓았으니 참고하기 바란다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;h1&gt;Lecture1b&amp;nbsp;- Motivation&lt;/h1&gt;&lt;p&gt;왜 unsupervised learning을 공부해야 하는가?&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이번 글은 전반적인 motivation 등에 관련된 내용으로 대략적인 내용만 짚고 넘어가면 된다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;supervised learning은 굉장히 잘 동작하지만, data를 모으는 것이 힘들다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;unsupervised learning은 라벨링이 되어있지 않은 raw data들로부터 아무런 사람의 노동(annotation, giving reward 등)&amp;nbsp;없이 정답을 배울 수 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;unsupervised learning에는 두 가지 큰 접근 방법이 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그 중 하나는 데이터의 확률 분포를 생성하는&amp;nbsp;&lt;b&gt;generative models - based unsupervised learning&amp;nbsp;&lt;/b&gt;이고 다른 한 종류는 데이터를 이해해서 스스로 새로운 데이터를 생성해내는&amp;nbsp;&lt;b&gt;self-supervised learning&lt;/b&gt;이다. (추후 다시 설명을 할 것)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;Geoffery Hinton이 말하길&lt;/p&gt;&lt;p&gt;&quot;인간의 뇌는 10^14 의 synapses를 가지고 있는데, 우리는 단지 10^9초 만을 살아간다. 따라서 데이터보다 너무 많은 parameter을 가지고 있다고 할 수 있다. 이 말은 적어도 1초당 10^5 dimension의 생각(감각을 포함해)을&amp;nbsp;input으로&amp;nbsp;받을 수 있는 유일한 곳이므로&amp;nbsp;우리는&amp;nbsp;수많은 unsupervised learning을 해야한다는 뜻이 된다.&quot;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이라고 했다고 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;(번역을 하다 보니 뭔가 문장이 매끄럽지 않아진 것 같지만 여튼 unsupervised learning은 우리가 실생활에서 계속 하고 있는 것이라는 의미이다)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;여튼, 요약하자면&amp;nbsp; unsupervised learning은 다른 모든 것들보다 더 데이터를 얻기 쉽고, 실생활에서 인간이 학습하는 방법과도 가장 유사하기 때문에&amp;nbsp;중요하다고 할 수 있다는 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;Deep unsupervised learning으로 할 수 있는 것들&lt;/p&gt;&lt;p&gt;- Generate novel data (새로운 데이터 생성)&lt;/p&gt;&lt;p&gt;- Compression (데이터 압축)&lt;/p&gt;&lt;p&gt;- Improve downstream tasks (하층부의 일들 개선)&lt;/p&gt;&lt;p&gt;- Flexible building blocks (다른 문제의 component로 사용 가능한 유연한 블록들)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;특히 image생성에 대한 역사를 되짚어보자면 다음과 같다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile30.uf.tistory.com%2Fimage%2F9908F1335CA1D2A33C0999&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/9908F1335CA1D2A33C&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처.PNG&quot; height=&quot;504&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span style=&quot;text-align: left;&quot;&gt;&lt;br /&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile25.uf.tistory.com%2Fimage%2F99E819335CA1D2A3336F0E&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99E819335CA1D2A333&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처2.PNG&quot; height=&quot;624&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: left; clear: none; float: none;&quot;&gt;위 까지가 GAN 이전 세대의 generative model들이다.&lt;/p&gt;&lt;p style=&quot;text-align: left; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: left; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: left; clear: none; float: none;&quot;&gt;그리고 아래부터가 GAN 이후 세대의 모델들이다.&lt;/p&gt;&lt;p style=&quot;text-align: left; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: left; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile25.uf.tistory.com%2Fimage%2F9941FB335CA1D2A4073C7A&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/9941FB335CA1D2A407&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처3.PNG&quot; height=&quot;264&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: left; clear: none; float: none;&quot;&gt;처음 나온 GAN&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile24.uf.tistory.com%2Fimage%2F991CF0335CA1D2A50906F2&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/991CF0335CA1D2A509&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처4.PNG&quot; height=&quot;348&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: left; clear: none; float: none;&quot;&gt;DC GAN이 되며 2015년, GAN이 한층 성능이 좋아졌다.&lt;/p&gt;&lt;p style=&quot;text-align: left; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile1.uf.tistory.com%2Fimage%2F99E97A335CA1D2A70CC89A&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99E97A335CA1D2A70C&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처5.PNG&quot; height=&quot;267&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: left; clear: none; float: none;&quot;&gt;GAN으로 이미지 고해상도 변환도 가능하고&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile30.uf.tistory.com%2Fimage%2F99E97C335CA1D2A80C1C8F&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99E97C335CA1D2A80C&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처6.PNG&quot; height=&quot;254&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;CycleGAN으로 이미지 transfer이 가능해 졌다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;왼쪽이 오리지날 이미지이고 오른쪽이 변환 후의 이미지이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;최근엔 GAN을 통해 High resolution images를 생성해낼 수 있음을 보인&amp;nbsp;Big gan도 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;아래는 latent space interpolation을 통한 이미지 변환 동영상이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=sW6D34mckkk&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://www.youtube.com/watch?v=sW6D34mckkk&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;급기야&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile3.uf.tistory.com%2Fimage%2F996C93355CA1DC360ED319&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/996C93355CA1DC360E&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처7.PNG&quot; height=&quot;548&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;최근 엔비디아에서 StyleGAN이라는 너무 선명한 고 해상도 이미지를 만들어내기에 이르렀다. 그리고 이전보다 더욱 많은 세부적인 조절을 할 수 있게 되었다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;Wavenet에서는 Audio를 만들어내기도 하며 Video 등도 만들 수 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;당연히&amp;nbsp;Text(글) 등도 만들어낸다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile10.uf.tistory.com%2Fimage%2F999E15385CA1FAF21ADAD4&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/999E15385CA1FAF21A&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처8.PNG&quot; height=&quot;328&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;또한 기존의 이미지 압축보다 성능이 좋다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;h1&gt;Lecture 1c - Likelihood Models&lt;/h1&gt;&lt;h2&gt;I: Autoregressive Models&lt;/h2&gt;&lt;div&gt;이제부터 본격적인 내용이다.&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;br /&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;autoregressive model&lt;/b&gt;은 처음으로 배워볼 &lt;b&gt;deep generative model&lt;/b&gt;에 대한 친구들이다.&lt;/div&gt;&lt;div&gt;( regressive(회귀) model에 대해 기본적인 내용은 알고 있기를 바라며.. )&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;얘네들은 train하기도 쉽고 컨셉이 쉽기 때문에 처음 배우기가 좋다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;목차는 다음과 같다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile9.uf.tistory.com%2Fimage%2F99127F4A5CA2F6E52F5F3F&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99127F4A5CA2F6E52F&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처9.PNG&quot; height=&quot;208&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;우선 Simple generative model에 대해 이야기 할 것인데, 이 simple generative models들이 얼마나 성능이 &lt;u&gt;망가지는지&lt;/u&gt;에 대해서 이야기 할 것이다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;이를 통해 현대의 모델을이 가지는 구조에 대한 이해를 돕는것이 목적이다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile22.uf.tistory.com%2Fimage%2F9905E5455CA3044906E3B6&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/9905E5455CA3044906&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처10.PNG&quot; height=&quot;243&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;우리는 어떻게 텍스트, 이미지, 오디오 등의 합성을 할 수 있을까?&lt;/p&gt;&lt;p&gt;혹은 데이터 압축이나 이상 탐지는 어떻게 할 수 있을까?&lt;/p&gt;&lt;p&gt;(데이터 압축이 여기에 들어가는 이유는 이 또한 작은 데이터로 큰 데이터를 만드는 generative model 이기 때문이라고 한다)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;Linelihood based model은 data의 joint distribution 이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;X로부터 뽑은 sample data x1~xn이 있다고 하면 새로운 data y가 이 X에 속할 확률을 구해준다고 생각하면 간단하다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;즉 임의의 x에 대해 p(x)를 구하는 것 이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이것이 간단하지만은 않은데, 우리는 &lt;b&gt;복잡한, 높은 차원의 데이터&lt;/b&gt;를 상대하기 때문이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;(128x128x3&amp;nbsp;image의 경우 ~50000차원의 공간이다.)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;또한 연산횟수나 통계적인 부분에서의 효율성 또한 챙기고 싶다.&lt;/p&gt;&lt;p&gt;그러기 위해서는&lt;/p&gt;&lt;p&gt;- 효율적인 학습과 모델 표현&lt;/p&gt;&lt;p&gt;- 표현력(퀄리티?)과 일반화&lt;/p&gt;&lt;p&gt;- 샘플링 품질과 속도&lt;/p&gt;&lt;p&gt;- 압축률과 속도&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;등과 같이 표현될 수 있는 trade-off에서&amp;nbsp;효율적이어야 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;일단 아까전에 말했듯이 최악의(simple한) generative model부터 생각 해 보자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;다시한번 말하자면, 우리의 goal은 우리가 본 x1~xn data distribution 에 해당하는 확률 분포를 찾는 것이다.&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;우리가 유한 집합 {1,...,k} 안에서 value를 가지는&amp;nbsp;&amp;nbsp;sample을 사용한다고 생각 해 보자.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;추출한 데이터의 값이 가지는 결과의 종류가&amp;nbsp;유한하다는 뜻이다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;p&gt;그렇다면 어떤 모델을 쓸 수 있을까? -&amp;gt; &lt;b&gt;히스토그램&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;1~k 를 카운팅하는 히스토그램을 사용하면 된다&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;pi = (# times i appears in the dataset ) / (# points in the dataset)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이렇게 될 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그렇다면 우리는 임의의 x에 대해 p(x)를 구하는 것이 가능하게 되었다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile7.uf.tistory.com%2Fimage%2F996BA0335CA3496B0E3E29&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/996BA0335CA3496B0E&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처11.PNG&quot; height=&quot;221&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;게다가 pi를 알고있기 때문에 이 모델로부터 임의의 1~k사이의 데이터 sampling 을 할 수 있다.&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그렇지만 이 방법만으로는 다양한 방법의 결과로 충분하지&amp;nbsp;못하다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그 이유는 curse of dimensionality라고도 불리는 문제 때문인데, 실생활의 데이터는 너무나도 많은 dimension을 가지고 있기 때문에 위의 방법처럼 1~k 와 같은&amp;nbsp;모든 경우의 수로 표현한다면 너무나 많은 데이터가 필요할 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;예를 들어, 제일&amp;nbsp;간단하다고 하는&amp;nbsp;MNIST만 해도 28*28 pixel의 이미지인데, 28*28픽셀 이미지로부터 나올 수 있는 모든 경우를 생각 해 보면 2^784 , 근사하면&amp;nbsp;10^236의 사이즈 크기가 나온다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이렇게 되면, MNIST에는 6만개의 데이터가 있는데, 이&amp;nbsp;상황에서 컴퓨터의 한계로 인해&amp;nbsp;2^784에 비해 너무나 적은 파라미터만이 학습되게 된다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이를 해결하기 위해서 &lt;b&gt;function approximation&lt;/b&gt;을 사용한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile2.uf.tistory.com%2Fimage%2F99A6053C5CA3584B238146&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99A6053C5CA3584B23&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처12.PNG&quot; height=&quot;226&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;핵심은 아래의 수식을 만족할 파라미터 θ를 찾자는 것이다.&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;txc-formula&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99AF59395CA358BA26&quot; historydata=&quot;%3Cflashrichtext%20version%3D%221%22%3E%0A%20%20%3Ctextformat%20font%3D%22Dotum%22%20size%3D%2216%22%20color%3D%222236962%22%20bold%3D%22false%22%20italic%3D%22false%22%20underline%3D%22false%22%20url%3D%22%22%20target%3D%22transparent%22%20align%3D%22left%22%20leftMargin%3D%2225%22%20rightMargin%3D%2225%22%20indent%3D%220%22%20leading%3D%220%22%20blockIndent%3D%220%22%20kerning%3D%22true%22%20letterSpacing%3D%220%22%20display%3D%22block%22%3E%28%7B%20p%20%7D_%7B%20%5Ctheta%20%20%7D%28x%29%5Cquad%20%5Capprox%20%5Cquad%20%7B%20p%20%7D_%7B%20data%20%7D%28x%29%29%3C/textformat%3E%0A%3C/flashrichtext%3E%2C%0A14%2C%0A0xFFFFFF&quot; width=&quot;154&quot; height=&quot;31&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;효율적인 함수를 통해 근사한다면 효율적인 방법이 될 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;다만 이를 어떻게 학습시키냐에 대한 것이 복잡한데, 우리는 파라미터가 정해지면 그 파라미터로 인해 발생하는 p(x)에 대한 결과값만을 알고 있지, 어떤 방법이 최적인지는 알지 못한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이를 해결하기 위해서 우리는 문제를 정확하게 정의하도록 한다.&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile23.uf.tistory.com%2Fimage%2F990D353D5CA35A19090ECF&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/990D353D5CA35A1909&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처13.PNG&quot; height=&quot;105&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;위의 loss 함수를 정의하고 (loss 함수는 주로 얼마나 잘못되었는지를 계산하는 척도이다)&amp;nbsp;이를 통해서 해결이 가능하다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;loss함수는 Maximum likelihood 함수 등을 통해 정의될 수 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile22.uf.tistory.com%2Fimage%2F9961DC415CA35F7504920F&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/9961DC415CA35F7504&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처14.PNG&quot; height=&quot;79&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;왜 굳이 이렇게 하느냐는 질문에 대한 답으로, 이것이 &lt;b&gt;실제 예제에서 동작하기 때문&lt;/b&gt;이라고 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 또한 &lt;b&gt;SGD(Stochastic gradient descent)&lt;/b&gt;를 통해 같이 계산하도록 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;Maximum likelihood + SGD를 사용하는 이유 또한 큰 데이터셋에서 잘 동작하기 때문이라고 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;위의 방법은 전반적인 학습을 위한 세팅이었다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그렇다면 모델은 뭘 사용하면 좋을까?&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile1.uf.tistory.com%2Fimage%2F992341345CA366981CF9C1&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/992341345CA366981C&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처16.PNG&quot; height=&quot;246&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;Bayes nets란 뉴럴넷과 비슷한 개념을 가진 친구다. 다만 바라보는 시야가 조건부 확률을 통한 output이라는 점이 달라졌다.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile4.uf.tistory.com%2Fimage%2F99DFE9485CA362AE1E118C&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99DFE9485CA362AE1E&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처15.PNG&quot; height=&quot;271&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;자 그러면 이제 베이즈넷 구조를 가진 모델의 경우, gradient가 충분히 tractable하다. 그렇기 때문에 우리는&amp;nbsp;maximum likelihood training을 쓸 수 있게 된다!&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 8pt;&quot;&gt;(강의 내용이 칠판에 설명하는 상황에서 칠판을 안 보여주기 때문에 말로만 설명하기에 한계가 있는 것 같다ㅠㅠ.. &lt;/span&gt;&lt;span style=&quot;font-size: 8pt;&quot;&gt;영어이긴 하지만 슬라이드를 잘 읽어보면 이해가 간다...ㅠㅠ)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이 방법을&amp;nbsp;&lt;b&gt;autoregressive model&lt;/b&gt;이라고 부를 수 있을 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;(정리하자면 Bayesian model 사용하고 maximum likelihood training 돌리면 autoregressive model 이라고 한다는 말인 것 같다.)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(47, 157, 39);&quot;&gt;※ autoregressive model이라고 자꾸 강의에서 언급하고 제대로 된 정의를 말을 안해줘서 다른 링크가서 좀 찾아봤다.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://datascienceschool.net/view-notebook/e880ecd416554dbf84db6a3e8f426b99/&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;&lt;span style=&quot;color: rgb(47, 157, 39);&quot;&gt;https://datascienceschool.net/view-notebook/e880ecd416554dbf84db6a3e8f426b99/&lt;/span&gt;&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(47, 157, 39);&quot;&gt;autoregressive model&lt;/span&gt;&lt;/b&gt;&lt;span style=&quot;color: rgb(47, 157, 39);&quot;&gt;의 좀더 정확한 설명은, 모델이 시간 t 의 output을 도출할 때에 시간 t-1, t-2 ... 들의 output또한 참고하는 모델이라고 하는 것이 맞을 것이다.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(47, 157, 39);&quot;&gt;몇개의 이전 timestamp로부터 가져올 것인지는 AR(n)모형의 n에 따라 다르다고 한다.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(47, 157, 39);&quot;&gt;자세한건 링크 참고&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그럼 대충 설계를 해보면&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile28.uf.tistory.com%2Fimage%2F99AE00355CA37A272FDE99&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99AE00355CA37A272F&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처17.PNG&quot; height=&quot;178&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;위와 같이 naive하게 설계할 수도 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;다만 저렇게되면 mnist같은 경우에는 784개의 input이므로 784번의 확률 계산을 하여야 하므로 역시 좋지 않다는 것을 알 수 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile2.uf.tistory.com%2Fimage%2F9917FD455CA3800B0A0FF9&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/9917FD455CA3800B0A&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처18.PNG&quot; height=&quot;252&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;특히 우리가 아웃풋을 생성해낼 때, 매 확률분포에 대하여 새로운 아웃풋을 생성해내므로 높은 dimension에 대해 제한적이다. (mnist만 해도 784개의 새로운 dim을 생성 할 때마다 새로운 확률을 계산 할 테니까, output크기가 커짐에 따라서 파라미터 수가 linear 하게 커지므로 너무 비효율적이다.)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;특히 텍스트 생성 등을 할 때를 생각 해 보면, 이전 time으로부터 다음 time까지 이동할 때 전후 맥락 등의 요소는 전혀 고려되지 않으므로 (정보의 이동이 없으므로) 바람직하지 않다. &lt;strike&gt;&lt;span style=&quot;font-size: 8pt;&quot;&gt;(라고 강의에서 설명 &lt;/span&gt;&lt;span style=&quot;font-size: 8pt;&quot;&gt;하는데 이건 잘 이해가 안간다)&lt;/span&gt;&lt;/strike&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그 해결책은 conditional distribution에서 파라미터를 sharing 하는 것 이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이제 RNN / Masking 등으로 이를 현명하게 풀어간 방법에 대해 배워 볼 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;text-align: center;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile25.uf.tistory.com%2Fimage%2F990BBE4C5CA6F6861B264C&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/990BBE4C5CA6F6861B&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처19.PNG&quot; height=&quot;267&quot; style=&quot;text-align: center;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;RNN이 무엇인지에&amp;nbsp;대해서는 이미 안다고 생각하고,&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;RNN 은 완벽히 autoregressive model을 풀어나가기에 적절한 구조이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;물론 단순히 RNN만을 놓고 보면&amp;nbsp;전혀 확률이나 autoregressive model등과는 상관없는 시퀀스적인 인풋을 받아서 아웃풋을 뱉는 모델이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그렇지만 RNN에 input을 x1, x2 ... 를 주고 output으로 각 time마다의 조건부 확률을 뱉어주게 만든다면 우리가 하려는 일과 정확히 일치하게 만들 수 있고 이 방법으로 텍스트 생성 등에서 상당한 성공을 거뒀다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;머신러닝에서는 우스갯 소리로 성능이 안나오면 레이어 개수를 늘려라 라는 말이 있다. 그렇지만 우리는 이제 더 많은 레이어를 쌓는것이 전혀 도움이 되지 않는 예시들을 보게 될 것이다. 그 이유는 통계적 의존성을 잃는 등의 이유 때문인데 이것은 레이어의 추가로 해결할 수 없다.&lt;/p&gt;&lt;p&gt;기존의 통계적인 머신러닝들이 딥 러닝과 반대되는 개념이 아니고, 실제로 그 두가지는 서로 상호보완적인 관계를 이루고 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이 글을 볼 독자들이 이미 멀티 레이어 퍼셉트론이라던지 컨볼루션이라던지, res-net, attention 등등의 supervised learning에 대한 사전 지식이 있다고 생각하며,&amp;nbsp;이제 앞으로 여러 모델들이 어떻게 deep autogressive&amp;nbsp;model에 적용 되는지&amp;nbsp;볼 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;text-align: center;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile29.uf.tistory.com%2Fimage%2F998A994F5CA6FDF82DE4B3&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/998A994F5CA6FDF82D&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처20.PNG&quot; height=&quot;166&quot; style=&quot;text-align: center;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;우리는 위에서 RNN을 통해 어떻게 deep autoregressive model을 매개변수화(parameterization)하는지 보았다. 그리고 이론적으로 충분히 넓은 RNN을 가지고 있다면 우리는 올바른 approximation을 할 수 있게 된다. 그렇지만 실제로 시도 해 보면 그렇지 못하게 만드는 몇가지 문제가 있는데, 우선 sequential 한 데이터의 처리를 하다보면 속도가 느려진다는 단점이 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;기존 컴퓨터들은 한 layer 단위의 병렬 처리에는 최적화 되어 있지만, sequential - linear하게 증가하는 경우 그렇지 못하다. 그래서 우리는 더욱 효과적인 방법으로&amp;nbsp;병렬적으로&amp;nbsp;네트워크를 사용할 수 있는 방법에 대해 시도해 볼 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이번에 배워볼 모델은 Masked Autoencoder for Distribution Estimation 이라는 친구다. 한창 Autoencoder이 주목받고 있던 시절 발표된 논문이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile4.uf.tistory.com%2Fimage%2F999644505CAB51F9404CDA&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/999644505CAB51F940&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처21.PNG&quot; height=&quot;301&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;오토 인코더는 기본적으로 데이터 x를 인코딩 한 output을 만드는 네트워크와&lt;/p&gt;&lt;p&gt;output을 x로 다시 디코드 하는 네트워크로 이루어져 있다. 그치만 여기서 이것이 어떤 통계학적인 의미를 가지는것에 대해서는 명확하지 않았다고 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이 페이퍼에서 하려고자 하는 것은 오토 인코더를 distribution&amp;nbsp;estimator로 사용할 수 있는 방법에 대해서이다. 다시 말해서 autoregressive model은 주어진 data point X에 대해 likelihood estimation을 리턴해 주며 그 곳에서 샘플링 또한 할 수 있는데 이 기능을 multi-layer perceptron weight를 masking함으로써 구현 해 보자는 이야기이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;위의 오른쪽(MADE) 그림을 보자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;p(x_2)를 구하고 / p(x_3|x_2)를 구하고 / p(x_1|x_2,x_3)을 구한다. (node에 붙은 번호를 자세히 보자. dependency 와 관련된 번호이다.)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이러한 것들을 masking한 배열을 곱해줌으로써 몇몇 weight를 끊어서 한번 구현 해 보자는 이야기이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;p(x_2)는 입력 x1 x2 x3의 영향을 전혀 받지 않아야 하므로(어떤것에도 depended 되지 않았으므로) 모든 아래의 model로 부터 떨어져 있고, p(x_3|x_2)는 x2의 영향을 받아야 하므로 맨 아래의 x2 node로 부터 flow가 흘러간다. 마지막으로 p(x_1|x2,x3)의 경우 맨 아래의 x2,x3의 노드로부터 flow가 흘러간다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이를 구현하기 위해서 &lt;b&gt;임의의 &lt;/b&gt;node간의 연결만을 남겨주고, 맨 아래의 경우에는 x1만 볼 것인지, x1 x2를 동시에 볼 것인지 등등에 따라 연결해주면 원하는 output을 받을 수 있다. (이를 mask로 weight를&amp;nbsp;masking하여서 (0을 곱하면 edge가 사라지는것과 마찬가지이므로)구현한다)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;* 모든&amp;nbsp;autoregressive model 은 order이 있고, 위 그림은 x2 -&amp;gt; x3 -&amp;gt; x1 순서대로 진행하는 것을 보이는 뉴럴 넷 이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;코드는 아래와 같이 구현이 가능하다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile28.uf.tistory.com%2Fimage%2F99E2A5475CAE09C60D3B98&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99E2A5475CAE09C60D&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처.PNG&quot; height=&quot;271&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;실제&amp;nbsp;코드 자체는&amp;nbsp;굉장히 쉬운데, mask를 param과 곱한 후에 matrix multiplication 해 주면 된다. 파라미터에 대한 설명은 comment에 자세히 되어 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile4.uf.tistory.com%2Fimage%2F99ADAE385CB5A19A1D0986&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99ADAE385CB5A19A1D&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처22.PNG&quot; height=&quot;324&quot; style=&quot;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;결과가 위와 같다고 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이제 다음으로 살펴볼 데이터는 다시 sequence data이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;우리가 어떤 문장, pixel의 연속 등과 같은 sequence를 가지고 있다고 할 때,&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;1D convolution 을 사용해서 conditional distribution을 구할 수도 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile8.uf.tistory.com%2Fimage%2F9947D84F5CB5A9063BB17B&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/9947D84F5CB5A9063B&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처23.PNG&quot; height=&quot;236&quot; style=&quot;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;위 그림과 같은 connection을 연결해준 후, output이 conditional distribution을 예상하도록 한다면 된다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;다만, 이렇게 된다면 limited receptive field (output을 생성하기 위해 수집한 정보의 수집 범위가 제한된다는 뜻 정도로 해석하면 된다)의 문제가 있어서&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile9.uf.tistory.com%2Fimage%2F9974843C5CB5AD8834E37F&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/9974843C5CB5AD8834&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처24.PNG&quot; height=&quot;254&quot; style=&quot;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;위와 같은 connection으로&amp;nbsp;개선된 receptive field를 만들기도 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;위와 같은&amp;nbsp;방식을 기본적으로 masking으로 처리하게 되면 (모든 커넥션을 만들어놓고 끊는) 굉장히 비 효율적이므로 우리는 convolution layer을 사용해 처리하도록 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;2d에서 이를 도전한 방법 중 하나는 PixelCNN이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile4.uf.tistory.com%2Fimage%2F991775355CB5B45304F637&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/991775355CB5B45304&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처25.PNG&quot; height=&quot;256&quot; style=&quot;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;x_i를 예측하는 데에&amp;nbsp;저 모든 blue 영역을 prev로 하는 conditional distribution이 들어갔으면 좋겠다는 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile2.uf.tistory.com%2Fimage%2F99A303365CB5B4A7069FC3&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99A303365CB5B4A706&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처26.PNG&quot; height=&quot;276&quot; style=&quot;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그것을 PixelCNN은 masked된 conv filter로&amp;nbsp;해결하였다. 좌상단부터 차례로 이전 입력을 입력받아 output으로 쓴다.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile22.uf.tistory.com%2Fimage%2F99F317385CB5B54B112214&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99F317385CB5B54B11&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처27.PNG&quot; height=&quot;295&quot; style=&quot;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;PixelCNN같은 경우 문제는 receptive field를 보았을 때, blind spot이 생길 수 있다는 문제가 있다. 필터의 생긴 모양 때문에&amp;nbsp;우측 상단을 조건부 확률의 조건으로 확인하지 못한다는 문제가 있다.&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이를 해결하기 위해 나온 것에 gated pixel cnn이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile1.uf.tistory.com%2Fimage%2F99B7D9465CB5BA470634E1&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99B7D9465CB5BA4706&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처28.PNG&quot; height=&quot;264&quot; style=&quot;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;두 가지 input을 받는데, 이전 모든 vertical의 정보를 input으로 받는 input과 왼쪽의 짜다리를 입력으로 받는 horizontal input (1D masked conv를 생각하면 된다)를 받아서 output을 내보내면 짜잔~ blind spot이 사라졌습니다~~&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;결국 이를 통해서 성능이 좋아졌다고 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile25.uf.tistory.com%2Fimage%2F99C4EB455CB5BE8203C1C9&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99C4EB455CB5BE8203&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처29.PNG&quot; height=&quot;231&quot; style=&quot;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;추가적으로, 각 conditional distribution에서 더 나은 일반화(generalization)를 위해 softmax를 사용하지 않기로 결정할 수 있다. 근처의 pixel value가 더욱 상호작용할 확률이 높다는 것을 알고 있기 때문이다. (더욱 날것의&amp;nbsp;input을 그냥 넣어주기 위해서..?)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;---------------------------------------------------&lt;/p&gt;&lt;p&gt;이상으로 Week 1 수업인데요,&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이거 수업 번역하면서 느낀건데 제 글 퀄리티가&amp;nbsp;넘 처참하네요 ㅠㅠ&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;수업이 엄청 친절한 편이 아니라서 저 자체가 이해가 70%쯤 밖에 안되어서 내용을 꽉꽉 채우지 못했습니다 ㅠ&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div class=&quot;tt_adsense_bottom&quot; style=&quot;margin-top:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 하단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;2155036344&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;</description>
<category>CS294-158</category>
<author>음악과프로그래밍 Jinyo(진요)</author>
<guid>https://wingnim.tistory.com/63</guid>
<comments>https://wingnim.tistory.com/63#entry63comment</comments>
<pubDate>Wed, 27 Mar 2019 13:47:14 +0900</pubDate>
</item>
<item>
<title>[한글-0] CS294-158 Deep Unsupervised Learning Spring 2019</title>
<link>https://wingnim.tistory.com/62</link>
<description>&lt;div class=&quot;tt_adsense_top&quot; style=&quot;margin-bottom:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 상단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;7407363029&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;버클리에 unsupervised learning에 대한 강의가 생겼길래&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;공부도 할겸 영강이라 국강으로 번역하여 포스팅 하려고 한다 (의지)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;본 강의의 실라버스는&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;text-align: center;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile30.uf.tistory.com%2Fimage%2F996EFB4C5C9B006A19274F&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/996EFB4C5C9B006A19&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처.PNG&quot; height=&quot;209&quot; style=&quot;text-align: center;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이러한데, 자세한 내용은&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://sites.google.com/view/berkeley-cs294-158-sp19/home?fbclid=IwAR3EYrnDoHv05sL6Exk77urKYJ3VOs85y1UggUvKbnCBDMygcUHXL0qD-28&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://sites.google.com/view/berkeley-cs294-158-sp19/home?fbclid=IwAR3EYrnDoHv05sL6Exk77urKYJ3VOs85y1UggUvKbnCBDMygcUHXL0qD-28&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;에 나와있으며,&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이 후 모든 포스팅은 기존의 강의 내용 뿐만 아니라 개인적인 이해를 위한 supplement를 덧붙일 수 있다. (이 부분이 ㅜㅜ 최대한 거슬리지 않도록 노력하도록 하겠다. )&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;여튼, 실라버스를 보면 좋은 내용이 많으니 한번 가보즈아ㅏㅏㅏ!!!&lt;/p&gt;&lt;div class=&quot;tt_adsense_bottom&quot; style=&quot;margin-top:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 하단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;2155036344&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;</description>
<category>CS294-158</category>
<category>cs294-158</category>
<author>음악과프로그래밍 Jinyo(진요)</author>
<guid>https://wingnim.tistory.com/62</guid>
<comments>https://wingnim.tistory.com/62#entry62comment</comments>
<pubDate>Wed, 27 Mar 2019 13:44:40 +0900</pubDate>
</item>
<item>
<title>Heroku 서버 Collaborators 추가 / 소유권 이전 하는 법</title>
<link>https://wingnim.tistory.com/60</link>
<description>&lt;div class=&quot;tt_adsense_top&quot; style=&quot;margin-bottom:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 상단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;7407363029&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;&lt;p&gt;헤로쿠 인스턴스를 올린 후, 내가 관리하고 싶지 않거나 팀 계정 등으로 소유권을 이전하여야 할 때는 다음과 같이 하면 된다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;우선 앱의 대시보드로 가서 메인에 있는 아래 사진과 같은 부분을 찾아보자.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile4.uf.tistory.com%2Fimage%2F9955EB4A5C8F9086166BA9&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/9955EB4A5C8F908616&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처.PNG&quot; height=&quot;112&quot; style=&quot;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;그 후 Manage Access 를 누르면 아래와 같은 창이 뜬다.&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile2.uf.tistory.com%2Fimage%2F9961624A5C8F90862DB651&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/9961624A5C8F90862D&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처2.PNG&quot; height=&quot;52&quot; style=&quot;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;위 동그라미 친 버튼을 눌러 Collaborator을 추가할 수 있다.&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;* 소유권 이전의 경우에도 콜라보레이터로 우선 먼저 추가 해 줘야 한다.&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;그리고 세팅으로 들어간다.&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:351px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile3.uf.tistory.com%2Fimage%2F99C4974A5C8F908608B4AE&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99C4974A5C8F908608&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처3.PNG&quot; height=&quot;218&quot; style=&quot;&quot; width=&quot;351&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;세팅은 대시보드 맨 위에 있다.&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;세팅으로 들어가면 아래 사진과 같은 transfer ownership 부분이 있는데, 동그라미 표시를 누르면 collaborator들의 리스트가 뜬다.&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;소유권을 이전 해 줄 계정을 선택하고 저장하면 해당 계정에서 소유권을 받아올 수 있게 된다.&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile29.uf.tistory.com%2Fimage%2F99EF274A5C8F90871BD766&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99EF274A5C8F90871B&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처4.PNG&quot; height=&quot;105&quot; style=&quot;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div class=&quot;tt_adsense_bottom&quot; style=&quot;margin-top:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 하단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;2155036344&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;</description>
<category>Developing</category>
<category>heroku</category>
<category>소유권 이전</category>
<category>헤로쿠</category>
<author>음악과프로그래밍 Jinyo(진요)</author>
<guid>https://wingnim.tistory.com/60</guid>
<comments>https://wingnim.tistory.com/60#entry60comment</comments>
<pubDate>Mon, 18 Mar 2019 21:38:22 +0900</pubDate>
</item>
<item>
<title>Yolo V3 + Pytorch로 자동차 번호판 라벨링 &amp; object detection 해보기</title>
<link>https://wingnim.tistory.com/58</link>
<description>&lt;div class=&quot;tt_adsense_top&quot; style=&quot;margin-bottom:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 상단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;7407363029&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;COCO 데이터 셋 등이 아닌 &lt;b&gt;직접 모은 데이터셋으로 object detection을 진행해보자!&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;자동차 번호판의 숫자들을 한번 맞춰보도록 하자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;yolo /&amp;nbsp;pytorch 환경으로 진행한다.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;(이 글에서는 Yolo의 내용은 다루고 있지 않다. 궁금하다면&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://wingnim.tistory.com/56&quot; target=&quot;_blank&quot;&gt;2019/01/31 - [Programmer Jinyo/Machine Learning] - Yolo 논문 정리 및 Pytorch 코드 구현, 분석 01 ( You Only Look Once: Unified, Real-Time Object Detection )&lt;/a&gt;&lt;/p&gt;&lt;p&gt;포스트를 참고하자. &lt;strike&gt;코드 구현은 완성하지 못했지만 이론적 설명은 마친 글이다&lt;/strike&gt;)&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(0, 87, 102); font-size: 14pt;&quot;&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28);&quot;&gt;이미지 데이터셋 만들기&lt;/span&gt;&lt;/b&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/tzutalin/labelImg&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://github.com/tzutalin/labelImg&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이미지 라벨링을 도와주는 툴이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;들어가서 본인의 환경에 맞는 세팅을 하자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;나 같은 경우에는 python + anaconda 이기 때문에 클론 받은 후 해당 폴더에서&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;pre&gt;&lt;p&gt;conda install pyqt=5
pyrcc5 -o resources.py resources.qrc
python labelImg.py&lt;/p&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;위의&amp;nbsp;명령어를 실행했다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 폴더를 하나 만들어서&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile9.uf.tistory.com%2Fimage%2F99EA784C5C6412FA15D250&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99EA784C5C6412FA15&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처.PNG&quot; height=&quot;247&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;위와 같이 파일들을 저장 해 주자.&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;(나 같은 경우 data\img폴더에 저장했다)&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile5.uf.tistory.com%2Fimage%2F99EC99505C666DD01BEC15&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99EC99505C666DD01B&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처7.PNG&quot; height=&quot;313&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;data 폴더에 predefined_classes 부분을 눌러 class를 적어준다.&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:456px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile30.uf.tistory.com%2Fimage%2F99FBC44B5C666E4B2CC956&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99FBC44B5C666E4B2C&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처8.PNG&quot; height=&quot;635&quot; width=&quot;456&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;번호를 할 꺼니까...&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;이렇게 class를 저장 해 주었고&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;python labelImg.py를 실행하면 창이 하나 뜨는데,&amp;nbsp;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:277px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile22.uf.tistory.com%2Fimage%2F99B90A4C5C6412FA1F7314&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99B90A4C5C6412FA1F&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처2.PNG&quot; height=&quot;290&quot; width=&quot;277&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;위 버튼을 클릭해서 이미지 폴더를 선택해주면 차례로 사진이 뜬다.&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;저장 폴더를 정하고 싶으면 그 아래의 Change Save Dir을 눌러서 바꿔주자.&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile29.uf.tistory.com%2Fimage%2F99D1144C5C6412FA1F3E6D&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99D1144C5C6412FA1F&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처3.PNG&quot; height=&quot;264&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;꼭 필요한 단축키는 w, a, d인데, 새로 영역 지정(w), 다음(d)&amp;nbsp;이전(a) 사진으로 넘어가기&amp;nbsp;단축키이다.&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:365px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile5.uf.tistory.com%2Fimage%2F993F024C5C6412FB1248C6&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/993F024C5C6412FB12&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처4.PNG&quot; height=&quot;385&quot; width=&quot;365&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;위와같이 w를 누르고 영역 지정을 한 후에 라벨링을 해 주면 된다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;매 사진마다 라벨링이 끝나면 Ctrl + s 후 d키로 다음 사진 라벨링을 해 주면 된다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: left; clear: none; float: none;&quot;&gt;&lt;b&gt;중요한건 Yolo 포멧으로 저장 해 줘야 한다는거.&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile8.uf.tistory.com%2Fimage%2F99D97A365C666B802ACCE1&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99D97A365C666B802A&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처6.PNG&quot; height=&quot;604&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그러면 이렇게 나온다!&lt;/p&gt;&lt;p&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;text-align: center;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile4.uf.tistory.com%2Fimage%2F998A25445C6672172A517A&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/998A25445C6672172A&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처10.PNG&quot; height=&quot;254&quot; style=&quot;text-align: center;&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;(13.txt를 연 모습)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile24.uf.tistory.com%2Fimage%2F99BF34445C667216339837&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99BF34445C66721633&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처9.PNG&quot; height=&quot;201&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 14pt; color: rgb(34, 116, 28);&quot;&gt;YOLO 받기&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이제 트레이닝 할 YOLO 본체를 받아보자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/eriklindernoren/PyTorch-YOLOv3&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://github.com/eriklindernoren/PyTorch-YOLOv3&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;여기의 깃허브에서 받았다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;자 이제, 우리가 정성스레 라벨링 한 친구들을 YOLO 소스 파일에서&amp;nbsp; 쓸 수 있도록 세팅을 해 주자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;프로젝트 폴더안의 data 폴더에 plate 라는 폴더를 만들어 주자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;/data/plate 안쪽에&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile24.uf.tistory.com%2Fimage%2F99F4A7455C694EDD2EBDD7&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99F4A7455C694EDD2E&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처11.PNG&quot; height=&quot;105&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;images&lt;/p&gt;&lt;p&gt;labels&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;폴더를 만들어 주고&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;plate.names&lt;/p&gt;&lt;p&gt;traindir.txt&lt;/p&gt;&lt;p&gt;validdir.txt&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;파일을 만들어 주자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이제 아까 만든 파일들을 넣을 차례이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;images 폴더에는 자동차 번호판에 대한 이미지들을 넣으면 되고,&lt;/p&gt;&lt;p&gt;labels 폴더에는 아까 만들어놓은 ~~.txt 파일들을 넣자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 plate.names 파일에는 아까 라벨링 결과의 classes.txt안의 내용을 복붙해주자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;우리는 학습 -&amp;gt; 결과 확인만을 진행할 것이기 때문에 validdir은 사용하지 않을 것이고&lt;/p&gt;&lt;p&gt;traindir.txt에 우리의 이미지 파일 경로들을 복사해주자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile4.uf.tistory.com%2Fimage%2F9917D3445C6950B1292C63&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/9917D3445C6950B129&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처12.PNG&quot; height=&quot;292&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;(이 글은 고작 20개의 파일들만 가지고 진행하고 있다)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28); font-size: 14pt;&quot;&gt;모델, 트레이닝 코드 수정하기&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;기존 coco 데이터셋은 80개의 class인 반면, 우리는 10개의 class만 가지고 진행하므로 조금의 수정이 필요하다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;기존의 파일을 건드리지 말고 (혹시나 잘못 건드리면 다시 clone 받아야 할 수도 있으니까)&amp;nbsp;새로운 파일을 만들면서 진행하겠다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;1.&amp;nbsp; /config/yolov3.cfg&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;위 파일을 복사해서&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;/config/yolov3plate.cfg 파일로 저장하자.&lt;/p&gt;&lt;p&gt;모델의 파라미터&amp;nbsp;정의를 내려놓은 파일이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;우리는 class 개수가 달라졌으므로&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div&gt;[convolutional]&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6;&quot;&gt;size&lt;/span&gt;=1&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6;&quot;&gt;stride&lt;/span&gt;=1&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6;&quot;&gt;pad&lt;/span&gt;=1&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6;&quot;&gt;filters&lt;/span&gt;=45&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6;&quot;&gt;activation&lt;/span&gt;=linear&lt;/div&gt;&lt;br /&gt;&lt;br /&gt;&lt;div&gt;[yolo]&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6;&quot;&gt;mask&lt;/span&gt; = 0,1,2&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6;&quot;&gt;anchors&lt;/span&gt; = 10,13,  16,30,  33,23,  30,61,  62,45,  59,119,  116,90,  156,198,  373,326&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6;&quot;&gt;classes&lt;/span&gt;=10&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6;&quot;&gt;num&lt;/span&gt;=9&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6;&quot;&gt;jitter&lt;/span&gt;=.3&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6;&quot;&gt;ignore_thresh&lt;/span&gt; = .7&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6;&quot;&gt;truth_thresh&lt;/span&gt; = 1&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6;&quot;&gt;random&lt;/span&gt;=1&lt;/div&gt;&lt;br /&gt;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;classes = 80&lt;/b&gt;으로 되어있는 부분을 10으로 고쳐준다. (총 3군데에 있다)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 그 위의 &lt;b&gt;filters=255&lt;/b&gt;로 된 부분도 45로 고쳐준다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그 이유는 mask를 3개를 쓰고 있기 때문에&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;yolo로 들어가는 input이 3 * (5 + classnum) 이기 때문이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;2. /config/plate.data&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;위 파일을 생성하고&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;classes= 10&lt;/p&gt;&lt;p&gt;train=data/plate/traindir.txt&lt;/p&gt;&lt;p&gt;valid=data/plate/validdir.txt&lt;/p&gt;&lt;p&gt;names=data/plate/plate.names&lt;/p&gt;&lt;p&gt;backup=backup/&lt;/p&gt;&lt;p&gt;eval=plate&lt;/p&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;위 내용을 복붙해주자.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:429px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile7.uf.tistory.com%2Fimage%2F99309A3A5C6957B330AA45&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99309A3A5C6957B330&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처13.PNG&quot; height=&quot;318&quot; width=&quot;429&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;체크한 두 파일을 제대로 업데이트 했으면 된다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;(tiny 버전은 왜인지 고쳐봐도 안된다)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;3. train.py&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;를 복붙하여 trainplate.py 를 만들자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div&gt;parser.add_argument(&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;--epochs&quot;&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;type&lt;/span&gt;=&lt;span style=&quot;color: #4ec9b0;&quot;&gt;int&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;default&lt;/span&gt;=&lt;span style=&quot;color: #b5cea8;&quot;&gt;200&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;help&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;number of epochs&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;parser.add_argument(&lt;span style=&quot;color: rgb(206, 145, 120);&quot;&gt;&quot;--batch_size&quot;&lt;/span&gt;, &lt;span style=&quot;color: rgb(156, 220, 254);&quot;&gt;type&lt;/span&gt;=&lt;span style=&quot;color: rgb(78, 201, 176);&quot;&gt;int&lt;/span&gt;, &lt;span style=&quot;color: rgb(156, 220, 254);&quot;&gt;default&lt;/span&gt;=&lt;span style=&quot;color: rgb(181, 206, 168);&quot;&gt;5&lt;/span&gt;, &lt;span style=&quot;color: rgb(156, 220, 254);&quot;&gt;help&lt;/span&gt;=&lt;span style=&quot;color: rgb(206, 145, 120);&quot;&gt;&quot;size of each image batch&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;parser.add_argument(&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;--model_config_path&quot;&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;type&lt;/span&gt;=&lt;span style=&quot;color: #4ec9b0;&quot;&gt;str&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;default&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;config/yolov3plate.cfg&quot;&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;help&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;path to model config file&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;parser.add_argument(&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;--data_config_path&quot;&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;type&lt;/span&gt;=&lt;span style=&quot;color: #4ec9b0;&quot;&gt;str&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;default&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;config/plate.data&quot;&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;help&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;path to data config file&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;parser.add_argument(&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;--weights_path&quot;&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;type&lt;/span&gt;=&lt;span style=&quot;color: #4ec9b0;&quot;&gt;str&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;default&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;weights/yolov3plate.weights&quot;&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;help&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;path to weights file&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;parser.add_argument(&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;--class_path&quot;&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;type&lt;/span&gt;=&lt;span style=&quot;color: #4ec9b0;&quot;&gt;str&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;default&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;data/plate/plate.names&quot;&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;help&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;path to class label file&quot;&lt;/span&gt;)&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;기존의 coco 관련 파라미터들을 다 plate 관련 파라미터로 수정해주었다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 데이터 로더 부분도 조금..&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #6a9955;&quot;&gt;# Get dataloader&lt;/span&gt;&lt;/div&gt;&lt;div&gt;dataloader = torch.utils.data.DataLoader(&lt;/div&gt;&lt;div&gt;    ListDataset(train_path), &lt;span style=&quot;color: #9cdcfe;&quot;&gt;batch_size&lt;/span&gt;=opt.batch_size, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;shuffle&lt;/span&gt;=&lt;span style=&quot;color: #569cd6;&quot;&gt;True&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;num_workers&lt;/span&gt;=opt.n_cpu&lt;/div&gt;&lt;div&gt;)&lt;/div&gt;&lt;/div&gt;&lt;br /&gt;&lt;/div&gt;&lt;p&gt;수정했다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이게 끝났다면,&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;python trainplate.py&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile6.uf.tistory.com%2Fimage%2F992FC44E5C695AED08D5D5&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/992FC44E5C695AED08&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처14.PNG&quot; height=&quot;283&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;실행시키면 학습이 쭉 된다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;데이터가 없어서 에포크 한 200 정도 돌렸다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이제 우리의 결과 파일을 받아와서 볼 차례이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;detect.py 를 수정 후 실행하면 된다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 14pt; color: rgb(34, 116, 28);&quot;&gt;&lt;br /&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 14pt; color: rgb(34, 116, 28);&quot;&gt;detect.py 수정하기&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;1. 검증하고 싶은 data파일들 저장하기&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;나같은경우에는 /data/platesamples 폴더를 만들어 그 안에 검증하고싶은 번호판 사진을 저장했다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 이미지 폴더 파라미터를&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div&gt;parser.add_argument(&lt;span style=&quot;color: #ce9178;&quot;&gt;'--image_folder'&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;type&lt;/span&gt;=&lt;span style=&quot;color: #4ec9b0;&quot;&gt;str&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;default&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;'data/platesamples'&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;help&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;'path to dataset'&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이렇게 바꿔준다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;2. config 파일 파라미터 수정하기&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div&gt;parser.add_argument(&lt;span style=&quot;color: #ce9178;&quot;&gt;'--config_path'&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;type&lt;/span&gt;=&lt;span style=&quot;color: #4ec9b0;&quot;&gt;str&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;default&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;'config/yolov3plate.cfg'&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;help&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;'path to model config file'&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;트레이닝 할 때와 같은 이유이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;3. weights path 수정하기&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;우리가 저장해놓은 학습된 모델의 결과를 이제 불러와야 할 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;별다른 수정을 하지 않았다면 /checkpoints/epoch.weights에 매 에포크마다의 결과가 저장될 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;parser.add_argument(&lt;span style=&quot;color: #ce9178;&quot;&gt;'--weights_path'&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;type&lt;/span&gt;=&lt;span style=&quot;color: #4ec9b0;&quot;&gt;str&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;default&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;'checkpoints/199.weights'&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;help&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;'path to weights file'&lt;/span&gt;)&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;에포크 200까지 돌려서 난 199.weights 를 불러왔다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;4. class name 경로 수정&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;parser.add_argument(&lt;span style=&quot;color: #ce9178;&quot;&gt;'--class_path'&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;type&lt;/span&gt;=&lt;span style=&quot;color: #4ec9b0;&quot;&gt;str&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;default&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;'data/plate/plate.names'&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;help&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;'path to class label file'&lt;/span&gt;)&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이것 또한 트레이닝때와 같다&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;5. 취향.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;parser.add_argument(&lt;span style=&quot;color: #ce9178;&quot;&gt;'--nms_thres'&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;type&lt;/span&gt;=&lt;span style=&quot;color: #4ec9b0;&quot;&gt;float&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;default&lt;/span&gt;=&lt;span style=&quot;color: #b5cea8;&quot;&gt;0.2&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;help&lt;/span&gt;=&lt;span style=&quot;color: #ce9178;&quot;&gt;'iou thresshold for non-maximum suppression'&lt;/span&gt;)&lt;/div&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이건 바꾸던지 말던지..&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이 숫자가 줄어들수록 같은 class끼리의 겹치는 경향이 줄어든다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;6. 윈도우의 경우 데이터 로더를 수정해야 한다. (나는 에러가 나길래...)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div&gt;dataloader = DataLoader(ImageFolder(opt.image_folder, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;img_size&lt;/span&gt;=opt.img_size),&lt;/div&gt;&lt;div&gt;                        &lt;span style=&quot;color: #9cdcfe;&quot;&gt;batch_size&lt;/span&gt;=opt.batch_size, &lt;span style=&quot;color: #9cdcfe;&quot;&gt;shuffle&lt;/span&gt;=&lt;span style=&quot;color: #569cd6;&quot;&gt;False&lt;/span&gt;)&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;여러 쓰레드로 데이터로딩하는게 지원이 안되더라... 그래서 지웠다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;7. 80 class로 되어 있는 부분 수정&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;        detections = non_max_suppression(detections, &lt;span style=&quot;color: #dcdcaa;&quot;&gt;len&lt;/span&gt;(classes), opt.conf_thres, opt.nms_thres)&lt;/div&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;아무런 것도 없이 80이라고 되어있던데, 좀더 범용적으로 사용할 수 있게 len(classes)로 고치자!&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이제 돌려보자&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;우리는 default 파라미터를 다 수정해줬기 떄문에 python detect.py명령어만으로 실행이 된다. ^_^&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;/output 폴더에 결과가 들어가있을 것인데, 가서 보자&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile26.uf.tistory.com%2Fimage%2F99313B505C6A4FFC2A7A5C&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99313B505C6A4FFC2A&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처15.PNG&quot; height=&quot;336&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;ㅋㅋㅋㅋㅋㅋ 성능이 쓰레기다&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그래도 데이터를 고작 20장 모았고, 20장으로 10개의 class를 판별해야하는 와중에 이정도의 결과이니 괜찮다고.. 생각한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;데이터 한 1000장 정도 모으면 그래도 확실히 훨씬 나아질것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;(기억을 더듬어서 쭉 후기를 적어보았는데 만약에 잘 안되는 부분이 있으면 댓글 달아주세요~)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div class=&quot;tt_adsense_bottom&quot; style=&quot;margin-top:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 하단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;2155036344&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;</description>
<category>Machine Learning</category>
<category>object detection</category>
<category>pytorch</category>
<category>YOLO</category>
<author>음악과프로그래밍 Jinyo(진요)</author>
<guid>https://wingnim.tistory.com/58</guid>
<comments>https://wingnim.tistory.com/58#entry58comment</comments>
<pubDate>Wed, 13 Feb 2019 22:09:00 +0900</pubDate>
</item>
<item>
<title>Yolo 논문 정리 및 Pytorch 코드 구현, 분석 02 ( You Only Look Once: Unified, Real-Time Object Detection )</title>
<link>https://wingnim.tistory.com/57</link>
<description>&lt;div class=&quot;tt_adsense_top&quot; style=&quot;margin-bottom:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 상단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;7407363029&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;&lt;p&gt;&lt;a href=&quot;https://wingnim.tistory.com/56&quot; target=&quot;_blank&quot;&gt;2019/01/31 - [Programmer Jinyo/Machine Learning] - Yolo 논문 정리 및 Pytorch 코드 구현, 분석 01 ( You Only Look Once: Unified, Real-Time Object Detection )&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이 포스트는 위 포스트에서 이어지는 글이다.&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이제 본격적으로 darknet 의 class를 정의 해 보자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이전 글에서 언급했듯, 우리는 &lt;b&gt;nn.Module&lt;/b&gt; class를 이용하여 PyTorch에서 custom architectures를 만든다. &lt;b&gt;darknet.py&lt;/b&gt;에 아래의 class를 추가하자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;class Darknet(nn.Module):
    def __init__(self, cfgfile):
        super(Darknet, self).__init__()
        self.blocks = parse_cfg(cfgfile)
        self.net_info, self.module_list = create_modules(self.blocks)&lt;/pre&gt;&lt;div&gt;우리는 darknet class의 blocks와 net_info, module_list들을 초기화 하였다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;저번에 create_modules를 실행한 결과를 잠시 가져오자면,&amp;nbsp;net_info는 다음과 같았고&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;{'type': 'net', 'batch': '64', 'subdivisions': '16', 'width': '608', 'height': '608', 'channels': '3', 'momentum': '0.9', 'decay': '0.0005', 'angle': '0', 'saturation': '1.5', 'exposure': '1.5', 'hue': '.1', 'learning_rate': '0.001', 'burn_in': '1000', 'max_batches': '500200', 'policy': 'steps', 'steps': '400000,450000', 'scales': '.1,.1'}&lt;p&gt;&lt;/p&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;module_list는 레이어들이 들어있는 ModuleList( ... )&amp;nbsp; 들이었다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28); font-size: 12pt;&quot;&gt;network의 forward 만들기&lt;/span&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;이제 forward 함수 부분을 만들자.&lt;/div&gt;&lt;div&gt;이 함수는 &lt;b&gt;nn.Module&lt;/b&gt; 의 오버라이딩 함수이다.&lt;/div&gt;&lt;div&gt;forward는 해당 layer의 입력을 받아서 출력할 결과를 계산한 후 return 해 주는 목적을 가지고 있다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;pre class=&quot;brush:python;&quot;&gt;    def forward(self, x, CUDA):
        modules = self.blocks[1:] # 0은 net 이름
        outputs = {} #We cache the outputs for the route layer
&lt;/pre&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;forward는 3개 input을 받는다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;self, x, CUDA 가 그것인데, self는 파이썬에서 항상 받는 그것이고&amp;nbsp;x는 앞 레이어로부터의 인풋, CUDA는 true면 GPU를 쓰는거고 false면 GPU를 안 쓰는것이다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;이제 우리는 self.block의 네트워크의 정보가 들어있는 첫&amp;nbsp;'net block'을 제외하고 나머지 전부 block을 순차적으로 돌면서 실행 할 것이다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;route와 shortcut layer은 이전 layer의 output이 필요하므로 outputs 에 저장해주도록 한다. key는&amp;nbsp;layer의 인덱스이고 value는&amp;nbsp;feature maps로 설정할 것이다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;module_list 로부터 순서대로 appended되었기 때문에 우리는 modules를 순서대로 실행해주도록 한다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;pre class=&quot;brush:python;&quot;&gt;write = 0     #This is explained a bit later
for i, module in enumerate(modules):        
    module_type = (module[&quot;type&quot;])
&lt;/pre&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;*write 라는 변수는 추후 설명하도록 하겠다.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28); font-size: 12pt;&quot;&gt;Convolutional and Upsample Layers&lt;/span&gt;&lt;/b&gt;&lt;/div&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;만약 모듈이 conv layer이라거나 upsample module일 경우에는 이미 구현 해 놓았기 때문에 그냥 forward pass 해 주면 된다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;        if module_type == &quot;convolutional&quot; or module_type == &quot;upsample&quot;:
            x = self.module_list[i](x)
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28); font-size: 12pt;&quot;&gt;Route Layer / Shortcut Layer&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;route layer의 코드는 이전 글에서 설명했듯, 숫자가 하나인 경우와 둘인 경우를 나누어 처리해야 한다. 두개의 feature maps를 이어붙여야 할 때는 우리는 &lt;b&gt;torch.cat&lt;/b&gt; 함수를 사용하도록 한다. ( 두 번째 argument에 1을 주는데, 이는 몇 번째 dimension을 합칠것이냐는 명령이고 pytorch의 conv layer 차원 format이 B C H W 이기 때문이다. 우리는 Channel dimension을 이어붙이고 싶은 상태이므로 1을 준다. 0을 준다면 Batch dimension이 붙어 2배의 batch size가 되어버릴 것이다.)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;        elif module_type == &quot;route&quot;:
            layers = module[&quot;layers&quot;]
            layers = [int(a) for a in layers]

            if (layers[0]) &amp;gt; 0:
                layers[0] = layers[0] - i

            if len(layers) == 1:
                x = outputs[i + (layers[0])]

            else:
                if (layers[1]) &amp;gt; 0:
                    layers[1] = layers[1] - i

                map1 = outputs[i + layers[0]]
                map2 = outputs[i + layers[1]]

                x = torch.cat((map1, map2), 1)

        elif  module_type == &quot;shortcut&quot;:
            from_ = int(module[&quot;from&quot;])
            x = outputs[i-1] + outputs[i+from_]
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;shortcut의 경우 이전 레이어와 합쳐주면 되므로 위와같이 구현해 놓았다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28); font-size: 12pt;&quot;&gt;YOLO (Detection Layer)&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;Yolo의 output은 feature map의 depth에 (혹은 dimension에)&amp;nbsp;bounding box 속성들이 있는 feature map이다. Cell에 의해 predict된 attributes는 쭉 이어붙인 상태로 되어있다. 그러므로 예를 들어 (5,6) Cell 의 2번째 bounding box를 참조하고 싶다면&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;b&gt;map[ 5, 6, (2-1) * (5+C) : 2 * (5+C) ]&lt;/b&gt; 의 인덱스를 참조해야 한다. 이전 글에서 언급했지만, 여기의 C는 class 개수이고 앞의 5는 xyhw와 confidence이다. 이 형식은 output을 처리하기가 굉장히 불편하다.&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이 것들이 나누어진 tensor이 아닌 single tensor에 들어가 있게 하기 위해서, &lt;b&gt;predict_transform&lt;/b&gt; 이라는 함수를 만들자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 12pt;&quot;&gt;Transforming Output&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;predict_transform&lt;/b&gt; 함수는 &lt;b&gt;util.py&lt;/b&gt; 에 작성 할 것이며, Darknet의 forward 시점에 사용할 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;util.py의 맨 위쪽에 import를 진행하자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;from __future__ import division

import torch 
import torch.nn as nn
import torch.nn.functional as F 
from torch.autograd import Variable
import numpy as np
import cv2 
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;predict_transform 은 5개의 파라미터를 가진다. prediction(우리의 최종 결과물), inp_dim (입력 이미지의 차원) , anchors , num_classes , CUDA flag(GPU 쓸 것인지) 등이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;def predict_transform(prediction, inp_dim, anchors, num_classes, CUDA = True):
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;predict_transform 함수는 결과 feature map을 받아와서 2d tensor로 바꾸는데, 각 줄은 하나의 bounding box를 나타낸다.&lt;/p&gt;&lt;p&gt;그 순서는 아래 사진과 같다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile30.uf.tistory.com%2Fimage%2F99DCB7385C626A9E0926FC&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99DCB7385C626A9E09&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처5.PNG&quot; height=&quot;827&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;변형하는 코드는 다음과 같다&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;    batch_size = prediction.size(0)
    stride =  inp_dim // prediction.size(2)
    grid_size = inp_dim // stride
    bbox_attrs = 5 + num_classes
    num_anchors = len(anchors)
    
    prediction = prediction.view(batch_size, bbox_attrs*num_anchors, grid_size*grid_size)
    prediction = prediction.transpose(1,2).contiguous()
    prediction = prediction.view(batch_size, grid_size*grid_size*num_anchors, bbox_attrs)
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;anchor의 dimension은 net block의 height와 width속성과 대응된다.&lt;/p&gt;&lt;p&gt;이 값은 원본 이미지의 크기에 비례한 값이므로, stride의 영향을 받아 작아진 output의 값에 비례하게 줄여줘야 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;    anchors = [(a[0]/stride, a[1]/stride) for a in anchors]
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;이제 output을 변형시킬 차례이다.&lt;/p&gt;&lt;p&gt;output을 다음과 같이 변형시킨다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;b_x,y,w,h 는 각각 바운딩 박스의 중심 x,y / 크기 w,h 이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 또한 confidence도 sigmoid를 통과시켜 준다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile9.uf.tistory.com%2Fimage%2F998B743E5C62727A0EF192&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/998B743E5C62727A0E&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처6.PNG&quot; height=&quot;299&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;    #Sigmoid the  centre_X, centre_Y. and object confidencce
    prediction[:,:,0] = torch.sigmoid(prediction[:,:,0])
    prediction[:,:,1] = torch.sigmoid(prediction[:,:,1])
    prediction[:,:,4] = torch.sigmoid(prediction[:,:,4])
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;* 시간이 너무 부족해져 글을 완성하는것은 나중으로 미루려고 한다 ㅜㅜ.. 시간이 날 때 마다 차차 글을 완성 해 나갈 것이지만 혹시나 만약을 위해 이어서 읽을 링크를 남긴다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이 글은 아래의 링크 중간정도까지의 내용을 다루고 있으며 그 후로 읽고자 한다면 읽어나가면 충분히 이어지는 맥락으로 글을 읽을 수 있을 것이다.&lt;/p&gt;&lt;p&gt;다만 이 글은 weight를 로딩해서 사용하고 있기 때문에 실제로 학습을 시키는 부분까지는 진행할 수 없다. (직접 짜야한다)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://blog.paperspace.com/how-to-implement-a-yolo-v3-object-detector-from-scratch-in-pytorch-part-3/&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://blog.paperspace.com/how-to-implement-a-yolo-v3-object-detector-from-scratch-in-pytorch-part-3/&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그래서 찾았는데, 이 아래 링크는 비슷한 방법으로 train / test 코드까지 갖추어 놓았다. 참고하면 좋을 것 같다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/eriklindernoren/PyTorch-YOLOv3&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://github.com/eriklindernoren/PyTorch-YOLOv3&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;* 다음 글에서 위 깃허브의&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://wingnim.tistory.com/58&quot; target=&quot;_blank&quot;&gt;2019/02/13 - [Programmer Jinyo/Machine Learning] - Yolo V3 / Pytorch로 자동차 번호판 라벨링 / object detection 해보기.&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;활용 편을 다루어 보았다. (....)&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div class=&quot;tt_adsense_bottom&quot; style=&quot;margin-top:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 하단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;2155036344&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;</description>
<category>Machine Learning</category>
<author>음악과프로그래밍 Jinyo(진요)</author>
<guid>https://wingnim.tistory.com/57</guid>
<comments>https://wingnim.tistory.com/57#entry57comment</comments>
<pubDate>Sat, 09 Feb 2019 03:10:19 +0900</pubDate>
</item>
<item>
<title>Yolo 논문 정리 및 Pytorch 코드 구현, 분석 01 ( You Only Look Once: Unified, Real-Time Object Detection )</title>
<link>https://wingnim.tistory.com/56</link>
<description>&lt;div class=&quot;tt_adsense_top&quot; style=&quot;margin-bottom:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 상단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;7407363029&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;Yolo 논문을 공부해야 할 일이 생겨서, 공부 하는 김에 내용과 코드 정리까지 하자는 성실한 마음으로 이 글을 쓰기 시작하기로 했다.&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size:10pt;&quot;&gt;&lt;br /&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size:10pt;&quot;&gt;&lt;br /&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 18pt;&quot;&gt;배경&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;br /&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Object Detection&lt;/b&gt;이란 머신러닝에서 한 사진 안에 어떤 물체들이 등장하는지에 대한 것을 판별해주는 Task를 말한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 Yolo는 Object Detection을 보다 효율적으로 수행하는 방법을&amp;nbsp;소개한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이 글은 전반적인 YOLO 논문에서 다루는 내용을 그대로 번역(....) 수준으로 적어낼 것이므로 다른 정리된 글들보다는 다 읽은 후 &lt;b&gt;명확한 이해&lt;/b&gt;를 할 수 있게 되길 기대한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;Yolo는 기존의 방법들과 달리 Object detection을 &lt;b&gt;이미지 픽셀 좌표에 대응되는 bounding box&lt;/b&gt;을 찾고&amp;nbsp;그것에 대한 &lt;b&gt;class확률&lt;/b&gt;을 구하는&amp;nbsp;&lt;b&gt;Single Regression Problem&lt;/b&gt;으로 바라보기로 하였다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이 말이 이해가 잘 안가더라도 이후의 글을 읽으면 차차 이해가 될 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;전체적인 대강의 흐름은 다음과 같다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile23.uf.tistory.com%2Fimage%2F9922D3355C516714112ACB&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/9922D3355C51671411&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처.PNG&quot; height=&quot;121&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;하나의 convolutional network 가 동시에 여러개의 bounding boxes를 예측하고, &lt;b&gt;각 bounding box에 대해&lt;/b&gt;&amp;nbsp;class probabilities 를 예측한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 18pt;&quot;&gt;Unified Detection&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;네트워크의 큰 특징 중 하나는 이미지 전부로부터 features를 뽑아서 각 bounding box를 예측한다는 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;시스템은 input image를 S x S grid로 나눈다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 만약 어떤 object의 한 가운데가 grid cell에 놓인다면, grid cell은 그 object를 탐지할 의무가 생긴다는 설정이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;각 grid cell은 B개의 bounding boxes를 예측하고 그 box의 예측&amp;nbsp;대한 confidence score(자신감 점수..?)를 같이 예측한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;confidence score은 얼마나 박스 안에&amp;nbsp;실제로&amp;nbsp;object가&amp;nbsp;존재하는지, 그리고 그 class를 얼마나 잘 반영했는지에 대한 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;Confidence 는 형식적으로&amp;nbsp;&lt;b&gt;Pr(Object) * IOU(intersection over union)&lt;/b&gt;&amp;nbsp;라고 정의한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;( IOU란 정답 box와 예측 box의 교집합 크기 / 합집합 크기&amp;nbsp;이다 )&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;Object가 box안에 아무것도 없을 때에는 confidence가 0이 되어야 한다.&lt;/p&gt;&lt;p&gt;또, predicted box와 ground truth의 IOU가 얼마나 일치하는지가 confidence가 되도록 맞추고 싶다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;각 Bounding box는 5가지 예측을 한다.&amp;nbsp; x, y, w, h, confidence 이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;(x,y)는 grid cell의 영역에 관련된&amp;nbsp;box의 center를 의미한다.&lt;/p&gt;&lt;p&gt;width, height&amp;nbsp;(w,h)는 박스의 높이와 너비로서, 이미지 전부와 비례하게 예측된다.&lt;/p&gt;&lt;p&gt;마지막으로 confidence는 ground truth box와 예측된 box의 IOU를 예측한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;각 grid cell은 C개의 (class 종류 개수) 조건부 확률 Pr(Class_i | Object)를 예측한다.&lt;/p&gt;&lt;p&gt;* grid cell당 B개의 bounding box를 예측하는 것과 상관 없이, cell당 한개의 class를 예측한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그 모든것을 곱해서&amp;nbsp;마지막에 예측을 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:455px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile29.uf.tistory.com%2Fimage%2F99DFC4395C55A549366443&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99DFC4395C55A54936&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처2.PNG&quot; height=&quot;59&quot; width=&quot;455&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strike&gt;( 왜 왼쪽 식이 오른쪽으로 전개가 되지..? Object와의 교집합이어야 하는거 아닌가.. )&lt;/strike&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;여튼 이 식은 얼마나 box를 잘 예측했는지, 그리고 object의 class를 잘 맞추었는지를 나타내는 score가 된다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;PASCAL VOC에서 (데이터Set이다) YOLO를 평가하기 위해서 S = 7 , B = 2로 설정하였다. PASCAL VOC 는 20개의 labelled classs를 가지고 있으므로 C=20이 된다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;결국 최종적인 예측은 7 * 7 * 30 tensor이 될 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;7*7인 grid에서 cell마다&lt;/p&gt;&lt;p&gt;20개의 class / bounding box마다 x y w h confidence 를 예측하므로&lt;/p&gt;&lt;p&gt;20 + 2 * 5&amp;nbsp; =&amp;nbsp; 30을 통해 말이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 18pt;&quot;&gt;Architecture Design&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile2.uf.tistory.com%2Fimage%2F997FB8345C55A9C4200E96&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/997FB8345C55A9C420&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처3.PNG&quot; height=&quot;213&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;전반적인 구조는 왼쪽과 같이 Conv Layer들을 이어붙여서 만들었고,&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;오른쪽의 화살표가 Cross된 부분은 Linear Layer을 표현한 것으로 7 * 7 * 1024의 상태에서 4096으로 Linear layer을 거쳤다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 마지막으로 7*7*30의 Output Linear Layer로 출력 해 주면 끝난다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;마지막 출력을 조금 더 자세히 보자면&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile2.uf.tistory.com%2Fimage%2F994B22385C55D79F036800&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/994B22385C55D79F03&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처4.PNG&quot; height=&quot;571&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이렇게 볼 수 있을 것이다. (objectness score가 confidence값이다)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 18pt;&quot;&gt;Output processing&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;13*13grid의 경우를 생각 해 보면, 13*13*B개의 bounding box들이 나올 텐데, 어떻게 출력 결과물은 단 하나만 나오는 것일까?&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;두가지의 트릭을 사용한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;1. Thresholding by Object Confidence Score&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;말 그대로 object box에서 confidence를 threshold아래로 예측한 box는 무시하는 방법이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;2. Non-maximum Suppression&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;한 object를 판단했다고 여겨지는 중복되는 것들은 제거하는 방법인데,. 자세한 방법은 아래 링크를 참고하면 좋을 것 같다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://dyndy.tistory.com/275&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://dyndy.tistory.com/275&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 18pt;&quot;&gt;Training&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;앞 쪽의 Conv Layers는 ImageNet 1000-class competition dataset으로부터 pretrain시켰다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;주로 다른 Pytorch등의 모델들을 보면 앞쪽 레이어는 Model Zoo등에서 가져온다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;Data는 PASCAL VOC 2007 데이터 셋을 썼다고 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 18pt;&quot;&gt;Code&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://blog.paperspace.com/tag/series-yolo/&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://blog.paperspace.com/tag/series-yolo/&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이하 포스트는 위 링크를 참고하여 진행한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;YOLO3가 나온 시점에서, 굳이 YOLO 기본을 코딩할 이유가 없어서 yolo3을 pytorch로 구현하는 코드를 &lt;strike&gt;슥 쇽 샥&lt;/strike&gt; 들고왔다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;strike&gt;사실 다 작성하고 나니, 이것이 Yolo code 작성법인지 PyTorch Advanced practice example인지 모르겠다.&lt;/strike&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;전반적인 코드를 들어가기에 앞서, 심리적인 거부감을 좀 줄여주기 위하여 미리 언급하고 넘어가야 할 것이 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;일단 yolo는 기본적으로 yolo저자가 만든 darknet이라는 C기반 딥러닝 프레임워크(?)를 사용했다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;config file에다 모델의 스펙을 기술해주면, C에서 그 모델 모양 그대로 네트워크를 생성해주는 친구라고 대충 생각하면 될 것 같다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 우리는 &lt;b&gt;yolo의 config파일&lt;/b&gt;을 읽어서 C기반 cuda로 export해주는 기존 방식이 아닌&amp;nbsp;pytorch로 모델을 생성해 주는 방식을&amp;nbsp;쓸&amp;nbsp;것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(34, 116, 28);&quot;&gt;&lt;b&gt;&lt;span style=&quot;font-size: 12pt;&quot;&gt;코딩 시작&lt;/span&gt;&lt;/b&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;일단 프로젝트 폴더를 만들자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 YOLO의 전반적인 구조를 코딩할 &lt;b&gt;darknet.py&lt;/b&gt; 파일과 여러 도움을 줄 함수들을 작성할&amp;nbsp;&lt;b&gt;util.py&lt;/b&gt; 파일을 그 안에 생성하자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28);&quot;&gt;Configuration file&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;cfg파일은 네트워크의 layout을 block단위로 정의해놓은 파일이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;만약 caffe에 대한 배경지식이 있다면 .protxt 파일이 cfg파일과 비슷하다고 생각할 수 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;우리는 official cfg file을 이용 할 것이고,&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/pjreddie/darknet/blob/master/cfg/yolov3.cfg&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://github.com/pjreddie/darknet/blob/master/cfg/yolov3.cfg&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;여기에서 다운로드 받을 수 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;cfg 파일을 열고 나면,&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;pre style=&quot;background-color: rgb(14, 15, 17);&quot;&gt;&lt;span class=&quot;hljs-section&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(166, 226, 46); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;[convolutional]&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;batch_normalize&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;filters&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;64&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;size&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;3&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;stride&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;2&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;pad&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;activation&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=leaky
&lt;/span&gt;&lt;span class=&quot;hljs-section&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(166, 226, 46); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
[convolutional]&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;batch_normalize&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;filters&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;32&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;size&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;stride&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;pad&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;activation&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=leaky
&lt;/span&gt;&lt;span class=&quot;hljs-section&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(166, 226, 46); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
[convolutional]&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;batch_normalize&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;filters&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;64&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;size&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;3&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;stride&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;pad&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;activation&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=leaky
&lt;/span&gt;&lt;span class=&quot;hljs-section&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(166, 226, 46); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
[shortcut]&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;3&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;activation&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=linear&lt;/span&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이런 소스가 보일 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;각 괄호들은 하나의 네트워크적인 의미를 가지고 있고, 위의 경우 3개의 convolutional layer과 1개의 shortcut을 나타내고 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;shortcut은 ResNet등에서 나온 skip connection 과 유사하다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;YOLO에서는 6타입의 layer들이 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28);&quot;&gt;Convolutional&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;pre style=&quot;background-color: rgb(14, 15, 17);&quot;&gt;&lt;p&gt;&lt;span class=&quot;hljs-section&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(166, 226, 46); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;[convolutional]&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;batch_normalize&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;filters&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;64&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;size&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;3&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;stride&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;pad&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;activation&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=leaky&lt;/span&gt;&lt;/p&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;font color=&quot;#22741c&quot;&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;&lt;br /&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font color=&quot;#22741c&quot;&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;conv layer은 딱 봐도 알겠다.&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;font color=&quot;#22741c&quot;&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;batch_norm을 할 것인지&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;필터 수는 몇개인지&lt;/p&gt;&lt;p&gt;필터 사이즈는 몇개인지&lt;/p&gt;&lt;p&gt;stride는 몇인지&lt;/p&gt;&lt;p&gt;padding은 얼마를 주는지&lt;/p&gt;&lt;p&gt;activation function은 무엇을 쓰는지 등이다.&lt;/p&gt;&lt;p&gt;&lt;font color=&quot;#22741c&quot;&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;&lt;br /&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28);&quot;&gt;&lt;br /&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28);&quot;&gt;Shortcut&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;pre style=&quot;background-color: rgb(14, 15, 17);&quot;&gt;&lt;p&gt;&lt;span class=&quot;hljs-section&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(166, 226, 46);&quot;&gt;[shortcut]&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px;&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114);&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px;&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255);&quot;&gt;3&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px;&quot;&gt;  
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114);&quot;&gt;activation&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px;&quot;&gt;=linear  &lt;/span&gt;&lt;/p&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;shortcut layer은 ResNet에서 사용된 것과 유사한 skip connection이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;from = -3이라는 뜻은 shortcut layer의 output에 3번째 전의 layer을 더해준다는 뜻이다. 기존의 skip connection과 일치한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28);&quot;&gt;Upsample&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;pre style=&quot;background-color: rgb(14, 15, 17);&quot;&gt;&lt;p&gt;&lt;span class=&quot;hljs-section&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(166, 226, 46); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;[upsample]&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;stride&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;2&lt;/span&gt;&lt;/p&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;feature map을 stride 배수에 따라 upsample하는 layer이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28);&quot;&gt;&lt;br /&gt;&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28);&quot;&gt;Route&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;pre style=&quot;background-color: rgb(14, 15, 17);&quot;&gt;&lt;p&gt;&lt;span class=&quot;hljs-section&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(166, 226, 46); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;[route]&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;layers&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt; = -&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;4&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-section&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(166, 226, 46); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
[route]&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;layers&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt; = -&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;61&lt;/span&gt;&lt;/p&gt;&lt;/pre&gt;
&lt;p&gt;Route layer은 조금의 설명이 필요하다.&lt;/p&gt;&lt;p&gt;route layer의 layers라는 속성은 한개 혹은 두개의 value를 가지고 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;layers 속성에 한개의 value만 있을 때는 그 value의 index에 해당하는 feature map의 value만을 output으로 내보낸다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;위의 예시 -4의 경우, 4번째 이전의 layer의 output layer을 내보낸다고 할 수 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;만약 두&amp;nbsp;개의 value가 있을 때는, 그 value들의 layer들의 feature map을 이어붙여서(concatenate) 내보낸다. 위의 예시같은 경우에는 depth dimension의 직전 layer (-1)과 61번째 layer을 내보내는 코드이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28);&quot;&gt;YOLO&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;pre style=&quot;background-color: rgb(14, 15, 17);&quot;&gt;&lt;p&gt;&lt;span class=&quot;hljs-section&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(166, 226, 46); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;[yolo]&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;mask&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt; = &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;2&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;anchors&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt; = &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;10&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;13&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;16&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;30&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;33&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;23&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;30&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;61&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;62&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;45&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;59&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;119&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;116&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;90&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;156&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;198&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;373&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;326&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;classes&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;80&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;num&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;9&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;jitter&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=.&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;3&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;ignore_thresh&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt; = .&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;5&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;truth_thresh&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt; = &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;random&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;/p&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;YOLO layer은 이미지의 feature들을 뽑고 난 후에 실질적인 prediction을 하는 layer이다. (특히 YOLO3에서) 디테일하게 알아야 할 몇가지 특성들이 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;anchor&lt;/b&gt;&lt;/p&gt;&lt;p&gt;bounding box의 width와 height를 예측하여 정답을 맞추는 것이&amp;nbsp;자연스러워 보이지만, 실제로 돌려보면 unstable gradient를 발생시키는 원인이 된다. 그래서 대신 anchor라고 하는 &lt;b&gt;pre-defined default bounding box&lt;/b&gt;를 사용한다. ( 그렇지 않은 경우 log-space transforms 라는걸 사용하기도 한다. )&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;mask&lt;/b&gt;&lt;/p&gt;&lt;p&gt;위에는 총 9개의 anchor이 정의되어 있는데, 그 중 mask에 적혀있는 tag에 해당하는 anchor들만 사용한다.&lt;/p&gt;&lt;p&gt;(10,13) , (16,30) , (33,23) 의 anchor만 사용한다는 뜻 !&lt;/p&gt;&lt;p&gt;그렇다면 결국 각 cell은 3개의 box를 예측하게 될 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28);&quot;&gt;Net&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;pre style=&quot;background-color: rgb(14, 15, 17);&quot;&gt;&lt;p&gt;&lt;span class=&quot;hljs-section&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(166, 226, 46); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;[net]&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(117, 113, 94); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;# Testing&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;batch&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;subdivisions&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(117, 113, 94); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;# Training&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(117, 113, 94); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;# batch=64&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-comment&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(117, 113, 94); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;# subdivisions=16&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;width&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;= &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;320&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;height&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt; = &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;320&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;channels&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;3&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;momentum&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;0.9&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;decay&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;0.0005&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;angle&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;saturation&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt; = &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1.5&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;exposure&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt; = &lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1.5&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(249, 38, 114); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;hue&lt;/span&gt;&lt;span style=&quot;color: rgb(248, 248, 242); font-family: monospace, monospace; font-size: 14px; white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;=.&lt;/span&gt;&lt;span class=&quot;hljs-number&quot; style=&quot;box-sizing: inherit; margin: 0px; padding: 0px; border: 0px; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-stretch: inherit; line-height: inherit; font-family: monospace, monospace; font-size: 14px; vertical-align: baseline; color: rgb(174, 129, 255); white-space: pre; background-color: rgb(14, 15, 17);&quot;&gt;1&lt;/span&gt;&lt;/p&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;마지막으로 net이라고 불리는 block인데, 이것은 layer이라고 부르기 보다는 네트워크 전반적인 설정을 구성해주는 block이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;네트워크의 input size라던지 하는 부분 말이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28); font-size: 12pt;&quot;&gt;Parsing the configuration file&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;설정 파일을 만들었다면, 이제 해석하고 실제 모델을 구현하는 코드가 필요하다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;위의 설명에서 이해가 잘 가지 않았더라도, 이를 실제로 해석하고 코드를 만드는 과정 가운데에 실질적인 이해가 될 수 있을것이라고 생각한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;우선 &lt;b&gt;darknet.py&lt;/b&gt; file에 기본적인 import를 하자&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;from __future__ import division

import torch 
import torch.nn as nn
import torch.nn.functional as F 
from torch.autograd import Variable
import numpy as np&lt;/pre&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;그리고 parse_cfg 파일을 작성할 것인데, configuration file을 input으로 받아서 cfg파일을 해석하는 함수를 작성 할 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;def parse_cfg(cfgfile):
    &quot;&quot;&quot;
    Takes a configuration file
    
    Returns a list of blocks. Each blocks describes a block in the neural
    network to be built. Block is represented as a dictionary in the list
    
    &quot;&quot;&quot;
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;이 함수에서는 &lt;b&gt;cfg 파일의&amp;nbsp;&lt;/b&gt;&lt;b&gt;모든&amp;nbsp;&lt;/b&gt;&lt;b&gt;block을 dict 형태로 저장&lt;/b&gt;하는 것을 목표로 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;즉, block의 속성들은 전부 key-value pair로 저장된다. 우리가 cfg 파일을 해석하면서 얻어지는 모든 속성들을 계속 dictionary에 추가한 후에, block들을 담은 blocks라는 list를 리턴하는 것이 함수의 목적이 된다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이제 파일을 읽고 한줄씩 배열에 담자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;&lt;p&gt;  # 파일 읽고 전처리하기
  file = open(cfgfile, 'r')
  lines = file.read().split('\n')                        # store the lines in a list
  lines = [x for x in lines if len(x) &amp;gt; 0]               # get read of the empty lines 
  lines = [x for x in lines if x[0] != '#']              # get rid of comments
  lines = [x.rstrip().lstrip() for x in lines]           # get rid of fringe whitespaces
&lt;/p&gt;&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;그리고 그 후에 블록을 담자.&lt;/p&gt;&lt;p&gt;결과 block을 만들어서 blocks에 append하자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;  # 이제 블록을 담자
  block = {}
  blocks = []

  for line in lines:
      if line[0] == &quot;[&quot;:               # This marks the start of a new block
          if len(block) != 0:          # If block is not empty, implies it is storing values of previous block.
              blocks.append(block)     # add it the blocks list
              block = {}               # re-init the block
          block[&quot;type&quot;] = line[1:-1].rstrip()     
      else:
          key,value = line.split(&quot;=&quot;) 
          block[key.rstrip()] = value.lstrip() # 띄어쓰기 기준으로 왼쪽 오른쪽 공백 제거
  blocks.append(block)

  return blocks
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;이렇게 Parsing을 할 수 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28); font-size: 12pt;&quot;&gt;Building Block 만들기&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이제 위의 &lt;b&gt;parse_cfg&lt;/b&gt; 함수에서 return된 list 로부터 실제의 pytorch module을 만들어보자.&lt;/p&gt;&lt;p&gt;우리는 위에서 언급된 6개의 layer들 종류를 module로 옮겨 볼 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;pytorch는 pre-built된&amp;nbsp;&lt;b&gt;convolutional &lt;/b&gt;layer이나 &lt;b&gt;upsample &lt;/b&gt;layer 이 존재한다.&lt;/p&gt;&lt;p&gt;그 외의 layer들은 &lt;b&gt;nn.Module&lt;/b&gt; class를 extending 해서 직접 구현해야 한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;create_modules&lt;/b&gt; 함수는 &lt;b&gt;parse_cfg&lt;/b&gt;로부터 나온 blocks를 입력받는다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;def create_modules(blocks):
    net_info = blocks[0]     #Captures the information about the input and pre-processing    
    module_list = nn.ModuleList()
    prev_filters = 3
    output_filters = []
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;일단 net_info 변수에 block의 이름을 저장 해 준다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;* nn.ModuleList&lt;/b&gt;&lt;/p&gt;&lt;p&gt;우리의 함수는 &lt;b&gt;nn.ModuleList&lt;/b&gt;를 리턴 해 줄 것이다. 이 클래스는 &lt;b&gt;nn.Module&lt;/b&gt; object들을 포함하고 있는 일반적인 List 와 유사하다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그렇지만 nn.ModuleList를 nn.Module의 member로 추가하게 되면, nn.ModuleList의 모든 파라미터가 nn.Module의 파라미터로 추가되게 된다. (그냥 리스트로 하면 추가가 안될 것...)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 코드에서, 우리가 새로운 convolutional layer을 정의하면, 우리는 그 kernel의 dimension또한 정의해야 한다. kernel의 height 와 width는 config 파일에 있고, depth는 (depth of the feature map)이전 레이어로부터 알 수 있다. 그 의미는 우리는 계속 convolution layer의 filter 개수를 알고 있어야 한다는 뜻이다. 우리는 이 정보를 &lt;b&gt;prev_filter&lt;/b&gt; 이라는 변수에 저장해놓기로 하자. 초기값은 처음 사진이 RGB채널이므로 3으로 세팅하도록 하자. (그리고 &lt;b&gt;filters &lt;/b&gt;라는 변수에 현재 block의 아웃풋을 저장해놓도록 하자)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;Route layer은 previous layer들의 feature map을 가져오는 레이어다. (concatenate도 가능하다. ) 만약 route layer 이후에&amp;nbsp;conv layer이 이어서 등장한다면, 그 conv layer은 route layer의 feature maps를 받게 될 것이다.&amp;nbsp; 또한 route layer 이전에 있는 레이어들은 route layer에 그 feature map을 그대로 가져오게 된다. 다른말로, 우리는 모든 각 레이어의 output을 알고 있어야 한다는 말이다.&lt;/p&gt;&lt;p&gt;우리는 이를 구현하기 위해서 number of output filter을 &lt;b&gt;output_filters &lt;/b&gt;라는 list에 저장 해 놓을 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이제 blocks 의 원소들을 차례로 살펴보면서 PyTorch module을 각 block마다 생성해주면서 진행하도록 하겠다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;    for index, x in enumerate(blocks[1:]):
        module = nn.Sequential()

        #check the type of block
        #create a new module for the block
        #append to module_list
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;nn.Sequencial&lt;/b&gt; 은 &lt;b&gt;nn.Module&lt;/b&gt; object들을 list 형태로 집어넣은 후, 차례대로 실행해주는 object이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;만약 cfg파일의 convolutional layer을 보면, batch norm이나 leakyReLU activation layer등이 한꺼번에 사용되고 있다는 것을 알 수 있을 것이다. 우리는 이 layer들을 nn.Sequential 의 &lt;b&gt;add_module &lt;/b&gt;function을 통해 이어붙여 줄 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;아래의 convolutional layer을 생성하는 부분을 보자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;        if (x[&quot;type&quot;] == &quot;convolutional&quot;):
            #Get the info about the layer
            activation = x[&quot;activation&quot;]
            try:
                batch_normalize = int(x[&quot;batch_normalize&quot;])
                bias = False
            except:
                batch_normalize = 0
                bias = True

            filters= int(x[&quot;filters&quot;])
            padding = int(x[&quot;pad&quot;])
            kernel_size = int(x[&quot;size&quot;])
            stride = int(x[&quot;stride&quot;])

            if padding:
                pad = (kernel_size - 1) // 2
            else:
                pad = 0

            #Add the convolutional layer
            conv = nn.Conv2d(prev_filters, filters, kernel_size, stride, pad, bias = bias)
            module.add_module(&quot;conv_{0}&quot;.format(index), conv)

            #Add the Batch Norm Layer
            if batch_normalize:
                bn = nn.BatchNorm2d(filters)
                module.add_module(&quot;batch_norm_{0}&quot;.format(index), bn)

            #Check the activation. 
            #It is either Linear or a Leaky ReLU for YOLO
            if activation == &quot;leaky&quot;:
                activn = nn.LeakyReLU(0.1, inplace = True)
                module.add_module(&quot;leaky_{0}&quot;.format(index), activn)

        #If it's an upsampling layer
        #We use Bilinear2dUpsampling
        elif (x[&quot;type&quot;] == &quot;upsample&quot;):
            stride = int(x[&quot;stride&quot;])
            upsample = nn.Upsample(scale_factor = 2, mode = &quot;bilinear&quot;)
            module.add_module(&quot;upsample_{}&quot;.format(index), upsample)
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;다른 함수들은 자주 보던 것들인데, upsample은 처음 보는 것이라 upsample의 수행 결과의 example을 가져왔다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;gt;&amp;gt;&amp;gt; input_3x3&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; tensor([[[[ 1.,&amp;nbsp; 2.,&amp;nbsp; 0.],&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; [ 3.,&amp;nbsp; 4.,&amp;nbsp; 0.],&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; [ 0.,&amp;nbsp; 0.,&amp;nbsp; 0.]]]])&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;gt;&amp;gt;&amp;gt; m = nn.Upsample(scale_factor=2, mode='bilinear')&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;gt;&amp;gt;&amp;gt; m(input_3x3)&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; tensor([[[[ 1.0000,&amp;nbsp; 1.2500,&amp;nbsp; 1.7500,&amp;nbsp; 1.5000,&amp;nbsp; 0.5000,&amp;nbsp; 0.0000],&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; [ 1.5000,&amp;nbsp; 1.7500,&amp;nbsp; 2.2500,&amp;nbsp; 1.8750,&amp;nbsp; 0.6250,&amp;nbsp; 0.0000],&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; [ 2.5000,&amp;nbsp; 2.7500,&amp;nbsp; 3.2500,&amp;nbsp; 2.6250,&amp;nbsp; 0.8750,&amp;nbsp; 0.0000],&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; [ 2.2500,&amp;nbsp; 2.4375,&amp;nbsp; 2.8125,&amp;nbsp; 2.2500,&amp;nbsp; 0.7500,&amp;nbsp; 0.0000],&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; [ 0.7500,&amp;nbsp; 0.8125,&amp;nbsp; 0.9375,&amp;nbsp; 0.7500,&amp;nbsp; 0.2500,&amp;nbsp; 0.0000],&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; [ 0.0000,&amp;nbsp; 0.0000,&amp;nbsp; 0.0000,&amp;nbsp; 0.0000,&amp;nbsp; 0.0000,&amp;nbsp; 0.0000]]]])&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 14pt; color: rgb(34, 116, 28);&quot;&gt;Route Layer / Shortcut Layers&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이제 Route 와 Shortcut Layer들에 대한 code를 작성하자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;        #If it is a route layer
        elif (x[&quot;type&quot;] == &quot;route&quot;):
            x[&quot;layers&quot;] = x[&quot;layers&quot;].split(',')
            #Start  of a route
            start = int(x[&quot;layers&quot;][0])
            #end, if there exists one.
            try:
                end = int(x[&quot;layers&quot;][1])
            except:
                end = 0
            #Positive anotation
            if start &amp;gt; 0: 
                start = start - index
            if end &amp;gt; 0:
                end = end - index
            route = EmptyLayer() # 1
            module.add_module(&quot;route_{0}&quot;.format(index), route)
            if end &amp;lt; 0:
                filters = output_filters[index + start] + output_filters[index + end]
            else:
                filters= output_filters[index + start]

        #shortcut corresponds to skip connection
        elif x[&quot;type&quot;] == &quot;shortcut&quot;:
            shortcut = EmptyLayer()
            module.add_module(&quot;shortcut_{}&quot;.format(index), shortcut)
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;route type의 경우&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;필터의 수를 계산할 때&amp;nbsp;layer에 숫자가&amp;nbsp;한개인 경우 end를 0으로 만들어서 이전에 저장한&amp;nbsp;output_filters로부터 숫자 한개만을 불러온다. 만약 layer에 숫자가 두개인 경우 start, end 두 군데서 만든 것을 + 해준다. (이어붙이는 것이므로)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이를 구체적으로 코드로 옮기는 부분에서 설명하고 넘어가야 할 부분이 있다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;주석 1번을 보면&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;route = EmptyLayer()
&lt;/pre&gt;&lt;p&gt;route를 정의하는 Empty layer이라는 새로운 레이어가 있다. 이것은&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;class EmptyLayer(nn.Module):
    def __init__(self):
        super(EmptyLayer, self).__init__()
&lt;/pre&gt;이렇게 정의된다.&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;하는것이 아무것도 없는 그냥 레이어인데, 왜 EmptyLayer 따위의 것을 만드는 것일까?&lt;/p&gt;&lt;p&gt;사실 route는 아무 일도 하지 않는것은 아니다. 앞전의 layer을 가져온다거나, 이전 레이어를 이어붙이는(concatenate) 등의 일을 한다.&lt;/p&gt;&lt;p&gt;하지만 주어진 코드를 구현하기 위해서 파이토치에서는&amp;nbsp;torch.cat이라는 한줄의 코드로 충분하다. 만약 이를 구현하는 모듈을 따로 구현하게되면 과도한 추상화를 야기할 수 있으므로 그냥 Empty layer로 놔둔 후 forward function에서 처리하도록 하자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;다만 output filter에 들어가는 수는 제대로 유지되어야 하므로&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;if end &amp;lt; 0:
    #If we are concatenating maps
    filters = output_filters[index + start] + output_filters[index + end]
else:
    filters= output_filters[index + start]
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;filters를 업데이트하는 해당 코드는 넣었다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28); font-size: 12pt;&quot;&gt;YOLO Layer&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;마지막으로, YOLO레이어를 위한 코드를 작성하자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;        #Yolo is the detection layer
        elif x[&quot;type&quot;] == &quot;yolo&quot;:
            mask = x[&quot;mask&quot;].split(&quot;,&quot;)
            mask = [int(x) for x in mask]

            anchors = x[&quot;anchors&quot;].split(&quot;,&quot;) # , 단위로 나누기
            anchors = [int(a) for a in anchors] # 숫자로 바꾸기
            anchors = [(anchors[i], anchors[i+1]) for i in range(0, len(anchors),2)] # 2개 단위로 tuple 만들기
            anchors = [anchors[i] for i in mask] # mask에 쓰여있는 anchor만 남기기

            detection = DetectionLayer(anchors)
            module.add_module(&quot;Detection_{}&quot;.format(index), detection)
&lt;/pre&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;p&gt;bounding box들을 저장하기&amp;nbsp;위해 Detection Layer을 만들었는데, 다음과 같이 정의된다.&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;&lt;b&gt;class DetectionLayer(nn.Module):
    def __init__(self, anchors):
        super(DetectionLayer, self).__init__()
        self.anchors = anchors&lt;/b&gt;
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;그리고 맨 마지막으로 다음 레이어로 넘어가기 위해 정보를 저장한다.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;        module_list.append(module)
        prev_filters = filters
        output_filters.append(filters)
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;이것을 마지막으로 loop을 마친다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;create_modules&lt;/b&gt;의 마지막엔 &lt;b&gt;net_info&lt;/b&gt;와 &lt;b&gt;module_list&lt;/b&gt;를 포함한 튜플을 리턴한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;return (net_info, module_list)
&lt;/pre&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;color: rgb(34, 116, 28); font-size: 12pt;&quot;&gt;Testing the code&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;darknet.py의 마지막에 아래 코드를 적고 실행시켜서 제대로 동작하는지 확인 해 보자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre class=&quot;brush:python;&quot;&gt;Python Codeblocks = parse_cfg(&quot;cfg/yolov3.cfg&quot;)
print(create_modules(blocks))&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&amp;nbsp; (101): Sequential(&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (conv_101): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (batch_norm_101): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (leaky_101): LeakyReLU(negative_slope=0.1, inplace)&lt;/p&gt;&lt;p&gt;&amp;nbsp; )&lt;/p&gt;&lt;p&gt;&amp;nbsp; (102): Sequential(&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (conv_102): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (batch_norm_102): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (leaky_102): LeakyReLU(negative_slope=0.1, inplace)&lt;/p&gt;&lt;p&gt;&amp;nbsp; )&lt;/p&gt;&lt;p&gt;&amp;nbsp; (103): Sequential(&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (conv_103): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (batch_norm_103): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (leaky_103): LeakyReLU(negative_slope=0.1, inplace)&lt;/p&gt;&lt;p&gt;&amp;nbsp; )&lt;/p&gt;&lt;p&gt;&amp;nbsp; (104): Sequential(&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (conv_104): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (batch_norm_104): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (leaky_104): LeakyReLU(negative_slope=0.1, inplace)&lt;/p&gt;&lt;p&gt;&amp;nbsp; )&lt;/p&gt;&lt;p&gt;&amp;nbsp; (105): Sequential(&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (conv_105): Conv2d(256, 255, kernel_size=(1, 1), stride=(1, 1))&lt;/p&gt;&lt;p&gt;&amp;nbsp; )&lt;/p&gt;&lt;p&gt;&amp;nbsp; (106): Sequential(&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; (Detection_106): DetectionLayer()&lt;/p&gt;&lt;p&gt;&amp;nbsp; )&lt;/p&gt;&lt;p&gt;))&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이런식으로 나온다면 성공&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;너무 글이 길어져 2탄에서 계속 하겠다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;div class=&quot;tt_adsense_bottom&quot; style=&quot;margin-top:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 하단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;2155036344&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;</description>
<category>Machine Learning</category>
<author>음악과프로그래밍 Jinyo(진요)</author>
<guid>https://wingnim.tistory.com/56</guid>
<comments>https://wingnim.tistory.com/56#entry56comment</comments>
<pubDate>Thu, 31 Jan 2019 11:26:35 +0900</pubDate>
</item>
<item>
<title>Vue + NativeScript 네이티브 앱 만들기 설명 참고 링크들</title>
<link>https://wingnim.tistory.com/54</link>
<description>&lt;div class=&quot;tt_adsense_top&quot; style=&quot;margin-bottom:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 상단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;7407363029&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 18pt;&quot;&gt;Basic&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;공식 docs&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://nativescript-vue.org/ko/docs/introduction/&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://nativescript-vue.org/ko/docs/introduction/&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;앱 띄워보기 튜토리얼&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;http://vuejs.kr/vue/nativescript/2017/08/11/introduce-vue-nativescript-01/&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;http://vuejs.kr/vue/nativescript/2017/08/11/introduce-vue-nativescript-01/&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 14pt;&quot;&gt;Styling&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;네이티브 스크립트에 스타일링 하는 법&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://docs.nativescript.org/ui/styling#user-interface-styling&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://docs.nativescript.org/ui/styling#user-interface-styling&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 14pt;&quot;&gt;Local Storage&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;sqlite 사용 방법 (영어)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;(Vuex와 같이 깔쌈하게 사용하는 방법을 정리 해 두었다)&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://www.nativescript.org/blog/data-management-with-sqlite-and-vuex-in-a-nativescript-vue-app&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://www.nativescript.org/blog/data-management-with-sqlite-and-vuex-in-a-nativescript-vue-app&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그렇지만 SQL이 마음에 들지 않아서 다른것을 찾아보았다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;application settings라는 것인데 key-value local storage이다.&lt;/p&gt;&lt;p&gt;자세한 docs는 아래에.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://docs.nativescript.org/ns-framework-modules/application-settings&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://docs.nativescript.org/ns-framework-modules/application-settings&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 실제 vuex와 붙여서 앱에 적용하는 예제는 아래에.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://www.nativescript.org/blog/key-value-local-storage-in-a-vue.js-nativescript-app-with-vuex&quot; target=&quot;_blank&quot; class=&quot;tx-link&quot;&gt;https://www.nativescript.org/blog/key-value-local-storage-in-a-vue.js-nativescript-app-with-vuex&lt;/a&gt;&lt;br /&gt;&lt;/p&gt;&lt;div class=&quot;tt_adsense_bottom&quot; style=&quot;margin-top:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 하단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;2155036344&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;</description>
<category>Developing</category>
<author>음악과프로그래밍 Jinyo(진요)</author>
<guid>https://wingnim.tistory.com/54</guid>
<comments>https://wingnim.tistory.com/54#entry54comment</comments>
<pubDate>Tue, 15 Jan 2019 03:16:37 +0900</pubDate>
</item>
<item>
<title>t-SNE(t-distributed stochastic neighbor embedding) 설명</title>
<link>https://wingnim.tistory.com/53</link>
<description>&lt;div class=&quot;tt_adsense_top&quot; style=&quot;margin-bottom:30px&quot;&gt;&lt;script async src=&quot;//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js&quot;&gt;&lt;/script&gt;
&lt;!-- 반응형 상단 --&gt;
&lt;ins class=&quot;adsbygoogle&quot;
     style=&quot;display:block&quot;
     data-ad-client=&quot;ca-pub-3131146192766111&quot;
     data-ad-slot=&quot;7407363029&quot;
     data-ad-format=&quot;auto&quot;
     data-full-width-responsive=&quot;true&quot;&gt;&lt;/ins&gt;
&lt;script&gt;
(adsbygoogle = window.adsbygoogle || []).push({});
&lt;/script&gt;&lt;/div&gt;&lt;p&gt;t SNE는 High Dimension Data (고 차원의 데이터) 를 Low Dimension Data (저 차원의 데이터) 로 거리 관계를 유지하며 임베딩 시키는 알고리즘이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;span style=&quot;font-size: 18pt;&quot;&gt;임베딩(Embedding)&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;고차원을 저차원으로 임베딩한다는 것에 관련하여 쉽게 설명을 하자면, 3차원상에 있는 점들을 2차원에 그릴 때, 먼 곳은 멀게, 가까운 곳은 가깝게 표현하는 행위를 의미한다. 그리고 차원을 줄이면서 거리관계를 완벽히 유지하는것은 불가능 하기 때문에 여러 임베딩을 하기 위한 알고리즘들이 만들어졌다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;지구의 모양이 3d인데 지도를 2d 상에 그리려다 보니 북극과 남극이 실 척도보다 크게 그려졌다는 것을 예로 들면 더 쉬울 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;우리의 목표는 50차원, 혹은 그 이상의 데이터들에서도 데이터들간의 상관관계를 유지하며 2d 혹은 3d에서도 비슷한 데이터끼리 근처에 위치할 수 있게 묶어주는 것이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이해가 직관적으로 안간다면, 비슷한 뉴스 기사끼리 근처에 위치시킨 지도를 만들어 준다거나 하는것을 한다고 생각 해 보자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이를 수행하기 위해서 우리는 과거부터 많은 임베딩 알고리즘들을 써 왔고, 그 중 제일 성능이 좋은 State of the art 알고리즘은 t-SNE 알고리즘이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;&lt;b&gt;&lt;span style=&quot;font-size: 18pt;&quot;&gt;tSNE&amp;nbsp;(t-distributed stochastic neighbor embedding)&lt;/span&gt;&lt;/b&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;txc-formula&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/998ECF3E5C06565315&quot; historydata=&quot;%3Cflashrichtext%20version%3D%221%22%3E%0A%20%20%3Ctextformat%20font%3D%22Dotum%22%20size%3D%2216%22%20color%3D%222236962%22%20bold%3D%22false%22%20italic%3D%22false%22%20underline%3D%22false%22%20url%3D%22%22%20target%3D%22transparent%22%20align%3D%22left%22%20leftMargin%3D%2225%22%20rightMargin%3D%2225%22%20indent%3D%220%22%20leading%3D%220%22%20blockIndent%3D%220%22%20kerning%3D%22true%22%20letterSpacing%3D%220%22%20display%3D%22block%22%3E%28%7B%20x%20%7D_%7B%201%20%7D%2C%7B%20x%20%7D_%7B%202%20%7D%2C...%7B%20x%20%7D_%7B%20N%20%7D%29%3C/textformat%3E%0A%3C/flashrichtext%3E%2C%0A14%2C%0A0xFFFFFF&quot; width=&quot;93&quot; height=&quot;27&quot;&gt;&amp;nbsp;로 표현되는 데이터 X 가 있다고 생각 해 보자.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고&amp;nbsp;&lt;img class=&quot;txc-formula&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/998934355C06571519&quot; historydata=&quot;%3Cflashrichtext%20version%3D%221%22%3E%0A%20%20%3Ctextformat%20font%3D%22Dotum%22%20size%3D%2216%22%20color%3D%222236962%22%20bold%3D%22false%22%20italic%3D%22false%22%20underline%3D%22false%22%20url%3D%22%22%20target%3D%22transparent%22%20align%3D%22left%22%20leftMargin%3D%2225%22%20rightMargin%3D%2225%22%20indent%3D%220%22%20leading%3D%220%22%20blockIndent%3D%220%22%20kerning%3D%22true%22%20letterSpacing%3D%220%22%20display%3D%22block%22%3E%28%7B%20x%20%7D_%7B%20i%20%7D%5Cquad%20%2C%5Cquad%20%7B%20x%20%7D_%7B%20j%20%7D%29%3C/textformat%3E%0A%3C/flashrichtext%3E%2C%0A14%2C%0A0xFFFFFF&quot; width=&quot;76&quot; height=&quot;27&quot;&gt;의 유사도를&amp;nbsp;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile3.uf.tistory.com%2Fimage%2F99716E415C0657601D2E40&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99716E415C0657601D&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처.PNG&quot; height=&quot;117&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;라고 정의하자.&lt;/p&gt;&lt;p&gt;그 후, High dimension에서 i 와 j 가 이웃일 확률은 서로&amp;nbsp;동일하기 때문에 ( 라고 설명을 한다 ) i와 j의 최종적인 서로에 대한 유사도 값 p는 아래와 같이 정의한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:241px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile30.uf.tistory.com%2Fimage%2F99852D4F5C06591611F014&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99852D4F5C06591611&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처2.PNG&quot; height=&quot;109&quot; width=&quot;241&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;( i = j 일때는 0으로 정의 )&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;그리고 low dimension의 유사도는 다음과 같이 정의한다.&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:500px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile26.uf.tistory.com%2Fimage%2F99024D475C0659C60D23CF&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/99024D475C0659C60D&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처3.PNG&quot; height=&quot;120&quot; width=&quot;500&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이런 수식을 통해 high dimension p의 분포와 low dimension q의 분포가 얼마나 유사한지를 KL divergence를 이용하여 측정한다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p style=&quot;text-align: center; clear: none; float: none;&quot;&gt;&lt;span class=&quot;imageblock&quot; style=&quot;display:inline-block;width:414px;;height:auto;max-width:100%&quot;&gt;&lt;img srcset=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory&amp;fname=http%3A%2F%2Fcfile22.uf.tistory.com%2Fimage%2F990E1B495C065A4B2AA56B&quot; src=&quot;https://t1.daumcdn.net/cfile/tistory/990E1B495C065A4B2A&quot; filemime=&quot;image/jpeg&quot; filename=&quot;캡처4.PNG&quot; height=&quot;135&quot; width=&quot;414&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;이 KL divergence를 loss function으로&amp;nbsp;이용하여 서서히 0으로 수렴시키기 위해 learning을 진행한 결과를 마지막으로 표시하는 것이 t-SNE 알고리즘이다.&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;p&gt;사실 소스를 뜯